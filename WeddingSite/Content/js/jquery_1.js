function tools_paginator_render(a,b,c,d,e){var f={NumPage:a,NumItems:b,jsFunctionPaginado:c,pageTitlePaginado:d,TemasPagina:e};$.get("/utils-PaginadoJS.php",f,function(a){$(".pagination").html(a),"function"==typeof initWorkspace&&initWorkspace()})}function tools_facebook_show_contacts(a){"undefined"==typeof a&&(a=1),FB.getLoginStatus(function(b){"connected"===b.status?tools_facebook_show_layer(a):FB.login(function(b){b.authResponse&&tools_facebook_show_layer(a)},{scope:"friends_birthday"})})}function tools_facebook_show_layer(a){common_teTOOL("fbFriends_Show"),common_openLayer("/tools/ShowFbFriends?guest="+a)}function tools_tiny_init(){var a={valid_elements:"",toolbar:"bold italic",setup:function(a){try{a.on("init",function(a){$(":focus").blur()})}catch(b){}}};common_tiny_init(a)}function tools_load_in_modal(a,b){common_modalIsOpen($("#tool-modal"))?$.get(a,function(a){$(".modal-content").html(a),"function"==typeof b&&b()}):($("#tool-modal").modal({remote:a,backdrop:"static"}),"function"==typeof b&&b())}function tools_guests_formChangeToFirstTab(){$(".app-tools-guests-layer-section-header").removeClass("active"),$(".app-tools-guests-layer-section-header:first").addClass("active"),$(".tab-box-content").removeClass("active"),$(".tab-box-content:first").addClass("active"),$(".app-tools-guests-layer-section-content").hide(),$(".app-tools-guests-layer-section-content:first").show()}function tools_guests_form_guest_is_valid(a){var b=a.Nombre.value.trim();if(b.length<3)return alert('The name must contain a minimum of three characters'),tools_guests_formChangeToFirstTab(),a.Nombre.focus(),!1;if(0===Number(a.Grupo.value))return alert('Please select the group of guests'),tools_guests_formChangeToFirstTab(),a.Grupo.focus(),!1;if(a.Mail.value.length>0){var c=common_validateMail(a.Mail.value,0,a.Mail.name);if(1!==c.estado){var d='Check that the email is correct';return""!==c.suggestion&&(d+=c.suggestion.substr(0,c.suggestion.indexOf("?")+1)),alert(d),a.Mail.focus(),!1}}return!0}function tools_guests_layer_submit(a,b){if(tools_guests_form_guest_is_valid(document.getElementById("frmToolLayer"))){var c=$("#tool-modal"),d=c.find("form").serialize();"undefined"!=typeof b&&$(b).attr("disabled","disabled").addClass("btn-disabled"),$.post(c.find("form").attr("action"),d,function(b){"tables"==$(document.body).data("section")?($("#i"+b.contact.ID_CONTACT).length>0&&tablesPlugin.updateGuest(b),$.get("/tools/TablesGuests",{onlyUnsat:!0},function(a){$(".guestList").html(a),tablesPlugin.showInvitados()})):(null==a||1==$(c).find("input[name='fullReload']").val()?tools_guests_filter():tools_guests_filter_one_row({guests:a}),$("div .alert").hide(),"0"===$(c).find("input[name=idContact]").val()?$(".app-guest-add").show():$(".app-guest-modif").show()),c.modal("hide")},"json")}}function tools_guests_layer_submit_and_add_other(a){if(tools_guests_form_guest_is_valid(document.getElementById("frmToolLayer"))){var b=$("#tool-modal"),c=b.find("form").serialize();"undefined"!=typeof a&&$(a).attr("disabled","disabled").addClass("btn-disabled"),$.post(b.find("form").attr("action"),c,function(c){"tables"==$(document.body).data("section")?($("#i"+c.contact.ID_CONTACT).length>0&&tablesPlugin.updateGuest(c),$.get("/tools/TablesGuests",{onlyUnsat:!0},function(a){$(".guestList").html(a),tablesPlugin.showInvitados()})):(tools_guests_filter(),$("div .alert").hide(),"0"===$(b).find("input[name=idContact]").val()?$(".app-guest-add").show():$(".app-guest-modif").show()),b.find(".alert-success").show(0).delay(3e3).hide(0),$(".form-input-hombre").click(),$(".form-input-adulto").click(),b.find("form")[0].reset(),tools_guests_layer_reload_guests(),$('input[name="naseToken"]').val(c.token),"undefined"!=typeof a&&$(a).prop("disabled",!1).removeClass("btn-disabled"),b.find("input[name='Acompanantes']").val(""),b.find("input[name='AcompanantesNuevos']").val(""),$("#GuestList").html('You haven\'t added any additional guests.'),$(".app-companion-list-title").html('Additional guests'),$(".app-tools-guests-layer-add-guest-count").html("").hide()},"json")}}function tools_guests_layer_reload_guests(){var a=$("#tool-modal");$.ajax({type:"POST",url:"/tools/SelectGuests",dataType:"json"}).done(function(b){1==b.confirm&&a.find("#addAcompanante").html(b.message)})}function tools_guests_layer_companion_new_submit(){if($('input[name="NombreAcompanante"]').val().trim().length<3)return alert('The name must contain a minimum of three characters'),$('input[name="NombreAcompanante"]').focus(),!1;if(0===Number($('select[name="GrupoAcompanante"]').val()))return alert('Please select the group of guests'),$('select[name="GrupoAcompanante"]').focus(),!1;var a=$("form#frmToolLayer"),b={returnType:"json",ref:a.find('input[name="ref"]').val(),capa:a.find('input[name="capa"]').val(),Nombre:a.find('input[name="NombreAcompanante"]').val(),Apellidos:a.find('input[name="ApellidosAcompanante"]').val(),Sexo:a.find('select[name="SexoAcompanante"]').val(),Grupo:a.find('select[name="GrupoAcompanante"]').val(),Menu:a.find('select[name="MenuAcompanante"]').val(),Edad:a.find('select[name="EdadAcompanante"]').val(),Pais:a.find('select[name="Pais"]').val(),fromAjax:"1"};return $.post("/tools/GuestsAddRun",b,function(a){""!==$('input[name="Acompanantes"]').val()&&$('input[name="Acompanantes"]').val($('input[name="Acompanantes"]').val()+","),""!==$('input[name="AcompanantesNuevos"]').val()&&$('input[name="AcompanantesNuevos"]').val($('input[name="AcompanantesNuevos"]').val()+","),$('input[name="Acompanantes"]').val($('input[name="Acompanantes"]').val()+a.contact.ID_CONTACT),$('input[name="AcompanantesNuevos"]').val($('input[name="AcompanantesNuevos"]').val()+a.contact.ID_CONTACT),$.get("/tools/GuestAcompanantes?acompanantes="+$('input[name="Acompanantes"]').val(),function(a){$("#GuestList").html(a),tools_guests_layer_companion_update_num_acompanantes(),tools_reinitialise_jscrollpane()})},"json"),$('input[name="NombreAcompanante"]').val(""),$('input[name="ApellidosAcompanante"]').val(""),$('select[name="MenuAcompanante"]').val(0),!0}function tools_guests_layer_companion_exists_submit(a){""!==$('input[name="Acompanantes"]').val()&&$('input[name="Acompanantes"]').val($('input[name="Acompanantes"]').val()+","),$('input[name="Acompanantes"]').val($('input[name="Acompanantes"]').val()+a),$.get("/tools/GuestAcompanantes?acompanantes="+$('input[name="Acompanantes"]').val(),function(a){$("#GuestList").html(a),tools_guests_layer_companion_update_num_acompanantes(),tools_reinitialise_jscrollpane()})}function tools_guests_layer_companion_delete(a){var b=$(a).data("acompanante"),c=$(a).data("invitado");$.get("/tools/GuestRemoveAcompanante",{idAcompanante:b,idGuest:c},function(a){a.success&&$(".app-tools-guest-acompanante[data-idcontact="+b+"]").fadeOut(function(){$(this).remove();var a=[];$(".app-tools-guest-acompanante").each(function(b,c){a[a.length]=$(c).data("idcontact")}),$('input[name="Acompanantes"]').val(a.join()),tools_guests_layer_companion_update_num_acompanantes(),tools_reinitialise_jscrollpane()})})}function tools_guests_layer_cancel(){var a;""!==$('input[name="AcompanantesNuevos"]').val()&&($('input[name="AcompanantesNuevos"]').val($('input[name="AcompanantesNuevos"]').val()+","),a=$('input[name="AcompanantesNuevos"]').val().trim().split(","),a.length>0&&$.each(a,function(a,b){(""!=b||"undefined"!=typeof b)&&$.get("/tools/GuestRemoveAcompanante",{idAcompanante:b,idGuest:b,"delete":"1"})}))}function tools_guests_layer_companion_update_num_acompanantes(){var a=$(".app-tools-guest-acompanante").length;a>0?($(".app-tools-guests-layer-add-guest-count").html(a).show(),1==a?$(".app-companion-list-title").html(a+" "+'companion'):$(".app-companion-list-title").html(a+" "+'companions')):($(".app-tools-guests-layer-add-guest-count").html("0").hide(),$(".app-companion-list-title").html('Additional guests'),$("#GuestList").html('You haven\'t added any additional guests.')),$("input[name='fullReload']").val(1)}function tools_reinitialise_jscrollpane(){$(".box-scroll").each(function(){$(this).jScrollPane();var a,b=$(this).data("jsp");$(this).bind("click",function(){a||(a=setTimeout(function(){b.reinitialise(),a=null},50))})})}function tools_init_planner_submit(a){return a.Fecha.value.length<3?(alert('Please select the date of your wedding'),a.Fecha.focus(),!1):-1==a.Pais.value?(alert('You must select a country.'),a.Pais.focus(),!1):-1==a.Poblacion.value||0===Number(a.Poblacion.value)?(alert('You must select a city or town.'),!1):a.Budget.value.length<3?(alert('Please select you approximate budget'),a.Budget.focus(),!1):a.Guests.value.length<2?(alert('Please select the approximate number of guests'),a.Guests.focus(),!1):(window.onbeforeunload=null,!0)}function tools_buzon_check_all_msgs(a){a?$(":checkbox","#frmComunidad").iCheck("check"):$(":checkbox","#frmComunidad").iCheck("uncheck")}function tools_buzon_delete_msg(){0===$("#frmComunidad input:checked").length?alert('You have to select a message'):(document.frmComunidad.action="com-BuzonDelete.php",document.frmComunidad.submit())}function tools_buzon_send_msg_submit(a){return a.Destino.value.length<1?(alert('You ahve not selected a recipient of your message.'),!1):a.Asunto.value.length<5?(alert('The subject must contain a minimum of four characters.'),a.Asunto.focus(),!1):a.Mensaje.value.trim().length<10?(alert('The body of the message text must have a minimum of 10 characters'),a.Mensaje.focus(),!1):(a.tipoUserRol.value=$("#tipoUserRol").val(),a.tipoUserFechaBoda.value=$("#tipoUserFechaBoda").val(),a.tipoUserFechaAlta.value=$("#tipoUserFechaAlta").val(),a.tipoUserRango.value=$("#tipoUserRango").val(),!0)}function tools_buzon_send_msg(a){window.location="/com-Buzon.php?action=new&id_destinatario="+a}function tools_buzon_msg_solicitud_submit(a){return tinyMCE.triggerSave(),common_strip_html_tags(a.Comentario.value).trim().length<10?(alert('The body of the message text must have a minimum of 10 characters'),a.Comentario.focus(),!1):!0}function tools_check_animation(){var a=$(".mobile");a.hasClass("start")||tools_is_element_in_viewport(a)&&a.addClass("start")}function tools_check_animation_box_right(){var a=$(".boxRight");a.hasClass("startBoxRight")||tools_is_element_in_viewport(a)&&a.addClass("startBoxRight")}function tools_check_animation_box_left(){var a=$(".boxLeft");a.hasClass("startBoxLeft")||tools_is_element_in_viewport(a)&&a.addClass("startBoxLeft")}function tools_is_element_in_viewport(a){var b=$(a),c=-1!=navigator.userAgent.toLowerCase().indexOf("webkit")?"body":"html",d=$(c).scrollTop(),e=d+$(window).height(),f=Math.round(b.offset().top),g=f+b.height();return e>f&&g>d}function tools_wedshoots_gallery(){var a=$(".landing-wedshoots-ssGallery");a.hasClass("startWedshootsGallery")||tools_is_element_in_viewport(a)&&a.addClass("startWedshootsGallery")}function tools_wedshoots_list(){var a=$(".landing-wedshoots-ssList");a.hasClass("startWedshootsList")||tools_is_element_in_viewport(a)&&a.addClass("startWedshootsList")}function tools_heading_run_countdown(a){$("#defaultCountdown").countdown("destroy"),$("#defaultCountdown").countdown({until:a,timezone:globals.timezone})}function tools_buzon_insertAsuntoMensaje(){var a=$("#plantillas").val(),b=$("#"+a).data("asunto"),c=$("#"+a).data("mensaje");$("input[name='Asunto']").val(b);var d=tinyMCE.activeEditor.getContent();tinyMCE.activeEditor.setContent(c+"</p>"+d)}function tools_mywedding_show_popup_recorte(a,b,c,d,e){common_stop_spin(".app-spinner-container"),0==a?(modal=$.modal({template:"croppie",urlForm:"/tools/PrintPhotoCropRun",origen:"mywedding",rol:b}),com_addImage(c,d,e)):(alert('Image must have a minimum width and height of 120 pixels. Please check it and try again.'),window.location="/tools/Main")}function tools_mywedding_submit_crop_image(a){$(a).prop("disabled",!0);var b=$(a).data("rol");$.post($("#formCrop").attr("action"),$("#formCrop").serialize(),function(c){c.success?($("#tool-modal").modal("hide"),b=1==b?"bride":"groom",$(".app-"+b+"-photo").attr("src",c.filename+"?r="+1e8*Math.random()+1),tools_load_in_modal("/tools/Wedding?r="+1e8*Math.random()+1)):$(a).prop("disabled",!1)})}function markUnread(a){$.ajax({type:"POST",url:"com-BuzonMarcarNoLeido.php?idMensaje="+a,success:function(){$("#mesaje"+a).addClass("new")}})}function tools_showTelefonoTrace(a){var b=$("#app-emp-phone-"+a),c=$("#app-emp-phone-"+a+"-txt"),d=c.attr("data-visible");"true"==d?(c.html("<i class='fa fa-phone color-grey mr5'></i>"+'Telephone').attr("data-visible","false"),b.hide()):(b.load("/emp-ShowTelefonoTrace.php?id_empresa="+a+"&reduced="+reduced).show(),c.html("<i class='fa fa-eye-slash color-grey mr5'></i>"+'Hide').attr("data-visible","true"))}function tools_close_dropdowns(){$(".app-context-menu").hide()}function tools_showMoreVendorsCategs(a){$(a).closest("li").siblings().show().end().remove()}function app_charged_classSpin(){$(".img-profile-relative").children("span").addClass("app-spinner-container")}function com_addImage(a,b,c){var d=300,e=300,f=.9*$(".modal-dialog").width(),g=.7*$(".modal-dialog").width();b&&(d=b),c&&(e=c),uploadCrop=$(".com-perfil-croppie").croppie({viewport:{width:d,height:e,quality:1,type:"square"},boundary:{width:f,height:g}});var h=new FileReader;h.onload=com_fileOnload(a,uploadCrop)}function com_fileOnload(a,b){b.croppie("bind",{url:a+"?"+Math.random(),zoom:0}),b.addClass("ready")}function tools_main_validateForm(a){var b=$(a).find("#suProvider_id-default").val(),c=$(a).find("#suProvider-default").val();return""!==b||""!==c?($(a).find('input[name="idEmpresa"]').val(b),$(a).find('input[name="nombreEmpresa"]').val(c),!0):(alert('Type the name of the suppliers'),!1)}var currentPage=1;$(document).ready(function(){if($(".fbContactsButton").click(function(){tools_facebook_show_contacts(1)}),$(".more-recomendar").on("click",function(){$("#hiddenRecomendados").show(),$(this).hide()}),$(".closeInfoConcursoFromTools").on("click",function(){SetCookieSession("pb_cerrarInfoConcurso","1"),$(".sorteo-tool").fadeOut(500)}),$(".dropdown-link").on("click",function(){$(this).parent().parent().parent().find("a.dropdown-btn span").html($(this).html())}),$(document.body).on("hidden.bs.modal",".modal",function(){$(this).removeData("bs.modal"),$(this).html(""),"undefined"!=typeof tinyMCE&&"undefined"!=typeof tinyMCE.activeEditor&&null!==tinyMCE.activeEditor&&tinyMCE.activeEditor.remove()}),$(".app-tools-animation").length>0&&$(window).scroll(function(){tools_check_animation(),tools_check_animation_box_right(),tools_check_animation_box_left()}),$(".app-tools-animation-wedshoots").length>0&&($(window).scroll(function(){tools_wedshoots_gallery(),tools_wedshoots_list()}),$("#wedshoots-royalSlider").royalSlider({controlNavigation:"bullets",autoScaleSlider:!0,autoScaleSliderWidth:422,autoScaleSliderHeight:296,loop:!0,imageScaleMode:"fill",navigateByClick:!0,numImagesToPreload:2,arrowsNav:!1,keyboardNavEnabled:!0,fadeinLoadedSlide:!0,globalCaption:!1,slidesSpacing:0})),$(document.body).on("click",'.app-tools-wedding-modal input[type="submit"]',function(){var a=$(".app-tools-wedding-modal-form");$.post(a.attr("action"),a.serialize(),function(a){if(a.success){var b=a.date.split("/"),c=new Date(b[2],b[1]-1,b[0]);$("#wedding-ko").hide(),$("#wedding-exit").show(),setTimeout(function(){$("#wedding-exit").hide("fade")},3e3),$(".app-tools-checklist-sidebar-box").load("/tools/ChecklistSideBar",function(){tools_heading_run_countdown(c),$("#tool-modal").modal("hide")}),$(".app-tools-heading").load("/tools/heading",function(){tools_heading_run_countdown(c),$("#tool-modal").modal("hide")})}else $("#wedding-exit").hide(),$("#wedding-ko").show()})}),$(document.body).on("change",'.app-tools-wedding-modal input[type="file"]',function(a){var b=$(this).closest(".app-coupledata-owner"),c=$(".app-tools-wedding-modal-form-upload-image");c.find('input[type="file"]').replaceWith(this),"undefined"!=typeof b.data("rol")&&c.find('input[name="rol"]').val(b.data("rol"));var d=c.find('input[name="rol"]').val();""!=c.find('input[name="rol"]').val()&&("owner"==d?common_charge_spin(".app-owner"):common_charge_spin(".app-partner"),c.submit(),c.find('input[type="file"]').empty())}),$(document.body).on("change",".app-tools-wedding-change-foto-partner",function(){var a=$(this).find("option:selected");$(".app-tools-wedding-foto-partner").attr("src",a.data("img-default"))}),$(document.body).on("click",".app-charged-classSpin",function(){app_charged_classSpin()}),$(document.body).on("change",".app-submit-imgConcurso",function(){common_charge_spin(".app-spinner-container"),$("#frmFoto").submit()}),$(document.body).on("click",".app-tools-guests-layer-section-header",function(a){var b=$(this).prop("id");$(".app-tools-guests-layer-section-header").each(function(a,c){$(c).prop("id")!=b?$(c).removeClass("active"):$(c).addClass("active")}),$(".app-tools-guests-layer-section-content").each(function(a,c){$(c).prop("id")!=b+"-info"?$(c).hide().parent().removeClass("active"):$(c).show().parent().addClass("active")}),$(this).each(function(){"guest-entourage-btn"===$(this).prop("id")&&$(".box-scroll").jScrollPane()})}),$(document.body).on("click","div.app-tools-guests-layer-add-guest",function(){$(".app-tools-guests-layer-add-guest-content").hide(),$(".app-tools-guests-layer-add-guest").removeClass("active"),$(this).addClass("active"),$(".app-tools-guests-layer-add-guest-content[data-option="+$(this).data("option")+"]").show()}),$(document.body).on("click","button.close",function(){$(this).parent().fadeOut(500),$("#scroller-anchor").remove()}),$("#formVicularCuenta").length>0){new AjaxFormManager($("#formVicularCuenta"))}".dropdown-btn".length>0&&$(document).mouseup(function(a){var b=$(".dropdown-link");b.is(a.target)||0!==b.has(a.target).length||tools_close_dropdowns()}),$(document.body).on("click",".app-guest-link-add-contact",function(){$("#guest-contact").trigger("click")}),$(document.body).on("click",".app-guest-link-add-companion",function(){$("#guest-entourage").trigger("click")}),$(document.body).on("click",".com-submit-no-foto",function(){var a=$("#origen").val();switch(a){case"perfil":$("img.app_thumb").each(function(){$(this).attr("src",$(this).attr("src").split("?")[0]+"?a="+Math.random())}),$(".app_thumb img").each(function(){$(this).attr("src",$(this).attr("src").split("?")[0]+"?a="+Math.random())}),window.location="com-Modif.php";break;case"front":window.location.reload();break;case"mywedding":modal.close(),$(".app-tools-wedding-foto-"+response.rol).attr("src",response.filename+"?r="+Math.random());var b=$(".app-tools-wedding-modal-form-upload-image");b.find('input[type="file"]').val("");break;case"recomendacion":modal.close(),$("#frmRecomendaciones").submit();break;case"boletos":modal.close(),$("#app-common-layer").modal("hide");break;default:modal.close()}}),$(".app-button-add-invitado").on("click",function(a){$(".app-button-add-invitado").show(),$(this).hide(),$(document).bind("mousedown",function(a){var b=$(".suggest-layer-content");b.is(a.target)||0!==b.has(a.target).length||($(".suggest-results").hide(),$(".cont").hide(),$(".app-button-add-invitado").show(),$(document).unbind("mousedown",arguments.callee))})})});function community_change_page(a){$("input[name=NumPage]").val(a),$("form[name=frmComunidad]").submit()}function community_validar_captcha(a){var b=!0;return $(".app-community-captcha-error",a).hide(),$(".app-community-captcha-input",a).length>0&&$.ajax({url:"/captcha/validar.php",data:{captcha:$(".app-community-captcha-input",a).val()},cache:!1,async:!1}).done(function(c){0===Number(c)&&($(".app-community-captcha",a).show(),$(".app-community-captcha-img",a).attr("src","/captcha/captcha.php?"+Math.random()),$(".app-community-captcha-input",a).val().length&&$(".app-community-captcha-error",a).show(),$(".app-community-captcha-input",a).val(""),b=!1)}),b}function community_admin_doAction(a,b,c,d,e){8==b&&(e=1),$(d).length?$(d).load(a+"&idMotivo="+b+"&notaAdmin="+encodeURI(c)+"&noEnviarMail="+e):$.get(a+"&idMotivo="+b+"&notaAdmin="+encodeURI(c)+"&noEnviarMail="+e)}function community_comments_verify_form(a){return community_validar_captcha(a)?common_strip_html_tags(a.Texto.value).trim().length<20?(alert('Your comment must contain a minimum of 20 characters'),!1):(common_callEnsureLogged(function(){return a.submit()},"community"),!1):!1}function community_group_leave(a){window.location="/com-GruposAbandonar.php?id_group="+a}function community_group_join(a){return common_goEnsureLogged("/com-GruposUnirse.php?id_group="+a,"community")}function community_user_changeValid(a,b){$(".app-community-user-status[data-id-user="+a+"]").load("/com-UsuariosValidar.php?id_user="+a+"&valid="+b,"comUser"+a)}function community_user_sendMsg(a){return common_goEnsureLogged("/com-Buzon.php?action=new&id_destinatario="+a,"community")}function community_user_addFriend(a,b,c,d){var e=function(){$.get("/com-AmigosPeticionRun.php",{id_amigo:b,origen:c,outline:d||0},function(b){$(a).replaceWith(b)})};common_callEnsureLoggedAsync(e,"community")}function community_user_muro_addComment(a){var b=function(){common_openLayer("/com-PerfilMuroComentarioAdd.php?id_user="+a)};common_callEnsureLoggedAsync(b,"community")}function community_user_muro_verifyAddComment(a,b){return common_callEnsureLoggedAsync(function(){$(b).val().length<=20?(console.log("here"),alert('Your comment must contain a minimum of 20 characters'),$(b).focus()):(console.log("horo"),a.submit())},"community"),!1}function community_user_validacionMultiple(a,b,c,d){document.frmValidarUsuarios.action="com-UsuariosValidarMultiple.php?enviarMails="+a+"&orden="+b+"&filterValid="+c+"&modoAdmin="+d,document.frmValidarUsuarios.submit()}function community_user_sendAdminMail(a,b,c){$.get("/com-UsuariosMailAdmin.php?id_user="+b+"&id_mail="+c,"comUser"+b,function(){$(a).css("text-decoration","line-through")})}function community_user_changeNivel(a,b){$("#app-user-destacar-layer").load("/com-UsuariosDestacar.php?id_user="+a+"&nivel="+b).show()}function community_user_refuseFriend(a){confirm('Are you sure that you want to remove this contact?')&&$.ajax({url:"/com-AmigosRechazarRun.php?id_amigo="+a}).done(function(){$("#app-user-card-"+a).hide()})}function community_user_acceptFriend(a,b){b=void 0!=b?!0:!1,accept_box=$("#app-accept-friend-"+a),accept_box.parent().load("/com-AmigosAceptarRun.php?id_amigo="+a+"&stylized="+b),accept_box.remove()}function community_user_change_mail(a){var b=$(a).val().trim(),c=($("#emailInfo").html().trim(),/^([\w+-\.]+@([\w-]+\.)+[\w-]{2,4})?$/);return c.test(b)&&""!==b?($.post("/com-ChangeEmailRun.php",{newEmail:b},function(c){switch(c){case"0":$(".app-community-mail-change-msg-success").fadeIn(),$(".app-community-mail-change-div").hide(),$(".app-community-mail-change-button").show(),$("#emailInfo").html(b),$("#mailHeader").html(b),$(a).val("");break;case"1":alert('A user signed up with this email address already exists.'),$(a).focus();break;default:"-1"!=c&&(alert(c),$(a).focus())}}),!1):(alert('Check that the email is correct'),$(a).focus(),!1)}function community_user_change_password(a){if(a.newPassword.value.length<6)return alert('The password must have at least six characters.'),a.newPassword.focus(),!1;if(a.newPassword.value!==a.newPasswordRepeated.value)return alert('The new password doesn\'t match.'),a.newPasswordRepeated.focus(),!1;var b={NewPassword:a.newPassword.value,revalidarSesion:!0,token:a.token.value};$.post("com-NewPasswordRun.php",b,function(a){"0"==a&&($(".app-community-password-change-div").hide(),$(".app-community-password-change-button").show(),$(".app-community-password-change-msg-success").fadeIn())})}function community_user_baja_submit(a){var b={currentPassword:a.currentPassword.value,motivo:a.motivo.value,token:a.token.value};return $.post("/com-BajaRun.php",b,function(a){a.success?location.href="/com-SimpleLogin.php?error=5":alert('Error verifying the current password.')}),!1}function community_user_change_visibilidad(a){var b={contactarTodos:+a.contactarTodos.checked};$.post("/com-CambiosVisibilidadRun.php",b,function(){$(".app-community-visibilidad-change-msg-success").fadeOut().fadeIn()})}function community_search_users_submit(){$(".app-community-search-users-spinner").show(),$("input[name=NumPage]").val(1),$("form[name=frmComunidad]").submit()}function community_search_users_reset_fecha(){$(".app-community-search-users-calendar-datepicker").find("input:first").css("color","#eee").datepicker("hide"),$("input[name=mesBoda]").val(""),community_search_users_submit()}function community_denunciar(a,b){var c=function(){common_openLayer("/com-Denuncia.php?idItem="+b+"&tipoItem="+a)};common_callEnsureLogged(c,"community")}function community_denunciar_run(a){var b=$("[name='idMotivo']:checked","#frmDenuncia").val();return null==b?void alert("Escoge un motivo de denuncia."):void $.ajax({type:"POST",url:"/com-DenunciaRun.php",data:$(a).closest("form").serialize(),success:function(a){alert('Thank you for informing us. Your complaint will be reviewed shortly.'),common_closeLayer(),$(".app-community-denunciar-option").remove()}})}function community_citar(a,b,c){var d=$("#msg_"+b);d.find(".box-quote").removeClass("dnone"),d.find(".app-box-quote-action").remove();var e=d.html().trim(),f=community_quoteMessage(a,e);$("#mensajeCitado").val(f),$("#app-quote-message").html(f),$("#app-quote-box").removeClass("dnone"),$("#idCitado").val(c),$("#idMensajeCitado").val(b);var g=$("#app-quote-message").closest("form").find(".trumbowyg-editor");$.scrollTo(g,{offset:{top:-300}}),g.focus()}function community_quoteMessage(a,b){return"<!--[citar]--><p class='discussion-form-reply-title'>"+'Written by'+" "+a+":</p><p class='color-grey'> "+b+"</p><!--[/citar]-->"}function community_perfil_ponTuFoto(a,b){("undefined"!=typeof b&&null!==b||"1"!=GetCookie("comPedirFoto"))&&(SetCookie("comPedirFoto","1",null,null,null,10),$.get("/com-LayerAddFoto.php?pedirCara="+(a?1:0)).then(function(a){var b=$("#app-common-layer");b.html(a),b.modal()}),$(".modal").on("hidden.bs.modal",function(){window.location.reload()}))}function community_perfil_ponerFotoFacebook(){com_ShowFbPicture()}function community_perfil_muro_comentario_delete(a){$.get("/com-PerfilMuroDelete.php?id_comentario="+$(a).data("id-comentario"),function(){$(a).closest(".com-feed-box").fadeOut()})}function community_perfil_muro_comentario_descartar(a){var b="/com-PerfilMuroDelete.php?id_comentario="+$(a).data("id-comentario");$(a).closest(".com-feed-box").fadeOut(),common_openLayer("/com-AdminMotivo.php?urlAction="+encodeURIComponent(b)+"&resContainer=")}function community_videos_validarMultiple(a){a.action="/com-VideosValidarMultiple.php",a.submit()}function community_videos_changeValid(a,b){var c="/com-VideosValidar.php?id_video="+a+"&valid="+b;1==b?$(".app-community-video-status[data-id-video="+a+"]").load(c):common_openLayer("/com-AdminMotivo.php?urlAction="+encodeURIComponent(c)+"&resContainer="+encodeURIComponent(".app-community-video-status[data-id-video="+a+"]"))}function community_videos_comment_changeValid(a,b){var c="/com-VideosComentarioValidar.php?id_comentario="+a+"&valid="+b;1==b?$(".app-community-video-comment-status[data-id-video-comment="+a+"]").load(c):common_openLayer("/com-AdminMotivo.php?urlAction="+encodeURIComponent(c)+"&resContainer="+encodeURIComponent(".app-community-video-comment-status[data-id-video-comment="+a+"]"))}function community_videos_modif(a){window.location="/com-VideosModif.php?id_video="+a}function community_videos_delete(a){confirm('Are you sure you want to remove this video?')&&(window.location="/com-VideosDelete.php?id_video="+a)}function community_videos_new(a){return null===a&&(a=""),common_goEnsureLogged("/com-VideosNew.php?id_group="+a,"community")}function community_videos_new_verify_form(a){if(a.Titulo.value.trim().length<4)return alert('The title of the video must contain a minimum of four characters.'),a.Titulo.focus(),!1;if(a.HTMLCode.value.trim().length<10)return alert('Write the html code of the video that you want to upload.'),a.HTMLCode.focus(),!1;var b=a.Descripcion.value,c=community_debates_info_smiles(b);return c.numSmilies>3?(alert('Refrain from adding more than 3 emoticons, otherwise you\'ll get dizzy reading the message.'),!1):com_isCorrectVideoURL(a.HTMLCode.value)?($(a).find("input[type='submit']").attr("type","button"),!0):(alert('Html video code not valid.'+"\n\n"+'Copy the Youtube or Vimeo url where you found the video and paste it here (e.g. www.youtube.com/video/...)'),!1)}function community_videos_move(a){$(".app-community-video-move[data-id-video="+a+"]").show().load("/com-VideosMover.php?id_video="+a),$(document).one("mousedown",function(b){var c=$(".app-community-video-move[data-id-video="+a+"]");c.is(b.target)||0!==c.has(b.target).length||$(c).hide()})}function community_videos_move_run(a,b){$.get("/com-VideoMoverGroup.php?id_group="+a+"&id_video="+b,function(){var a=$(".app-community-video-move[data-id-video="+b+"]");$(a).hide()})}function community_fotos_validarMultiple(){document.frmValidarFotosMultiple.action="/com-FotosValidarMultiple.php?origen=1",document.frmValidarFotosMultiple.submit()}function community_fotos_validarMultipleList(){document.frmValidarFotosMultiple.action="/com-FotosValidarMultiple.php",document.frmValidarFotosMultiple.submit()}function community_fotos_changeValid(a,b){var c="/com-FotosValidar.php?id_foto="+a+"&valid="+b;1==b?$(".app-community-foto-status[data-id-foto="+a+"]").load(c):common_openLayer("/com-AdminMotivo.php?urlAction="+encodeURIComponent(c)+"&resContainer="+encodeURIComponent(".app-community-foto-status[data-id-foto="+a+"]"))}function community_fotos_comment_changeValid(a,b){var c="/com-FotosComentarioValidar.php?id_comentario="+a+"&valid="+b;1==b?$(".app-community-foto-comment-status[data-id-foto-comment="+a+"]").load(c):common_openLayer("/com-AdminMotivo.php?urlAction="+encodeURIComponent(c)+"&resContainer="+encodeURIComponent(".app-community-foto-comment-status[data-id-foto-comment="+a+"]"))}function community_fotos_modif(a){window.location="/com-AdminFotosModif.php?id_foto="+a}function community_fotos_delete(a){confirm('Are you sure you want to delete this photo?')&&(window.location="/com-AdminFotosDelete.php?id_foto="+a)}function community_fotos_new(a){return null===a&&(a=""),common_goEnsureLogged("/com-AdminFotosNew.php?id_group="+a,"community")}function community_fotos_new_verify_form(a){if($("input[name=Foto]").length&&a.Foto.value.length<1)return alert('You must select a date.'),a.Titulo.focus(),!1;if(a.Titulo.value.length<5)return alert('The title of the photo must contain a minimum of five characters'),a.Titulo.focus(),!1;var b=a.Descripcion.value,c=community_debates_info_smiles(b);return c.numSmilies>3?(alert('Refrain from adding more than 3 emoticons, otherwise you\'ll get dizzy reading the message.'),!1):($(a).find("input[type='submit']").attr("type","button"),!0)}function community_verify_comment(a,b){if(b)return a.submit(),!0;var c=community_debates_info_smiles(document.getElementById("Texto").value),d=community_debates_info_smiles(document.getElementById("mensaje").value);return c.size<10?(alert('The message must have a minimum of 10 characters.'),!1):c.size<d.size?(alert('Only content is allowed'),!1):c.numSmilies>3?(alert('Refrain from adding more than 3 emoticons, otherwise you\'ll get dizzy reading the message.'),!1):(a.submit(),!0)}function community_fotos_move(a){$(".app-community-foto-move[data-id-foto="+a+"]").show().load("/com-FotoMover.php?id_foto="+a),$(document).one("mousedown",function(b){var c=$(".app-community-foto-move[data-id-foto="+a+"]");c.is(b.target)||0!==c.has(b.target).length||$(c).hide()})}function community_fotos_move_run(a,b){$.get("/com-FotoMoverGroup.php?id_group="+a+"&id_foto="+b,function(){var a=$(".app-community-foto-move[data-id-foto="+b+"]");$(a).hide()})}function community_debates_tiny_add_img(a){common_callEnsureLogged(function(){(null===a||void 0===a)&&(a=""),common_isUploadAbleDevice()&&common_openLayer("/com-DebateContenidoFoto.php")},"community")}function community_debates_imgs_multi_add(){var a={},b=[],c="";if($("#frmImagen").find(".app-photo-uploaded-form").each(function(d,e){var f=$(e),g={foto:f.find('input[name="nombreFichero['+d+']"]').val(),x:f.find('input[name="xsize['+d+']"]').val(),y:f.find('input[name="ysize['+d+']"]').val(),xesp:f.find('input[name="xesp['+d+']"]').val(),yesp:f.find('input[name="yesp['+d+']"]').val(),titImagen:f.find('input[name="titImagen['+d+']"]').val(),id_foto:f.find('input[name="id_foto['+d+']"]').val()},h=community_debates_img_validate(d,e,g);h===!0?(b.push({nombreImagen:g.foto,titImagen:g.titImagen,id_foto:g.id_foto}),c+=community_debates_img_build(d,g)):$.extend(a,h)}),a.titulo){var d=[];for(var e in a)d.push(a[e]);return alert(d.join("\n")),!1}var f=$("#app-add-photo").data("selector")||"Texto",g=$("#"+f);return comInsertHtmlInContentEditable("<p>"+c+"</p>",g),common_closeLayer(),$.post("/com-DebateContenidoMultiFotoRun.php",{fotodata:b}),!1}function community_debates_img_build(a,b){if(b){var c="<strong>"+b.titImagen+'</strong><img class="block" src="'+b.foto+'" alt="'+b.descImagen+'">';return c}}function community_debates_img_validate(a,b,c){if(c){var d={},e=$(b).find('input[name="titImagen['+a+']"]');return c.titImagen.length<5?(d.titulo='The title of the photo must contain a minimum of five characters',e.css("border-color","red")):e.css("border-color",""),d.titulo?d:!0}}function community_debates_img_modify(a,b,c,d,e,f,g,h,i,j){return 1!=j&&null!==j?(alert('The image has not yet been uploaded'),!1):h.length<5?(alert('The title of the photo must contain a minimum of five characters'),!1):d.length<5?(alert('The description of the image must contain a minimum of four characters.'),!1):($.get("/com-DebateContenidoFotoRun.php?nombreImagen="+a+"&titImagen="+h+"&descImagen="+d+"&id_foto="+i),common_closeLayer(),!1)}function community_debates_errorAddingImageFromGalleryToEditor(){return alert("'"+this.name+"' failed to load."),!0}function community_debates_addImageFromGalleryToEditor(a,b){var c='<p><img class="block" src="'+a+'"></p>',d=$("#"+(b||"Texto"));return comInsertHtmlInContentEditable(c,d),!0}function community_debates_addImgFromGallery(a,b){var c=new Image;return c.name=a,c.onload=function(){community_debates_addImageFromGalleryToEditor(a,b)},c.onerror=community_debates_errorAddingImageFromGalleryToEditor,c.src=a,common_closeLayer(),!1}function community_debates_loadImageGallery(a){$("#dImagen1").load("/com-DebateContenidoFotoGaleria.php?selector="+a),$(".app-community-debates-img-title-mode").html('Photo gallery'),$(".com-modal-upload").remove()}function community_debates_loadImageUploader(){$("#dImagen1").load("/com-DebateContenidoFotoModo.php"),$(".app-community-debates-img-title-mode").html('Upload photo')}function community_debates_new_verify_form(a){if(common_isAndroidDevice()&&(a.Texto.value=$(".trumbowyg-editor").html()),!community_validar_captcha(a))return!1;if($("select[name=id_group]").length&&Number(a.id_group.value)<1&&0===Number(a.id_group.value))return alert('You must select the group in which you would like to post the discussion'),a.id_group.focus(),!1;if(a.Titulo.value.trim().length<4)return alert('The title must contain a minimum of four characters.'),a.Titulo.focus(),!1;if(a.Titulo.value=a.Titulo.value.trim(),-1!=a.Titulo.value.indexOf("\\"))return alert('El caracter \\ no esta permitido en el título'),!1;if(common_strip_html_tags(a.Texto.value).trim().length<20)return alert('Your comment must contain a minimum of 20 characters'),a.Texto.focus(),!1;var b=a.Texto.value,c=community_debates_info_smiles(b),d=common_htmlInfoWithVideos(b);return c.numSmilies>3?(alert('Refrain from adding more than 3 emoticons, otherwise you\'ll get dizzy reading the message.'),!1):d>3?(alert('Un consejo: pon solo los vídeos indispensables. Si pones más de 3, quien lo lea ¡no va a saber donde mirar!'),!1):($(a).find("input[type='submit']").attr("type","button"),!0)}function community_debates_info_smiles(a){var b;return $.ajax({type:"POST",async:!1,url:"/com-HtmlInfoWithSmilies.php",data:{html:a},success:function(a){b=a}}),b}function community_debates_modify_verify_form(a){if(a)return!0;var b=$("#Texto").trumbowyg("html"),c=community_debates_info_smiles(b),d=community_debates_info_smiles(document.getElementById("mensaje").value),e=common_htmlInfoWithVideos(b);return c.size<10?(alert('The message must have a minimum of 10 characters.'),!1):c.size<d.size?(alert('Only content is allowed'),!1):c.numSmilies>3?(alert('Refrain from adding more than 3 emoticons, otherwise you\'ll get dizzy reading the message.'),!1):e>3?(alert('Un consejo: pon solo los vídeos indispensables. Si pones más de 3, quien lo lea ¡no va a saber donde mirar!'),!1):!0}function community_debates_new(a){return common_goEnsureLogged("/com-DebateNuevo.php?id_group="+a,"community")}function community_debates_ordenar(a){document.frmComunidad.orden.value=a,document.frmComunidad.submit()}function community_debates_validar(a,b){var c;c=$("#calidadDebate").is(":checked")?"/com-DebatesValidar.php?puntos=1&id_tema="+a+"&valid="+b:"/com-DebatesValidar.php?id_tema="+a+"&valid="+b,1==b?$.get(c).then(function(b){$(".app-community-debate-status[data-id-tema="+a+"]").html(b)}):common_openLayer("/com-AdminMotivo.php?urlAction="+encodeURIComponent(c)+"&resContainer="+encodeURIComponent(".app-community-debate-status[data-id-tema="+a+"]"))}function community_debates_adminDebateTop(a,b,c){$.ajax({url:"/community.php?t=AdminDebateTop&idTema="+a+"&marcarTop="+b+"&idUserAccion="+c,success:function(){window.location=window.location.href}})}function community_debates_adminFusionarDebate(a,b){if(!confirm("Seguro que deseas fusionar estos 2 debates? Quedará sólo el "+a))return!1;var c="/community.php?t=AdminFusionarDebate&idTemaFinal="+a+"&idTema="+b;return $.get(c,function(a){1==a.errNo?(alert("ok"),window.location.reload()):alert("error en la fusión. Comprueba los ids")}),!1}function community_debates_editarPost(a){window.location="/com-MensajeEditar.php?id_post="+a}function community_debates_mensajeValidar(a,b,c){var d="/com-DebatesMensajeValidar.php?id_mensaje="+a+"&valid="+b+"&multiples="+c;1==b?$(".app-community-mensaje-status[data-id-mensaje="+a+"]").load(d):common_openLayer("/com-AdminMotivo.php?urlAction="+encodeURIComponent(d)+"&resContainer="+encodeURIComponent(".app-community-mensaje-status[data-id-mensaje="+a+"]"))}function community_debates_topicSubscription(a,b){common_callEnsureLogged(function(){$("#app-subscription-button").load("/com-DebateSuscripcion.php?id_tema="+a+"&accion="+b)},"community")}function community_debates_addVendorToTopic(a,b){var c=$("#suProvider_id-default").val(),d=0;$("#temaNegativo").is(":checked")&&(d=1),$.ajax({url:"/com-ManageVendorToTopic.php?accion=add&idEmpresa="+c+"&idTema="+b+"&temaNegativo="+d,success:function(){$("#lstEmpresas").append("<li>"+$("#suProvider-default").val()+"</li>"),$("#suProvider_id-default").val(""),$("#suProvider-default").val(""),$("#temaNegativo").attr("checked",!1)}})}function community_debates_deleteVendorToTopic(a,b){$.ajax({url:"/com-ManageVendorToTopic.php?accion=dlt&idEmpresa="+a+"&idTema="+b,success:function(){$("#lstEmpresas").append("<li>"+$("#suProvider-default").val()+"</li>"),$("#suProvider_id-default").val(""),$("#suProvider-default").val(""),$("#temaNegativo").attr("checked",!1),$("li[data-id="+a+"]").remove()}})}function community_debates_cambiarTituloDebate(a,b){if(confirm('Are you sure you want to change this discussion\'s title?')){var c="/community.php?t=AdminCambiarTituloDebate&idTema="+a+"&tituloDebate="+encodeURIComponent(b);return $.get(c,function(a){1==a.errNo?window.location.reload():alert('Error al modificar el título.\nComprueba el título introducido')}),!1}}function community_debates_indexar(a,b){var c,d=$(b),e=d.data("desindexar");c="/com-DebatesIndexar.php?idTema="+a+"&desindexar="+e;var f=$(".app-community-debate-index[data-id-tema="+a+"]");f.load(c);var g=$(".app-com-admin-tools-container[data-id-tema="+a+"]").find(".app-com-index-btn");e?(g.html("Indexar"),d.data("desindexar",0)):(g.html("Desindexar"),d.data("desindexar",1))}function community_debates_news(a,b){$("#comDebateNews").load("/com-DebatesNews.php?id_tema="+a+"&status="+b)}function community_debates_insertarPost(a,b){if(!community_validar_captcha(a))return!1;var c=$(a).find('[name="Texto"]').val(),d=common_htmlInfoWithSmilies(c);common_isAndroidDevice()&&($(a).find('[name="Texto"]').val($(a).find(".trumbowyg-editor").html()),c=$(a).find('[name="Texto"]').val(),d=common_htmlInfoWithSmilies(c));var e=common_htmlInfoWithVideos(c);return d.size<10?(alert('The message must have a minimum of 10 characters.'),!1):d.numSmilies>3&&!b?(alert('Refrain from adding more than 3 emoticons, otherwise you\'ll get dizzy reading the message.'),!1):e>3?(alert('Un consejo: pon solo los vídeos indispensables. Si pones más de 3, quien lo lea ¡no va a saber donde mirar!'),!1):(common_callEnsureLogged(function(){return $(a).find(":submit").attr("disabled",!0).parent().css("opacity","0.5").css("filter","alpha(opacity = 50)"),a.submit()},"community"),!1)}function community_debates_ask_user(a,b){common_callEnsureLogged(function(){"undefined"==typeof b?document.location.href="/com-DebateNuevo.php?idUser="+a:document.location.href="/com-DebateNuevo.php?idUser="+a+"&id_group="+b},"community")}function community_debates_verificaConocer(a){return a.Titulo.value.length<5?(alert('The title must contain a minimum of four characters.'),a.Titulo.focus(),!1):common_strip_html_tags(document.getElementById("Texto").value).trim().length<100?(alert('The message must have a minimum of 100 characters.'),!1):!0}function community_debate_cerrar(a,b){1==b?(url="/com-DebateAcciones.php?accion=cerrar&id_debate="+a+"&valor="+b,common_openLayer("/com-AdminMotivo.php?urlAction="+encodeURIComponent(url)+"&resContainer="+encodeURIComponent(".app-community-debate-status[data-id-tema="+a+"]")+"&tipoCerrar=1")):window.location="/com-DebateAcciones.php?accion=cerrar&id_debate="+a+"&valor="+b}function community_debate_mover(a){var b=$(".app-community-debate-move[data-id-tema="+a+"]");b.data("content-loaded")&&"group"!=b.data("content")?b.toggle():(b.load("/com-DebateMover.php?id_debate="+a,function(){b.data("content-loaded",1)}),b.data("content","list"),b.show())}function community_debate_moverSelectGroup(a,b){var c=$(".app-community-debate-move[data-id-tema="+b+"]");c.load("/com-DebateMoverGroup.php?id_group="+a+"&id_debate="+b),c.data("content","group")}function community_verificaBuscarComunidad(a){return a.txtSearch.value.length<1?(alert('You have still not inserted any search topic'),!1):!0}function community_likeItem(a,b,c,d){common_callEnsureLoggedAsync(function(){$.ajax({url:"/com-LikeItem.php?tipo="+b+"&id="+a+"&valor="+c,success:function(a){d(a)}})},"community")}function community_DestacadasHonorChangeYear(a){var b="/com-DestacadasHonor.php";null!=a&&(b+="?year="+a),window.location.href=b}function com_unlinkProfile(a){confirm('Are you sure that you want to unlink this profile?')&&$.ajax({type:"POST",async:!1,url:"/com-EnlazarCuentaQuitar.php",data:{idUser:a},success:function(a){window.location.reload()}})}function com_addAccount(){$("#opcionNewLinkedAccount").toggle()}function community_fotos_editarFotosDescripcion(a){window.location="/com-FotosComentarioEditar.php?idFoto="+a}function community_videos_editarVideosDescripcion(a){window.location="/com-VideosComentarioEditar.php?idVideo="+a}function CommunityHomeSlider(){this.headerIteracion=0,this.headerOrder=[1,3,0,2,5,4],this.headerDisposition=["right","left","right","left","right","left"],this.arrayIdTemasUsers=null;var a=this;$.ajax({url:"com-GruposChangeSliderItems.php",success:function(b){a.arrayIdTemasUsers=b.arrayIdTemasUsers}}),this.itemsShow=new Array(6)}function com_isCorrectVideoURL(a){return com_isYoutubeURL(a)||com_isVimeoURL(a)?!0:!1}function com_isYoutubeURL(a){var b=a.match(/^(?:https?:\/\/)?(?:www\.|m\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/);return b?!0:(b=a.match(/^(?:https?:\/\/)?(?:www\.|m\.)?(youtube|youtu\.be)\.com\/(watch\?[^#]*v=(\w+)|(\d+))(?:\S+)?$/),b?!0:!1)}function com_isVimeoURL(a){var b=a.match(/^(?:https?:\/\/)?(?:www\.|m\.)?(vimeo)\.com\/(watch\?[^#]*v=(\w+)|(\d+))(?:\S+)?$/);return b?!0:!1}function com_showPreview(){var a=$("#HTMLCode").val().trim(),b=$("#previewVideo");return $("#previewWindow").show(),b.data("url")==a&&a?!0:com_isCorrectVideoURL(a)?(b.html(com_embedVideo(a)).data("url",a),!0):(html='<div class="alert alert-error">'+'Html video code not valid.'+"</div>",b.html(html),b.data("url",""),!1)}function com_embedVideo(a){var b;return com_isYoutubeURL(a)?b=com_embedYoutubeURL(a):com_isVimeoURL(a)&&(b=com_embedVimeoURL(a)),b}function com_embedYoutubeURL(a){var b=a.match(/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/);return b?b=b[1]:(b=a.match(/^(?:https?:\/\/)?(?:www\.|m\.)?youtube\.com\/(watch\?[^#]*v=(\w+)|(\d+))([^#\&\?]*).*/),b=b[2]),"<iframe title='YouTube video player' width='420' height='280' src='"+window.location.protocol+"//www.youtube.com/embed/"+b+"' frameborder='0' allowfullscreen></iframe>"}function com_embedVimeoURL(a){var b=a.match(/^(?:https?:\/\/)?(?:www\.|m\.)?vimeo\.com\/(watch\?[^#]*v=(\w+)|(\d+))([^#\&\?]*).*/);return"<iframe title='Vimeo player' src='"+window.location.protocol+"//player.vimeo.com/video/"+b[1]+"?portrait=0&amp;color=ffffff' width='420' height='280' frameborder='0'></iframe>"}function com_GruposInitCarrouselFotosVideos(){var a=$("#app-carousel-photo").data("idgrupo");"undefined"==typeof a&&(a=$("#app-carousel-video").data("idgrupo")),"undefined"==typeof a&&(a="");var b=!1,c=function(){var c=this;b||(b=!0,$.ajax({url:"/com-GruposHomeFotosVideosAjax.php?idGrupo="+a,success:function(a){var b={visible:4,speed:300,pause:!0,start:0,scroll:4};b.btnPrev=".carousel-photo-prev",b.btnNext=".carousel-photo-next",$(".carousel-photo>ul").append(a.fotos).css("height","219px"),$(".carousel-photo").jCarouselLite(b),b.btnPrev=".carousel-video-prev",b.btnNext=".carousel-video-next",$(".carousel-video>ul").append(a.videos).css("height","219px"),$(".carousel-video").jCarouselLite(b),c.click()}}))};$(".carousel-photo-prev").on("click",c),$(".carousel-photo-next").on("click",c),$(".carousel-video-prev").on("click",c),$(".carousel-video-next").on("click",c)}function com_perfilShowDescripcionCompleta(a){$(".app-desc-perfil-complete").show(),$(".app-desc-perfil-short").hide(),$(a).remove()}function com_debateLoadRelatedInfo(a){$("#relatedDressesBox").load("/com-DebateRelatedContent.php?idTema="+a,null,function(){$(document).ready(function(){var a=$("#relatedContentBoxType").data("boxtype");null!=a&&""!=a&&(ga_trackEventAll("RelatedContentDebate","show"+a,"Forum topic related content",0,!0),$("#relatedDressesBox a").click(function(){ga_trackEventAll("RelatedContentDebate","click"+a,"Forum topic related content click",0,!0)}))})})}function com_enviarMensajeCapa(a,b){common_callEnsureLogged(function(){common_openLayer("/com-BuzonMensajeCapa.php?action=new&id_destinatario="+a,function(){new AjaxFormManager($("#frmMensaje"),AjaxFormManager.prototype.ERR_DISPLAY_BOX,null,function(a){common_closeLayer(),$(b).parent().append("<p class='color-green mb0 mt5 fs12'>"+'Message sent'+"</p>"),$(b).remove()})})},"community")}function community_empresas_add(a){if(isNaN(parseInt(a)))return!1;var b=Number($('input[name="idEmpresa"]').val());if(isNaN(b)||0===b)return $(".app-community-add-vendor-error").html('You must select the provider.').show(),!1;var c={idEmpresa:b,idCategory:a,status:6,listed:1,rating:1,zonaInsert:14,"public":1};return $.post("/tools/VendorsAdd",c,function(){$(".app-community-empresas-details").html("").load("/com-EmpresasUserDetails.php?successCnt=1"),common_closeLayer()}),!1}function community_empresas_add_from_capa(a){a.submit()}function community_empresas_delete(a,b){if(confirm('Are you sure that you want to remove this provider?')){var c=$(".app-community-vendor-entry").length,d={idEmpresa:$(a).data("id-empresa"),"public":2};$.post("/com-EmpresasUserChangeVisibility.php",d,function(){return b?void window.location.reload():($(".app-community-vendor-entry[data-id-empresa="+$(a).data("id-empresa")+"]").fadeOut(),$(".app-community-vendor-entry[data-id-empresa="+$(a).data("id-empresa")+"]").remove(),1==c&&$(".app-community-profile-vendors").fadeOut(),void $(".alert-success").fadeOut())})}}function community_empresas_close_capa(){SetCookieTime("hideMisEmpresas",1,30),common_closeLayer()}function community_check_empresa(a,b){$.ajax({url:"/com-CheckEmpresa.php",data:{tipoItem:a,idItem:b},success:function(a){alert(a)}})}function community_ban_user_layer(a){$("#app-common-layer").modal({remote:"/com-AdminBanUserLayer.php?idUser="+a})}function community_feed_user_layer(a){$("#app-common-layer").modal({remote:"/com-AdminFeedUserLayer.php?idUser="+a})}function community_badge_layer(a,b,c){$("#app-common-layer").modal({remote:"/com-LayerBadges.php?idBadge="+a+"&statusBadge="+b+"&userRol="+c})}function community_get_user_puntos(){return"undefined"!=typeof window.userNumPuntos?window.userNumPuntos:0}function com_plupload_initDebateFotoUploader(a,b){if(common_isAndroidDevice())var c={runtimes:"html5, html4",browse_button:"pickfiles",container:"uploadContainer",max_file_size:"10mb",url:"/com-DebateContenidoUpload.php",multi_selection:!1,file_data_name:"Imagen"+a,resize:{width:1024,quality:90},multipart:!0,filters:[{title:"Image files",extensions:"jpg,jpeg,gif,png"}],multipart_params:{nfile:a,tfile:"image"}};else var c={runtimes:"html5",browse_button:"pickfiles",container:"uploadContainer",max_file_size:"10mb",url:"/com-DebateContenidoUpload.php",multi_selection:!0,file_data_name:"Imagen"+a,resize:{width:1024,quality:90},multipart:!0,filters:[{title:"Image files",extensions:"jpg,jpeg,gif,png"}],multipart_params:{nfile:a,tfile:"image"}};var d=new plupload.Uploader(c);d.init(),d.bind("FilesAdded",function(a,b){common_charge_spin(".app-spinner-container"),b.length>20?(alert('The maximum number of photos uploaded is '+" 20"),d.splice(0,b.length)):d.start()}),d.bind("BeforeUpload",function(a,b){$("#spinner").show()});var e=[];return d.bind("UploadComplete",function(a,b,c){$("#spinner").hide();var d=$("#pickfiles").data("selector");community_uploadFotosDebate(e,d)}),d.bind("FileUploaded",function(a,b,c){if(common_stop_spin(".app-spinner-container"),null==c.status||200==c.status){var d=$.parseJSON(c.response);null==d.message?e.push(d):alert(d.message)}}),d}function community_uploadFotosDebate(a,b){var c=JSON.stringify(a);$(".com-modal-upload").remove(),$("#dImagen1").load("/com-DebateContenidoFotoShow.php",{fotosdata:c,selector:b})}function community_searchDebates(a,b){if(b)var c="which"in b?b.which:b.keyCode;var d=$(".app-suggest-debates-div-"+$(a).data("suffix")+":first"),e=$(a).val();if((!b||b&&c!=KEY_CODES.UP&&c!=KEY_CODES.DOWN&&c!=KEY_CODES.ENTER)&&$.getJSON("/json/findDebates.php?term="+e,function(b){var c,e,f,g;if(d.removeClass("loading").html("").show(),
navigationPos=0,maxNavigationPos=b.length,b.length<=1)return void($(a).val()?d.append($("<div />").addClass("suggest-message-no-results").html('No matches have been found')):d.append($("<div />").addClass("suggest-message-start-writing").html('Enter the name of the discussion and select it from the list.')));c=$("");for(var h=0;h<b.length-1;h++)if(e=b[h],"categ_map"==e.type&&"categ"==e.subtype)g=e.type,f='<li class="com-suggest-group-item app-mirror-link app-com-suggest-item app-suggest-item-navigation-'+(h+1)+'">    <i class="icon-com icon-com-group-'+e.id+' fleft mr10"></i>    <div class="overflow">        <a class="widget-list-name" href="'+e.url+'">'+e.label+"</a>    </div></li>",c=c.add(f);else{g=null;var i,j="",k="";k=e.avatar,e.categ&&(j="<a class='color-grey fleft' href='"+e.urlCateg+"'>"+e.categ+"</a>"),e.url?(i=k+"<div class='com-suggest-group-content'><a class='com-suggest-group-item-title' href='"+e.url+"'>"+e.label+"</a>"+j,i=i+"<small class='color-grey'>"+e.subLabel+"</small></div>"):i=k+e.label+j,f=$('<li class="app-com-suggest-item com-suggest-group-item" />').addClass("app-suggest-item-navigation-"+(h+1)).append(i),c=c.add(f)}d.css("width","350px").append($("<div/>").addClass("column-container").append($("<ul />").addClass("box-scroll").append(c))),"categ_map"!=g||d.hasClass("desplegable-comSearch-categ")?"categ_map"==g||d.hasClass("desplegable-comSearch")||(d.removeClass("desplegable-comSearch-categ"),d.addClass("desplegable-comSearch").addClass("desplegable-comSearch-temas")):(d.removeClass("desplegable-comSearch").removeClass("desplegable-comSearch-temas"),d.addClass("desplegable-comSearch-categ")),boxscroll=$(".box-scroll").css("maxHeight","350px").jScrollPane({contentWidth:"350px"}),api=boxscroll.data("jsp")}),b){if(c==KEY_CODES.UP&&navigationPos>0&&navigationPos--,c==KEY_CODES.DOWN&&navigationPos<maxNavigationPos&&navigationPos++,c==KEY_CODES.ENTER){b.preventDefault();var f=d.find(".app-suggest-item-navigation-"+navigationPos+" a");return f.length>0?(window.location.href=f.attr("href"),!1):!0}d.find(".app-com-suggest-item").removeClass("bg"),d.find(".app-suggest-item-navigation-"+navigationPos).addClass("bg");var g=d.find(".app-suggest-item-navigation-"+navigationPos);navigationPos>0&&navigationPos<maxNavigationPos&&(navigationPos==maxNavigationPos-1?api.scrollToElement(g,!0):api.scrollToElement(g))}}function community_searchDebatesAlertIfEmpty(a){community_searchDebates(a)}function community_searchDebatesReset(a){var b=$(".app-suggest-debates-div-"+$(a).data("suffix")+":first");setTimeout(function(){b.hide().html(""),$(a).val("")},300)}function com_openVideoLayer(a){common_openLayer("/com-DebateContenidoAddVideo.php?selector="+a)}function getYoutubeThumbnail(a,b){var c="";switch(b){case"large":c="0.jpg";break;case"medium":c="mqdefault.jpg";break;case"small":c="default.jpg";break;default:c="default.jpg"}return"https://i.ytimg.com/vi/"+a+"/"+c}function getVimeoThumbnail(a,b){var c=null;return $.ajax({type:"GET",url:"https://vimeo.com/api/v2/video/"+a+".json",async:!1,success:function(a){return c="small"===b?a[0].thumbnail_small:"medium"===b?a[0].thumbnail_medium:a[0].thumbnail_large}}),c}function getVimeoTitle(a){var b=null;return $.ajax({type:"GET",url:"https://vimeo.com/api/v2/video/"+a+".json",async:!1,success:function(a){b=a[0].title}}),b}function getYoutubeTitle(a){var b=null;return $.ajax({type:"GET",url:"https://www.googleapis.com/youtube/v3/videos?key=AIzaSyA_xJd_OALC4un_2KqWcF4RCDClM6cJ_6Q&id="+a+"&part=snippet&fields=items/snippet/title",async:!1,success:function(a){b=a.items[0].snippet.title}}),b}function getYoutubeCode(a){for(var b=[/youtu\.be\/([^\/|&|?"]*)/g,/youtube\.com\/v\/([^\/|&|?"]*)/g,/youtube\.com\/watch\?v=([^\/|&"]*)/g,/youtube\.com\/embed\/([^\/|&"]*)/g,/youtube\.com\/user\/[^\/|&"]*\#p\/[^\/|&"]*\/[^\/|&"]*\/([^\/|&"]*)$/g,/youtube\.com\/user\/[^\/|&"]*\#p\/[^\/|&"]*\/[^\/|&"]*\/[^\/|&"]*\/([^\/|&"]*)$/g,/ytimg\.com\/vi\/([^\/|&"]*)\/.*/g],c=0;c<b.length;c++){var d=b[c].exec(a);if(null!==d)return d[1]}return null==d&&(result=a.match(/^(?:https?:\/\/)?(?:www\.|m\.)?youtube\.com\/(watch\?[^#]*v=(\w+)|(\d+))([^#\&\?]*).*/),result)?result[2]:null}function com_showPreviewVideoDebates(a){var b=com_showPreview(),c=$("#HTMLCode").val().trim(),d=$("#app-modal-videocontainer");if(d.size()>0)b?(d.find("input").val(getVideoTitle(c)),d.show()):d.hide(function(){$(this).find(e).val("")}),$("#insertVideo").prop("disabled",!b);else{var e=$("#Titulo");e&&0==e.val().trim().length&&e.val(getVideoTitle(c))}}function getVimeoCode(a){for(var b=[/player\.vimeo\.com\/video\/([0-9]{1,10})/g,/vimeo\.com\/moogaloop.swf\?clip_id=([0-9]{1,10})/g,/vimeo\.com\/([0-9]{1,10})/g,/vimeo\.com\/groups\/[^\/|&"]*\/videos\/([0-9]{1,10})/g],c=0;c<b.length;c++){var d=b[c].exec(a);if(null!==d)return d[1]}return null}function isVideoFromYoutube(a){var b=new RegExp(/youtu\.be|youtube\.com/g);return b.test(a)}function isVideoFromVimeo(a){var b=new RegExp(/vimeo/g);return b.test(a)}function getVideoThumbnail(a){var b=null;if(isVideoFromYoutube(a)){var c=getYoutubeCode(a);b=getYoutubeThumbnail(c,"large")}else if(isVideoFromVimeo(a)){var c=getVimeoCode(a);b=getVimeoThumbnail(c,"medium")}return b}function getVideoCode(a){var b=null;return isVideoFromYoutube(a)?b=getYoutubeCode(a):isVideoFromVimeo(a)&&(b=getVimeoCode(a)),b}function getVideoTitle(a){var b=null;if(isVideoFromYoutube(a)){var c=getYoutubeCode(a);b=getYoutubeTitle(c)}else if(isVideoFromVimeo(a)){var c=getVimeoCode(a);b=getVimeoTitle(c)}return b}function community_sidebar_topUsers(){var a=$(".app-community-box-top-users"),b=a.data("idgroup");$.ajax({url:"/com-BoxTopUsersQuestion.php?idGroup="+b,success:function(b){a.html(b)}})}function community_sidebar_topAdmins(){var a=$(".app-community-box-top-admins");$.ajax({url:"/com-BoxTopAdmins.php",success:function(b){a.html(b)}})}function community_sidebar_relatedArticles(){var a=$(".app-sidebar-related-articles"),b=a.data("ids"),c=a.data("idcateg"),d=a.data("idtema");$.ajax({url:"/com-BoxRelatedArticles.php?idCateg="+c+"&ids="+b+"&idTema="+d,success:function(b){a.html(b)}})}function community_sidebar_nextThread(){var a=$(".app-community-box-next-thread"),b=a.data("idtema"),c=a.data("idgrupo");return $.ajax({url:"/com-BoxNextThread.php",data:{idTema:b,idGrupo:c}}).then(function(b){return a.html(b),b})}function open_newtopic_extended(){var a=$(".app-community-newtopic-preload-wrapper").data("grupo");return $.ajax({type:"GET",async:!0,url:"/com-DebateNuevo.php",data:{idGrupo:a}}).then(function(a){var b=$(a).find("form.discussion-form"),c=$(".app-community-newtopic-preload-wrapper"),d=$(".app-community-newtopic-wrapper");d.html(b),com_load_editor(".app-trumbowyg-editor",!0),c.hide(),$(".discussion-form-globe-title").val($(".app-community-newtopic-preload-text").val()),d.slideDown(function(){$(this).removeClass("dnone"),$("input[name=Titulo]").focus()})})}function com_load_editor(a,b){$.extend(jQuery.trumbowyg.langs.en,{bold:'Bold',em:'Italics',insertImage:'Insert image',insertVideo:'Insert a video',link:'Link',createLink:'Insert a link',unlink:'Delete a link',title:'Title',text:'Text',target:'Target',insertImageBodas:'Insert image',insertLinkBodas:'Insert a link',insertVideoBodas:'Insert a video',insertEmojiBodas:'Insert emoji',submit:'Send',reset:'Cancel'});var c;c=b?[["bold","italic"],["unlink"],["insertLinkBodas"],["insertImageBodas"],["insertVideoBodas"],["insertEmojiBodas"]]:[["bold","italic"],["unlink"],["insertLinkBodas"],["insertEmojiBodas"]];var d=$(a).trumbowyg({btns:c,svgPath:!1,semantic:!1});return d}function comMoveCursorToEnd(a){var b,c;document.createRange&&(b=document.createRange(),b.selectNodeContents(a),b.collapse(!1),c=window.getSelection(),c.removeAllRanges(),c.addRange(b))}function comSaveSelection(){return window.getSelection?(sel=window.getSelection(),sel.getRangeAt&&sel.rangeCount&&(savedRange=sel.getRangeAt(0))):document.selection&&document.selection.createRange&&(savedRange=document.selection.createRange()),null}function comRestoreSelection(a,b){a?window.getSelection?(sel=window.getSelection(),sel.removeAllRanges(),sel.addRange(a)):document.selection&&a.select&&a.select():(comMoveCursorToEnd(b.closest(".trumbowyg-editor-visible").find(".trumbowyg-editor")[0]),savedRange=comSaveSelection(),b.trumbowyg("html","<p><br></p>"))}function comInsertHtmlAtCursor(a){var b,c;if(window.getSelection){if(b=window.getSelection(),b.getRangeAt&&b.rangeCount){c=b.getRangeAt(0),c.deleteContents();var d=document.createElement("span");d.innerHTML=a;for(var e,f,g=document.createDocumentFragment();e=d.firstChild;)f=g.appendChild(e);c.insertNode(g)}}else document.selection&&document.selection.createRange&&(document.selection.createRange().innerHTML=a)}function comInsertHtmlInContentEditable(a,b){var c=b.closest(".trumbowyg-editor-visible").find(".trumbowyg-editor"),d=c[0];comRestoreSelection(savedRange,b),comInsertHtmlAtCursor(a);var e=$(d).html();e=e.replace(/<br>/gi,""),e=e.replace(/<p><\/p>/gi,"<p><br></p>"),e=e.replace(/<p><br><\/p><p/gi,"<p"),b.trumbowyg("html",e),setTimeout(function(){$(d).html($(d).html().replace(/<p><\/p>/gi,"<p><br></p>").replace(/<p><br><\/p><p/gi,"<p"));var a=$(d).html();'"></p>'==a.slice(-6)&&(a+="<p><br></p>",$(d).html(a)),b.trumbowyg("html",a),comMoveCursorToEnd(d)},100)}var savedRange;ProfileLayer=function(){this.lastId=0,this.idTimeout=null},ProfileLayer.prototype={show:function(a,b,c){var d=this,e=++this.lastId;this._resetTimeout(),this.idTimeout=setTimeout(function(){d._innerShow(a,b,c,e)},400),a.mouseleave(function(a){d._resetTimeout(),d.hide(b,e)})},hide:function(a,b){var c=this;c._innerHide(a,b)},_resetTimeout:function(){null!==this.idTimeout&&(clearTimeout(this.idTimeout),this.idTimeout=null,this.lastId++)},_innerShow:function(a,b,c,d){if(this.currentIdUser!=b&&!(d<this.lastId)){this.currentIdUser=b;var e=this;$.ajax({url:"/com-CapaPerfil.php?id_user="+b,success:function(f){if(!(d<e.lastId)){var g=$("<div/>").addClass("com-user-card-layer").html(f),h=common_getPosition(c);if(h.x>700&&g.addClass("com-user-card-left"),g.mouseleave(function(a){e.hide(b,d)}),g.mouseover(function(a){e._resetTimeout()}),!(d<e.lastId)){var i=a.find("a:first");i.length>0&&g.click(function(){window.location=i.attr("href")}),a.append(g),g.animate({opacity:0,right:"-390px"},0),g.animate({opacity:1,right:"-395px"},150)}}}})}},_innerHide:function(a){layer=$(".com-user-card-layer"),layer.fadeOut(100,function(){$(this).remove()}),this.currentIdUser=null}},CommunityHomeSlider.prototype.refresh=function(a){var b=0;b=null!=a?$(a).find(".app-lnkHomeSlider"):$(".app-lnkHomeSlider"),b.each(function(a,b){var c=$(b),d=c.attr("href"),e=c.data("idtema");$(".app-lnkrelHomeSlider-"+e).css("cursor","pointer").on("click",function(){window.location=d})})},CommunityHomeSlider.prototype.start=function(){this.refresh();var a=this;setInterval(function(){a.next()},2e3)},CommunityHomeSlider.prototype.next=function(){var a=this.headerOrder[this.headerIteracion++%this.headerOrder.length],b=this.headerDisposition[a];if(null!=this.arrayIdTemasUsers){var c=this.arrayIdTemasUsers;for(i=0;i<6;i++)this.itemsShow[i]=$(".app-slider-position[data-position="+i+"]").data("item");var d=0;if(c.length>0)for(;d++<500;){var e=Math.floor(Math.random()*c.length),f=parseInt(c[e].ID_TEMA);if(-1==this.itemsShow.indexOf(f)){var g=$(c[e]["html_"+b]),h=$(".app-slider-position[data-position="+a+"]"),j=$(h.children()[0]);h.data("item",f),g.css({opacity:0,position:"relative",top:"20px"}),g.css("display","none"),h.append(g),j.hide(),g.show(),g.animate({opacity:1,top:"0px"},300,"easeOutBack"),j.remove(),this.refresh(g);break}}return!1}};var KEY_CODES={UP:38,DOWN:40,ENTER:13};$(document).ready(function(){if($(document).mouseup(function(a){for(var b=$(".search-input"),c=["#txtDebatesSearch",".app-suggest-debates-div-default"],d=0;d<c.length;d++){var b=$(c[d]);if(b.is(a.target)||b.has(a.target).length>0)break}b.is(a.target)||0!==b.has(a.target).length||$(".app-suggest-debates-div-default").hide()}),$(document.body).hasClass("app-has-masonry")){var a=$(".app-fav-list");a.imagesLoaded(function(){a.masonry({itemSelector:".app-fav-list-item",transitionDuration:0})})}$(".app-trumbowyg-editor").length>0&&com_load_editor(".app-trumbowyg-editor",!0),$(document.body).on("click",".app-trumbowyg-editor-onclick",function(){$(".app-trumbowyg-fake").hide(),$(".app-trumbowyg-hide").removeClass("dnone"),$(".trumbowyg-editor").first().focus()}),$(".app-trumbowyg-editor-no-pictures-upload").length>0&&com_load_editor(".app-trumbowyg-editor-no-pictures-upload",!1),$(".app-community-fotos-max-width img").each(function(){var a=520,b=$(this).width();b>a&&$(this).css("width",a)});var b=new ProfileLayer;if($(".app-community-profile-layer").each(function(){var a=$(this).data("id-user");null!==a&&$(this).mouseenter(function(c){b.show($(this),a,c)})}),$(document.body).hasClass("app-community-perfil")&&($(".app-community-mail-change-button").on("click",function(){$(this).hide(),$(".app-community-mail-change-div").show().find("input[name=newEmail]").focus()}),$(".app-community-mail-change-cancel-button").on("click",function(){$(".app-community-mail-change-div").hide(),$(".app-community-mail-change-button").show()}),$(".app-community-password-change-button").on("click",function(){$(this).hide(),$(".app-community-password-change-msg-success").hide(),$(".app-community-password-change-div").show()}),$(".app-community-password-change-cancel-button").on("click",function(){$(".app-community-password-change-div").hide(),$(".app-community-password-change-button").show()}),$(".app-community-baja-link").on("click",function(){$(this).hide(),$(".app-community-baja-div").show()}),$(".app-community-baja-cancel-button").on("click",function(){$(".app-community-baja-div").hide(),$(".app-community-baja-link").show()}),window.location.href.indexOf("changeMail")>-1&&($(".app-community-mail-change-button").trigger("click"),$(document.body).animate({scrollTop:$("input[name=newEmail]").offset().top},1e3))),$(document.body).hasClass("app-community-search-users")&&($("[class*=app-community-search-users-]").on("click",function(){$(this).find(".droplayer:first").is(":visible")?$(this).find(".droplayer:first").hide():($(".droplayer").hide(),$(this).find(".droplayer:first").show())}),$(document.body).on("click",".app-community-search-users-calendar-datepicker",function(){var a=$(this).find("input:first"),b=a.next("span");a.datepicker({appendElement:".app-community-search-users-calendar-append-html"}),a.datepicker("show").on("changeDate",function(a){$("input[name=mesBoda]").val(a.date.getMonth()+1+"/"+a.date.getFullYear()),$(this).datepicker("hide"),community_search_users_submit()});var c=b.offset();$(".datepicker").css({top:c.top+30,left:c.left})}),$(document.body).on("click",".app-community-search-users-calendar-append-html",function(a){a.stopPropagation(),community_search_users_reset_fecha()})),$(".app-perfil-boda-layer","#misTags").on("click",function(){var a,b=$(this),c=b.parent().data("grupo"),d=b.data("id"),e=b.data("notext"),f=$("span",b).attr("class"),g=$("small",b).html();1==c?a="color":3==c?a="temporada":2==c&&(a="estilo");var h=$("#misTags").data("url-base-buscador")+"?"+a+"="+d;$("i[data-grupo="+c+"]","#misTags").removeClass().addClass(f),e?$("span[data-grupo="+c+"]","#misTags").attr("href",h):$("span[data-grupo="+c+"]","#misTags").html(g).attr("href",h),$("span[data-grupo="+c+"]","#misTags").next("a").remove(),$.post("/com-PerfilCambiarTag.php",{grupo:c,id:d}),$("i[data-grupo="+c+"]","#misTags").parent(".com-profile-aboutwedding-icon-miss").removeClass("com-profile-aboutwedding-icon-miss"),$(".app-about-wedding-layer").addClass("dnone")}),$(".app-perfil-boda","#susTags").on("click",function(){window.location.href=$("a:first",$(this).parent().next()).attr("href")}),$(".app-perfil-boda-layer","#app-members-search").on("click",function(){var a=$(this),b=a.data("id"),c=a.closest(".app-perfil-show"),d=c.data("grupo");$("input[data-grupo='"+d+"']").val(b),c.closest("form").submit()}),$("#app-mis-grupos-box-show").on("click",function(a){a.preventDefault(),$(this).parent().remove(),$("#app-mis-grupos-box").slideDown("slow")}),$("#app-general-grupos-box-show").on("click",function(a){a.preventDefault(),$("#app-general-grupos-box").slideDown("slow"),$(this).parent().delay(1e3).remove()}),$(".app-debates-urlref").each(function(){var a=$(this).data("urlref"),b=$(".app-"+a).attr("href");$(this).css("cursor","pointer").click(function(){window.location=b})}),$(document.body).on("click",".app-community-item-like",function(a){a.preventDefault();var b=$(this),c=$(this).data("iditem"),d=$(this).data("idtipo");$(this).children().hasClass("icon-fav-on-border")?community_likeItem(c,d,1,function(){b.children().toggleClass("icon-fav-on icon-fav-on-border")}):community_likeItem(c,d,0,function(){b.children().toggleClass("icon-fav-on-border icon-fav-on")})}),$(document.body).on("click","ul li.app-gotohref",function(a){var b=$(this).find("a:first");b.length>0&&(a.preventDefault(),window.location=$(this).find("a:first").attr("href"))}),($("#app-carousel-video").length>0||$("#app-carousel-photo").length>0)&&com_GruposInitCarrouselFotosVideos(),$("#comGrupoHeader").length>0){var c=new CommunityHomeSlider;c.start()}if($("#buscarSelTodos").on("ifChanged",function(){$(this).is(":checked")?$("input[name='idUsersEncontrados[]']").iCheck("check"):$("input[name='idUsersEncontrados[]']").iCheck("uncheck")}),$("#invitarSelTodos").on("ifChanged",function(){$(this).is(":checked")?$("input[name='contactos[]']").iCheck("check"):$("input[name='contactos[]']").iCheck("uncheck")}),$(".app_scroll_to_replies").click(function(){$("html, body").animate({scrollTop:$("#replies").offset().top-20},"slow")}),$(document.body).hasClass("app-carousel-banner-init")){var d={visible:1,speed:300,auto:!0,btnGo:[".1",".2",".3",".4"]};$(".app-carousel-banner").jCarouselLite(d)}if($(".app-community-box-top-users").length>0&&community_sidebar_topUsers(),$(".app-community-box-top-admins").length>0&&community_sidebar_topAdmins(),$(".app-sidebar-related-articles").length>0&&community_sidebar_relatedArticles(),$(".app-community-box-next-thread").length>0&&community_sidebar_nextThread().then(function(){if(!common_isIpadNew()){var a=$(window),b=$(".app-community-box-next-thread"),c=$(".app-inner-next-thread"),d={top:b.offset().top};if(c.length){window.setInterval(function(){d.top=b.offset().top},100),$(".app-com-sidebar").addClass("relative");var e=$(".wrapper.main");setTimeout(function(){a.on("scroll",function(){var f=a.scrollTop(),g=c.offset().top+c.outerHeight(!0),h=e.position().top+e.outerHeight(!0),i=e.find(".app-sticky-main");i.position().top+i.outerHeight(!0)<b.offset().top+c.outerHeight(!0)||(f+30>=d.top?g>h?f<=c.offset().top-45&&c.hasClass("widget-sticky-bottom")?c.removeClass("widget-sticky-bottom").addClass("widget-sticky"):c.removeClass("widget-sticky").addClass("widget-sticky-bottom"):(c.removeClass("widget-sticky-bottom").addClass("widget-sticky"),c.width(b.closest(".app-com-sidebar").width())):c.removeClass("widget-sticky"))})},300)}}}),$(".app-community-box-groups").length>0){var e=$(".app-community-box-groups");$.ajax({url:"/com-GruposContentBox.php",success:function(a){e.html(a)}})}if($(".app-community-box-group-show").length>0){var e=$(".app-community-box-group-show"),f=e.data("idgroup");$.ajax({url:"/com-GrupoShowContentBox.php?idGroup="+f,success:function(a){e.html(a)}})}if($(document.body).on("click","#insertVideo",function(a){var b=$("#HTMLCode").val().trim(),c=$("#videoTitle").val(),d=isVideoFromYoutube(b)?"youtube":"vimeo",e=$("#"+($(this).data("selector")||"Texto")),f='<p class="app-video-wrapper"><strong class="topic-video-title">'+c+'</strong><img class="app-video-preview block '+d+'-video topic-video-wrapper" src="'+getVideoThumbnail(b)+'" width="450" height="300"  data-host-id="'+getVideoCode(b)+'" frameborder="0"></p>';comInsertHtmlInContentEditable(f,e),common_closeLayer()}),$(document.body).on("input change paste","#HTMLCode",function(a){com_showPreviewVideoDebates(a),$("#previewVideo > iframe").attr("style","width:100%;height:300px;")}),$(document.body).on("click",".app-unlink-profile",function(){if(confirm('Are you sure that you want to unlink this profile?')){var a=this,b=a.getAttribute("data-idUser");$.ajax({type:"POST",async:!1,url:"/com-EnlazarCuentaQuitar.php",data:{idUser:b},success:function(b){a.remove(),$(".app-txt-link-profile").remove();var c=$(".app-cuenta-enlazada-remove");c.show(),c.append("<p></p>").addClass("fa fa-check").html('Account unlinked'),$(".linkedAccount").show()}})}}),$(".dropmenu-item, .dropmenu-item-all").click(function(){var a=$(this).data("type"),b=$(this).data("id");$("input[name$="+a+"]").val(b),community_search_users_submit()}),$(document.body).on("click",".app-box-quote-action",function(){$(this).parent().find(".box-quote").slideToggle()}),$(document.body).on("click","#app-quote-delete",function(a){a.preventDefault(),$("#idCitado").val(""),$("#mensajeCitado").val(""),$("#idMensajeCitado").val(""),$("#app-quote-box").addClass("dnone")}),$(document.body).on("click",".app-community-topic-validate",function(){community_debates_validar($(this).data("idtema"),$(this).data("option"))}),$(".app-community-topic-checkastop").click(function(){community_debates_adminDebateTop($(this).data("idtema"),$(this).data("action"),$(this).data(""))}),$(".app-community-topic-fusion").click(function(){community_debates_adminFusionarDebate($(this).data("idfinaltema"),$(this).prev().val())}),$(".app-member-filter-category").hover(function(){$(this).removeClass("tag-grey").addClass("tag-red")},function(){$(this).hasClass("selected")||$(this).removeClass("tag-red").addClass("tag-grey")}),$(".app-related-dresses-box").length>0){var g=$(".app-related-dresses-box").data("idtema");com_debateLoadRelatedInfo(g)}$(".app-community-newtopic-preload-text").focus(function(){common_callEnsureLogged(function(){open_newtopic_extended()},"community")}),$(".app-community-newtopic-preload-foto").click(function(){common_callEnsureLoggedAsync(function(){var a=open_newtopic_extended();a.then(function(){common_openLayer("/com-DebateContenidoFoto.php")})},"community")}),$(".app-community-newtopic-preload-video").click(function(){common_callEnsureLoggedAsync(function(){var a=open_newtopic_extended();a.then(function(){com_openVideoLayer("Texto")})},"community")}),$(".app-community-fotos_new").click(function(){community_fotos_new("")}),$(document.body).on("show.bs.modal",".modal",function(){var a=1040+10*$(".modal:visible").length;$(this).css("z-index",a),setTimeout(function(){$(".modal-backdrop").not(".modal-stack").css("z-index",a-1).addClass("modal-stack")},0)}),$(".app-alert-close").click(function(){$(this).parent(".alert").fadeOut()}),$(".app-user-search-icon").click(function(){community_search_users_submit()});var h=!1;$(document.body).on("click",".app-com-media-item-layer",function(a){if(a.preventDefault(),h)return!1;var b=$(this),c=b.data("modal-href"),d="app-com-item-layer",e=$("#"+d);return 0===e.length&&($(document.body).append('<div id="'+d+'" class="modal"></div>'),e=$("#"+d)),h=!0,$.get(c).done(function(a){h=!1,e.html(a),(e.data("bs.modal")||{}).isShown||e.modal(),$(".modal-backdrop").addClass("modal-backdrop-white")}).always(function(){h=!1}),!1}),$(document.body).on("click",".app-com-profile-badge",function(){var a=$(this).data("id-badge"),b=$(this).data("rol"),c=$(this).hasClass("inactive-badge");community_badge_layer(a,c,b)});var i=$(".app-animate-search");if(i.length>0){$("#search").show();var j=i.find(".app-animate-search-input");searchPlaceholderAnimation(j,!1),$(document.body).on("click",".app-animate-search",function(){var a=$(".app-search-close");searchPlaceholderAnimation(j,!1),searchPlaceholderText(j,a,"enter");var b=$(this).find(".droplayer");$(document).bind("mousedown",function(c){var d=b;d.is(c.target)||0!==d.has(c.target).length||$(".app-animate-search-input").is(c.target)||(hideSuggest(d),searchRemoveContent(j),searchPlaceholderText(j,a,"exit"),$(document).unbind("mousedown",arguments.callee))})})}$(".app-preview-modif-video").length>0&&(com_showPreview(),$("#previewVideo > iframe").attr("style","width:100%;height:300px;")),$(document.body).on("submit","#app-insert-link-form",function(a){a.preventDefault();var b=$(this),c=$(b.data("trumbo-selector")),d=b[0].link.value;0!==d.indexOf("https://")&&0!==d.indexOf("http://")&&(d="http://"+d);var e=" <a href='"+d+"'>"+b[0].linkName.value+"</a> ";comInsertHtmlInContentEditable(e,c),$("#app-common-layer").modal("hide")}),$(document.body).on("blur keyup click",'.trumbowyg-editor[contenteditable="true"]',function(){comSaveSelection(),""==$(this).html()&&$(this).html("<p><br></p>")}),$(document.body).on("drop paste",'.trumbowyg-editor[contenteditable="true"]',function(){setTimeout(function(){comSaveSelection();var a=["div","a","p","span"],b=["button","i","small","ul"],c=["pre","h1","h2","h3","h4","h5","table","li","td","tr","th"],d=$('.trumbowyg-editor[contenteditable="true"]');d.find("img").removeAttr("style"),$.each(a,function(a,b){d.find(b).removeAttr("class"),d.find(b).removeAttr("style")}),$.each(b,function(a,b){$.each(d.find(b),function(){$(this).replaceWith($(this).html())})}),$.each(c,function(a,b){$.each(d.find(b),function(){$(this).replaceWith($(this).html()).wrap("<p></p>")})})},0)}),$(document.body).on("click",".com-submit-no-foto",function(){common_stop_spin(".app-spinner-container"),window.popupRecorte&&(window.popupRecorte.close(),$("#app-common-layer").modal("hide"))}),$(document.body).on("click",".app-set-post-listing-type",function(){var a=$(this).data("listing-type");"undefined"!=typeof a&&bodas.setCookieSession("lt",a)}),$(document.body).on("submit",".app-com-message-form",function(){return community_debates_insertarPost(this,this.idCitado.value)}),$(document.body).on("submit",".app-com-topic-form",function(){return community_debates_new_verify_form(this)})}),jQuery.trumbowyg={langs:{en:{viewHTML:"View HTML",undo:"Undo",redo:"Redo",formatting:"Formatting",p:"Paragraph",blockquote:"Quote",code:"Code",header:"Header",bold:"Bold",italic:"Italic",strikethrough:"Stroke",underline:"Underline",strong:"Strong",em:"Emphasis",del:"Deleted",superscript:"Superscript",subscript:"Subscript",unorderedList:"Unordered list",orderedList:"Ordered list",insertImage:"Insert Image",link:"Link",createLink:"Insert link",unlink:"Remove link",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",horizontalRule:"Insert horizontal rule",removeformat:"Remove format",fullscreen:"Fullscreen",close:"Close",submit:"Confirm",reset:"Cancel",required:"Required",description:"Description",title:"Title",text:"Text",target:"Target"}},plugins:{},svgPath:null},function(a,b,c,d){"use strict";d.fn.trumbowyg=function(a,b){var c="trumbowyg";if(a===Object(a)||!a)return this.each(function(){d(this).data(c)||d(this).data(c,new e(this,a))});if(1===this.length)try{var f=d(this).data(c);switch(a){case"execCmd":return f.execCmd(b.cmd,b.param,b.forceCss);case"openModal":return f.openModal(b.title,b.content);case"closeModal":return f.closeModal();case"openModalInsert":return f.openModalInsert(b.title,b.fields,b.callback);case"saveRange":return f.saveRange();case"getRange":return f.range;case"getRangeText":return f.getRangeText();case"restoreRange":return f.restoreRange();case"enable":return f.toggleDisable(!1);case"disable":return f.toggleDisable(!0);case"destroy":return f.destroy();case"empty":return f.empty();case"html":return f.html(b)}}catch(g){}return!1};var e=function(a,e){var f=this,g="trumbowyg-icons";f.doc=a.ownerDocument||c,f.$ta=d(a),f.$c=d(a),e=e||{},null!=e.lang||null!=d.trumbowyg.langs[e.lang]?f.lang=d.extend(!0,{},d.trumbowyg.langs.en,d.trumbowyg.langs[e.lang]):f.lang=d.trumbowyg.langs.en;var h=null!=d.trumbowyg.svgPath?d.trumbowyg.svgPath:e.svgPath;if(f.hasSvg=h!==!1,f.svgPath=f.doc.querySelector("base")?b.location.href.split("#")[0]:"",0===d("#"+g,f.doc).length&&h!==!1){if(null==h)try{throw new Error}catch(i){var j=i.stack.split("\n");for(var k in j)if(j[k].match(/http[s]?:\/\//)){h=j[Number(k)].match(/((http[s]?:\/\/.+\/)([^\/]+\.js))(\?.*)?:/)[1].split("/"),h.pop(),h=h.join("/")+"/ui/icons.svg";break}}var l=f.doc.createElement("div");l.id=g,f.doc.body.insertBefore(l,f.doc.body.childNodes[0]),d.ajax({async:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"xml",url:h,data:null,beforeSend:null,complete:null,success:function(a){l.innerHTML=(new XMLSerializer).serializeToString(a.documentElement)}})}var m=f.lang.header,n=function(){return(b.chrome||b.Intl&&Intl.v8BreakIterator)&&"CSS"in b};f.btnsDef={viewHTML:{fn:"toggle"},undo:{isSupported:n,key:"Z"},redo:{isSupported:n,key:"Y"},p:{fn:"formatBlock"},blockquote:{fn:"formatBlock"},h1:{fn:"formatBlock",title:m+" 1"},h2:{fn:"formatBlock",title:m+" 2"},h3:{fn:"formatBlock",title:m+" 3"},h4:{fn:"formatBlock",title:m+" 4"},subscript:{tag:"sub"},superscript:{tag:"sup"},bold:{key:"B",tag:"b"},italic:{key:"I",tag:"i"},underline:{tag:"u"},strikethrough:{tag:"strike"},strong:{fn:"bold",key:"B"},em:{fn:"italic",key:"I"},del:{fn:"strikethrough"},createLink:{tag:"a"},unlink:{},insertImage:{},justifyLeft:{tag:"left",forceCss:!0},justifyCenter:{tag:"center",forceCss:!0},justifyRight:{tag:"right",forceCss:!0},justifyFull:{tag:"justify",forceCss:!0},unorderedList:{fn:"insertUnorderedList",tag:"ul"},orderedList:{fn:"insertOrderedList",tag:"ol"},horizontalRule:{fn:"insertHorizontalRule"},removeformat:{},fullscreen:{"class":"trumbowyg-not-disable"},close:{fn:"destroy","class":"trumbowyg-not-disable"},formatting:{dropdown:["p","blockquote","h1","h2","h3","h4"],ico:"p"},link:{dropdown:["createLink","unlink"]}},f.o=d.extend(!0,{},{lang:"en",useComposition:!0,fixedBtnPane:!1,fixedFullWidth:!1,autogrow:!1,prefix:"trumbowyg-",semantic:!0,resetCss:!1,removeformatPasted:!1,tagsToRemove:[],btnsGrps:{design:["bold","italic","underline","strikethrough"],semantic:["strong","em","del"],justify:["justifyLeft","justifyCenter","justifyRight","justifyFull"],lists:["unorderedList","orderedList"]},btns:[["viewHTML"],["undo","redo"],["formatting"],"btnGrp-semantic",["superscript","subscript"],["link"],["insertImage"],"btnGrp-justify","btnGrp-lists",["horizontalRule"],["removeformat"],["fullscreen"]],btnsDef:{},inlineElementsSelector:"a,abbr,acronym,b,caption,cite,code,col,dfn,dir,dt,dd,em,font,hr,i,kbd,li,q,span,strikeout,strong,sub,sup,u",pasteHandlers:[],imgDblClickHandler:function(){return!1},plugins:{}},e),f.disabled=f.o.disabled||"TEXTAREA"===a.nodeName&&a.disabled,e.btns?f.o.btns=e.btns:f.o.semantic||(f.o.btns[4]="btnGrp-design"),d.each(f.o.btnsDef,function(a,b){f.addBtnDef(a,b)}),f.eventNamespace="trumbowyg-event",f.keys=[],f.tagToButton={},f.tagHandlers=[],f.pasteHandlers=[].concat(f.o.pasteHandlers),f.init()};e.prototype={init:function(){var a=this;a.height=a.$ta.height(),a.initPlugins();try{a.doc.execCommand("enableObjectResizing",!1,!1),a.doc.execCommand("defaultParagraphSeparator",!1,"p")}catch(b){}a.buildEditor(),a.buildBtnPane(),a.fixedBtnPaneEvents(),a.buildOverlay(),setTimeout(function(){a.disabled&&a.toggleDisable(!0),a.$c.trigger("tbwinit")})},addBtnDef:function(a,b){this.btnsDef[a]=b},buildEditor:function(){var a=this,c=a.o.prefix,e="";a.$box=d("<div/>",{"class":c+"box "+c+"editor-visible "+c+a.o.lang+" trumbowyg"}),a.isTextarea=a.$ta.is("textarea"),a.isTextarea?(e=a.$ta.val(),a.$ed=d("<div/>"),a.$box.insertAfter(a.$ta).append(a.$ed,a.$ta)):(a.$ed=a.$ta,e=a.$ed.html(),a.$ta=d("<textarea/>",{name:a.$ta.attr("id"),height:a.height}).val(e),a.$box.insertAfter(a.$ed).append(a.$ta,a.$ed),a.syncCode()),a.$ta.addClass(c+"textarea").attr("tabindex",-1),a.$ed.addClass(c+"editor").attr({contenteditable:!0,dir:a.lang._dir||"ltr"}).html(e),a.o.tabindex&&a.$ed.attr("tabindex",a.o.tabindex),a.$c.is("[placeholder]")&&a.$ed.attr("placeholder",a.$c.attr("placeholder")),
a.o.resetCss&&a.$ed.addClass(c+"reset-css"),a.o.autogrow||a.$ta.add(a.$ed).css("min-height",a.height).css("max-height",a.height+250),a.semanticCode();var f,g=!1,h=!1;a.$ed.on("dblclick","img",a.o.imgDblClickHandler).on("keydown",function(b){if(h=a.o.useComposition&&229===b.which,b.ctrlKey){g=!0;var c=a.keys[String.fromCharCode(b.which).toUpperCase()];try{return a.execCmd(c.fn,c.param),!1}catch(d){}}}).on("keyup input",function(b){b.which>=37&&b.which<=40||(!b.ctrlKey||89!==b.which&&90!==b.which?g||17===b.which||h||(a.semanticCode(!1,13===b.which),a.$c.trigger("tbwchange")):a.$c.trigger("tbwchange"),setTimeout(function(){g=!1},200))}).on("mouseup keydown keyup",function(){clearTimeout(f),f=setTimeout(function(){a.updateButtonPaneStatus()},50)}).on("focus blur",function(b){a.$c.trigger("tbw"+b.type),"blur"===b.type&&d("."+c+"active-button",a.$btnPane).removeClass(c+"active-button "+c+"active")}).on("cut",function(){setTimeout(function(){a.semanticCode(!1,!0),a.$c.trigger("tbwchange")},0)}).on("paste",function(c){if(a.o.removeformatPasted){c.preventDefault();try{var e=b.clipboardData.getData("Text");try{a.doc.selection.createRange().pasteHTML(e)}catch(f){a.doc.getSelection().getRangeAt(0).insertNode(a.doc.createTextNode(e))}}catch(g){a.execCmd("insertText",(c.originalEvent||c).clipboardData.getData("text/plain"))}}d.each(a.pasteHandlers,function(a,b){b(c)}),setTimeout(function(){a.semanticCode(!1,!0),a.$c.trigger("tbwpaste",c)},0)}),a.$ta.on("keyup paste",function(){a.$c.trigger("tbwchange")}),a.$box.on("keydown",function(b){return 27===b.which&&1===d("."+c+"modal-box",a.$box).length?(a.closeModal(),!1):void 0})},buildBtnPane:function(){var a=this,b=a.o.prefix,c=a.$btnPane=d("<div/>",{"class":b+"button-pane"});d.each(a.o.btns,function(e,f){try{var g=f.split("btnGrp-");null!=g[1]&&(f=a.o.btnsGrps[g[1]])}catch(h){}d.isArray(f)||(f=[f]);var i=d("<div/>",{"class":b+"button-group "+(f.indexOf("fullscreen")>=0?b+"right":"")});d.each(f,function(b,c){try{var d;a.isSupportedBtn(c)&&(d=a.buildBtn(c)),i.append(d)}catch(e){}}),c.append(i)}),a.$box.prepend(c)},buildBtn:function(a){var b=this,c=b.o.prefix,e=b.btnsDef[a],f=e.dropdown,g=null!=e.hasIcon?e.hasIcon:!0,h=b.lang[a]||a,i=d("<button/>",{type:"button","class":c+a+"-button "+(e["class"]||"")+(g?"":" "+c+"textual-button"),html:b.hasSvg&&g?'<svg><use xlink:href="'+b.svgPath+"#"+c+(e.ico||a).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>':e.text||e.title||b.lang[a]||a,title:(e.title||e.text||h)+(e.key?" (Ctrl + "+e.key+")":""),tabindex:-1,mousedown:function(){return(!f||d("."+a+"-"+c+"dropdown",b.$box).is(":hidden"))&&d("body",b.doc).trigger("mousedown"),!b.$btnPane.hasClass(c+"disable")||d(this).hasClass(c+"active")||d(this).hasClass(c+"not-disable")?(b.execCmd((f?"dropdown":!1)||e.fn||a,e.param||a,e.forceCss||!1),!1):!1}});if(f){i.addClass(c+"open-dropdown");var j=c+"dropdown",k=d("<div/>",{"class":j+"-"+a+" "+j+" "+c+"fixed-top","data-dropdown":a});d.each(f,function(a,c){b.btnsDef[c]&&b.isSupportedBtn(c)&&k.append(b.buildSubBtn(c))}),b.$box.append(k.hide())}else e.key&&(b.keys[e.key]={fn:e.fn||a,param:e.param||a});return f||(b.tagToButton[(e.tag||a).toLowerCase()]=a),i},buildSubBtn:function(a){var b=this,c=b.o.prefix,e=b.btnsDef[a],f=null!=e.hasIcon?e.hasIcon:!0;return e.key&&(b.keys[e.key]={fn:e.fn||a,param:e.param||a}),b.tagToButton[(e.tag||a).toLowerCase()]=a,d("<button/>",{type:"button","class":c+a+"-dropdown-button"+(e.ico?" "+c+e.ico+"-button":""),html:b.hasSvg&&f?'<svg><use xlink:href="'+b.svgPath+"#"+c+(e.ico||a).replace(/([A-Z]+)/g,"-$1").toLowerCase()+'"/></svg>'+(e.text||e.title||b.lang[a]||a):e.text||e.title||b.lang[a]||a,title:e.key?" (Ctrl + "+e.key+")":null,style:e.style||null,mousedown:function(){return d("body",b.doc).trigger("mousedown"),b.execCmd(e.fn||a,e.param||a,e.forceCss||!1),!1}})},isSupportedBtn:function(a){try{return this.btnsDef[a].isSupported()}catch(b){}return!0},buildOverlay:function(){var a=this;return a.$overlay=d("<div/>",{"class":a.o.prefix+"overlay"}).css({top:a.$btnPane.outerHeight(),height:a.$ed.outerHeight()+1+"px"}).appendTo(a.$box),a.$overlay},showOverlay:function(){var a=this;d(b).trigger("scroll"),a.$overlay.fadeIn(200),a.$box.addClass(a.o.prefix+"box-blur")},hideOverlay:function(){var a=this;a.$overlay.fadeOut(50),a.$box.removeClass(a.o.prefix+"box-blur")},fixedBtnPaneEvents:function(){var a=this,c=a.o.fixedFullWidth,e=a.$box;a.o.fixedBtnPane&&(a.isFixed=!1,d(b).on("scroll."+a.eventNamespace+" resize."+a.eventNamespace,function(){if(e){a.syncCode();var f=d(b).scrollTop(),g=e.offset().top+1,h=a.$btnPane,i=h.outerHeight()-2;f-g>0&&f-g-a.height<0?(a.isFixed||(a.isFixed=!0,h.css({position:"fixed",top:0,left:c?"0":"auto",zIndex:7}),d([a.$ta,a.$ed]).css({marginTop:h.height()})),h.css({width:c?"100%":e.width()-1+"px"}),d("."+a.o.prefix+"fixed-top",e).css({position:c?"fixed":"absolute",top:c?i:i+(f-g)+"px",zIndex:15})):a.isFixed&&(a.isFixed=!1,h.removeAttr("style"),d([a.$ta,a.$ed]).css({marginTop:0}),d("."+a.o.prefix+"fixed-top",e).css({position:"absolute",top:i}))}}))},toggleDisable:function(a){var b=this,c=b.o.prefix;b.disabled=a,a?b.$ta.attr("disabled",!0):b.$ta.removeAttr("disabled"),b.$box.toggleClass(c+"disabled",a),b.$ed.attr("contenteditable",!a)},destroy:function(){var a=this,c=a.o.prefix,e=a.height;a.isTextarea?a.$box.after(a.$ta.css({height:e}).val(a.html()).removeClass(c+"textarea").show()):a.$box.after(a.$ed.css({height:e}).removeClass(c+"editor").removeAttr("contenteditable").html(a.html()).show()),a.$ed.off("dblclick","img"),a.destroyPlugins(),a.$box.remove(),a.$c.removeData("trumbowyg"),d("body").removeClass(c+"body-fullscreen"),a.$c.trigger("tbwclose"),d(b).off("scroll."+a.eventNamespace+" resize."+a.eventNamespace)},empty:function(){this.$ta.val(""),this.syncCode(!0)},toggle:function(){var a=this,b=a.o.prefix;a.semanticCode(!1,!0),setTimeout(function(){a.doc.activeElement.blur(),a.$box.toggleClass(b+"editor-hidden "+b+"editor-visible"),a.$btnPane.toggleClass(b+"disable"),d("."+b+"viewHTML-button",a.$btnPane).toggleClass(b+"active"),a.$box.hasClass(b+"editor-visible")?a.$ta.attr("tabindex",-1):a.$ta.removeAttr("tabindex")},0)},dropdown:function(a){var c=this,e=c.doc,f=c.o.prefix,g=d("[data-dropdown="+a+"]",c.$box),h=d("."+f+a+"-button",c.$btnPane),i=g.is(":hidden");if(d("body",e).trigger("mousedown"),i){var j=h.offset().left;h.addClass(f+"active"),g.css({position:"absolute",top:h.offset().top-c.$btnPane.offset().top+24+h.outerHeight(),left:c.o.fixedFullWidth&&c.isFixed?j+"px":j-c.$btnPane.offset().left+"px"}).show(),d(b).trigger("scroll"),d("body",e).on("mousedown."+c.eventNamespace,function(){d("."+f+"dropdown",e).hide(),d("."+f+"active",e).removeClass(f+"active"),d("body",e).off("mousedown."+c.eventNamespace)})}},html:function(a){var b=this;return null!=a?(b.$ta.val(a),b.syncCode(!0),b):b.$ta.val()},syncTextarea:function(){var a=this;a.$ta.val(a.$ed.text().trim().length>0||a.$ed.find("hr,img,embed,iframe,input").length>0?a.$ed.html():"")},syncCode:function(a){var b=this;!a&&b.$ed.is(":visible")?b.syncTextarea():b.$ed.html(b.$ta.val()),b.o.autogrow&&(b.height=b.$ed.height(),b.height!==b.$ta.css("height")&&(b.$ta.css({height:b.height}),b.$c.trigger("tbwresize")))},semanticCode:function(a,b){var c=this;if(c.saveRange(),c.syncCode(a),d(c.o.tagsToRemove.join(","),c.$ed).remove(),c.o.semantic){if(c.semanticTag("b","strong"),c.semanticTag("i","em"),b){var e=c.o.inlineElementsSelector,f=":not("+e+")";c.$ed.contents().filter(function(){return 3===this.nodeType&&this.nodeValue.trim().length>0}).wrap("<span data-tbw/>");var g=function(a){if(0!==a.length){var b=a.nextUntil(f).addBack().wrapAll("<p/>").parent(),c=b.nextAll(e).first();b.next("br").remove(),g(c)}};g(c.$ed.children(e).first()),c.semanticTag("div","p",!0),c.$ed.find("p").filter(function(){return c.range&&this===c.range.startContainer?!1:0===d(this).text().trim().length&&0===d(this).children().not("br,span").length}).contents().unwrap(),d("[data-tbw]",c.$ed).contents().unwrap(),c.$ed.find("p:empty").each(function(){var a=d(this);"<br>"!==a.html()&&a.remove()})}c.restoreRange(),c.syncTextarea()}},semanticTag:function(a,b,c){d(a,this.$ed).each(function(){var a=d(this);a.wrap("<"+b+"/>"),c&&d.each(a.prop("attributes"),function(){a.parent().attr(this.name,this.value)}),a.contents().unwrap()})},createLink:function(){for(var a,b,c,e=this,f=e.doc.getSelection(),g=f.focusNode;["A","DIV"].indexOf(g.nodeName)<0;)g=g.parentNode;if(g&&"A"===g.nodeName){var h=d(g);a=h.attr("href"),b=h.attr("title"),c=h.attr("target");var i=e.doc.createRange();i.selectNode(g),f.addRange(i)}e.saveRange(),e.openModalInsert(e.lang.createLink,{url:{label:"URL",required:!0,value:a},text:{label:e.lang.text,value:e.getRangeText()}},function(a){0!==a.url.indexOf("https://")&&0!==a.url.indexOf("http://")&&(a.url="http://"+a.url);var b=d(['<a href="',a.url,'">',a.text,"</a>"].join(""));return e.range.deleteContents(),e.range.insertNode(b[0]),!0})},createLinkRaw:function(a){for(var b,c,e,f=this,g=f.doc.getSelection(),h=g.focusNode;["A","DIV"].indexOf(h.nodeName)<0;)h=h.parentNode;if(h&&"A"===h.nodeName){var i=d(h);b=i.attr("href"),c=i.attr("title"),e=i.attr("target");var j=f.doc.createRange();j.selectNode(h),g.addRange(j)}0!==a.url.indexOf("https://")&&0!==a.url.indexOf("http://")&&(a.url="http://"+a.url);var k=d(['<a href="',a.url,'">',a.text,"</a>"].join(""));return f.range.deleteContents(),f.range.insertNode(k[0]),!0},unlink:function(){var a=this,b=a.doc.getSelection(),c=b.focusNode;if(b.isCollapsed){for(;["A","DIV"].indexOf(c.nodeName)<0;)c=c.parentNode;if(c&&"A"===c.nodeName){var d=a.doc.createRange();d.selectNode(c),b.addRange(d)}}a.execCmd("unlink",void 0,void 0,!0)},insertImage:function(){var a=this;a.saveRange(),a.openModalInsert(a.lang.insertImage,{url:{label:"URL",required:!0},alt:{label:a.lang.description,value:a.getRangeText()}},function(b){return a.execCmd("insertImage",b.url),d('img[src="'+b.url+'"]:not([alt])',a.$box).attr("alt",b.alt),!0})},fullscreen:function(){var a,c=this,e=c.o.prefix,f=e+"fullscreen";c.$box.toggleClass(f),a=c.$box.hasClass(f),d("body").toggleClass(e+"body-fullscreen",a),d(b).trigger("scroll"),c.$c.trigger("tbw"+(a?"open":"close")+"fullscreen")},execCmd:function(b,c,d,e){var f=this;e=!!e||"","dropdown"!==b&&f.$ed.focus();try{f.doc.execCommand("styleWithCSS",!1,d||!1)}catch(g){}try{f[b+e](c)}catch(g){try{b(c)}catch(h){"insertHorizontalRule"===b?c=void 0:"formatBlock"!==b||-1===a.userAgent.indexOf("MSIE")&&-1===a.appVersion.indexOf("Trident/")||(c="<"+c+">"),f.doc.execCommand(b,!1,c),f.syncCode(),"insertImage"!=b&&f.semanticCode(!1,!0)}"dropdown"!==b&&(f.updateButtonPaneStatus(),f.$c.trigger("tbwchange"))}},openModal:function(a,c){var e=this,f=e.o.prefix;if(d("."+f+"modal-box",e.$box).length>0)return!1;e.saveRange(),e.showOverlay(),e.$btnPane.addClass(f+"disable");var g=d("<div/>",{"class":f+"modal "+f+"fixed-top"}).css({top:e.$btnPane.height()}).appendTo(e.$box);e.$overlay.one("click",function(){return g.trigger("tbwcancel"),!1});var h=d("<form/>",{action:"",html:c}).on("submit",function(){return g.trigger("tbwconfirm"),!1}).on("reset",function(){return g.trigger("tbwcancel"),!1}),i=d("<div/>",{"class":f+"modal-box",html:h}).css({top:"-"+e.$btnPane.outerHeight()+"px",opacity:0}).appendTo(g).animate({top:0,opacity:1},100);return d("<span/>",{text:a,"class":f+"modal-title"}).prependTo(i),g.height(i.outerHeight()+10),d("input:first",i).focus(),e.buildModalBtn("submit",i),e.buildModalBtn("reset",i),d(b).trigger("scroll"),g},buildModalBtn:function(a,b){var c=this,e=c.o.prefix;return d("<button/>",{"class":e+"modal-button "+e+"modal-"+a,type:a,text:c.lang[a]||a}).appendTo(d("form",b))},closeModal:function(){var a=this,b=a.o.prefix;a.$btnPane.removeClass(b+"disable"),a.$overlay.off();var c=d("."+b+"modal-box",a.$box);c.animate({top:"-"+c.height()},100,function(){c.parent().remove(),a.hideOverlay()}),a.restoreRange()},openModalInsert:function(a,b,c){var e=this,f=e.o.prefix,g=e.lang,h="",i="tbwconfirm";return d.each(b,function(a,b){var c=b.label,d=b.name||a,e=b.attributes||{},i=Object.keys(e).map(function(a){return a+'="'+e[a]+'"'}).join(" ");h+='<label><input type="'+(b.type||"text")+'" name="'+d+'" value="'+(b.value||"").replace(/"/g,"&quot;")+'"'+i+'><span class="'+f+'input-infos"><span>'+(c?g[c]?g[c]:c:g[a]?g[a]:a)+"</span></span></label>"}),e.openModal(a,h).on(i,function(){var a=d("form",d(this)),f=!0,g={};d.each(b,function(b,c){var h=d('input[name="'+b+'"]',a),i=h.attr("type");"checkbox"===i.toLowerCase()?g[b]=h.is(":checked"):g[b]=d.trim(h.val()),c.required&&""===g[b]?(f=!1,e.addErrorOnModalField(h,e.lang.required)):c.pattern&&!c.pattern.test(g[b])&&(f=!1,e.addErrorOnModalField(h,c.patternError))}),f&&(e.restoreRange(),c(g,b)&&(e.syncCode(),e.$c.trigger("tbwchange"),e.closeModal(),d(this).off(i)))}).one("tbwcancel",function(){d(this).off(i),e.closeModal()})},addErrorOnModalField:function(a,b){var c=this.o.prefix,e=a.parent();a.on("change keyup",function(){e.removeClass(c+"input-error")}),e.addClass(c+"input-error").find("input+span").append(d("<span/>",{"class":c+"msg-error",text:b}))},saveRange:function(){var a=this,b=a.doc.getSelection();if(a.range=null,b.rangeCount){var c,d=a.range=b.getRangeAt(0),e=a.doc.createRange();e.selectNodeContents(a.$ed[0]),e.setEnd(d.startContainer,d.startOffset),c=(e+"").length,a.metaRange={start:c,end:c+(d+"").length}}},restoreRange:function(){var a,b=this,c=b.metaRange,d=b.range,e=b.doc.getSelection();if(d){if(c&&c.start!==c.end){var f,g=0,h=[b.$ed[0]],i=!1,j=!1;for(a=b.doc.createRange();!j&&(f=h.pop());)if(3===f.nodeType){var k=g+f.length;!i&&c.start>=g&&c.start<=k&&(a.setStart(f,c.start-g),i=!0),i&&c.end>=g&&c.end<=k&&(a.setEnd(f,c.end-g),j=!0),g=k}else for(var l=f.childNodes,m=l.length;m>0;)m-=1,h.push(l[m])}e.removeAllRanges(),e.addRange(a||d)}},getRangeText:function(){return this.range+""},updateButtonPaneStatus:function(){var a=this,b=a.o.prefix,c=a.getTagsRecursive(a.doc.getSelection().focusNode),e=b+"active-button "+b+"active";d("."+b+"active-button",a.$btnPane).removeClass(e),d.each(c,function(c,f){var g=a.tagToButton[f.toLowerCase()],h=d("."+b+g+"-button",a.$btnPane);if(h.length>0)h.addClass(e);else try{h=d("."+b+"dropdown ."+b+g+"-dropdown-button",a.$box);var i=h.parent().data("dropdown");d("."+b+i+"-button",a.$box).addClass(e)}catch(j){}})},getTagsRecursive:function(a,b){var c=this;if(b=b||[],!a||!a.parentNode)return b;a=a.parentNode;var e=a.tagName;return"DIV"===e?b:("P"===e&&""!==a.style.textAlign&&b.push(a.style.textAlign),d.each(c.tagHandlers,function(d,e){b=b.concat(e(a,c))}),b.push(e),c.getTagsRecursive(a,b))},initPlugins:function(){var a=this;a.loadedPlugins=[],d.each(d.trumbowyg.plugins,function(b,c){(!c.shouldInit||c.shouldInit(a))&&(c.init(a),c.tagHandler&&a.tagHandlers.push(c.tagHandler),a.loadedPlugins.push(c))})},destroyPlugins:function(){d.each(this.loadedPlugins,function(a,b){b.destroy&&b.destroy()})}}}(navigator,window,document,jQuery),function(a){"use strict";var b={};a.extend(!0,a.trumbowyg,{langs:{en:{insertImageBodas:"Insert Image"}},plugins:{insertImageBodas:{init:function(c){c.o.plugins.insertImageBodas=a.extend(!0,{},b,c.o.plugins.insertImageBodas||{});var d={fn:function(){common_openLayer("/com-DebateContenidoFoto.php?selector="+c.$c[0].id)}};c.addBtnDef("insertImageBodas",d)}}}})}(jQuery),function(a){"use strict";var b={};a.extend(!0,a.trumbowyg,{langs:{en:{insertVideoBodas:"Insert Video"}},plugins:{insertVideoBodas:{init:function(c){c.o.plugins.insertVideoBodas=a.extend(!0,{},b,c.o.plugins.insertVideoBodas||{});var d={fn:function(){com_openVideoLayer(c.$c[0].id)}};c.addBtnDef("insertVideoBodas",d)}}}})}(jQuery),function(a){"use strict";var b={};a.extend(!0,a.trumbowyg,{langs:{en:{insertLinkBodas:"Insert Link"}},plugins:{insertLinkBodas:{init:function(c){c.o.plugins.insertLinkBodas=a.extend(!0,{},b,c.o.plugins.insertLinkBodas||{});var d={fn:function(){var b=window.getSelection(),d=b.anchorNode.nodeValue,e=b.focusNode.parentNode;if("A"==e.nodeName)var f=e.href;var g=window.getSelection().focusOffset,h=window.getSelection().anchorOffset;d=d.substring(g,h),"undefined"==typeof f&&(f="");var i='<div class="modal-dialog"><div class="modal-content"><div class="p20 border-bottom text-center"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h2>'+'Insert a link'+'</h2></div><form id="app-insert-link-form" name="newLinkForm" data-trumbo-selector="#'+c.$c[0].id+'"><div class="p20 bg"><p>'+'Link'+'</p><div class="input-group"><input type="text" name="link" value="'+f+'"></div><p>'+'Text'+'</p><div class="input-group"><input type="text" name="linkName" value="'+d+'"></div></div><div class="p20"><button class="btn-flat red" type="submit">'+'Insert'+"</button></div></form></div></div>",j=a("#app-common-layer").html(i);c.execCmd("saveRange"),j.modal()}};c.addBtnDef("insertLinkBodas",d)}}}})}(jQuery),function(a){"use strict";function b(b){var c=[];return a.ajax({type:"POST",async:!1,url:"/com-DebateSmiley.php",success:function(d){a.each(d,function(a,d){var e="<img src='"+d.SRC+"' />",f={param:d.SIGLA,fn:function(){return b.execCmd("insertHtml","<img class='smiley' src='"+d.SRC+"' />"),!0}};b.addBtnDef(e,f),c.push(e)})}}),c}var c={};a.extend(!0,a.trumbowyg,{langs:{en:{insertEmojiBodas:"Add an emoji"}},plugins:{insertEmojiBodas:{init:function(d){d.o.plugins.insertEmojiBodas=a.extend(!0,{},c,d.o.plugins.insertEmojiBodas||{});var e={dropdown:b(d)};d.addBtnDef("insertEmojiBodas",e)}}}})}(jQuery);$(document).ready(function(){$(".app-perfil-boda-layer","#misTags").on("click",function(){var a,b=$(this).parent().data("grupo"),c=$(this).data("id"),d=$("div span",$(this)).attr("class"),e=$("small",$(this)).html();1==b?a="color":3==b?a="temporada":2==b&&(a="estilo");var f=$("#misTags").data("url-base-buscador")+"?"+a+"="+c;$("span[data-grupo="+b+"]","#misTags").removeClass().addClass(d),$("a[data-grupo="+b+"]","#misTags").html(e).attr("href",f),$("a[data-grupo="+b+"]","#misTags").next().next().remove(),$("#weddingName"+b).html(e),$.post("/com-PerfilCambiarTag.php",{grupo:$(this).parent().data("grupo"),id:$(this).data("id")}),$(".com-about-wedding-layer").hide()}),$(".app-widget-summary-link").click(function(){document.location.href=$(this).data("redir")});tools_checklist_load_widget_stats;tools_checklist_load_widget_stats=function(){window.location.href="/tools/Checklist"},tools_checklist_load_page=function(){},$(document.body).on("click",".app-link-data",function(){var a=$(this).attr("data-href");window.location=a}),$(document.body).on("click",".app-select-text button",function(){$(".app-select-text-target").focus().select()})});function tools_checklist_toggle_task_status(a){var b=$("#tarea"+a).find(".checkit").hasClass("on"),c='Mark item as pending';b&&(c='Mark item as completed'),$("#tarea"+a).find(".checkit").toggleClass("on"),$("#tarea"+a).find(".checkit i.app-dyntitle").prop("title",c),$("#tarea"+a).find(".checkit span.app-dyntitle").html(c),$("#tarea"+a).find(".checkit").hasClass("on")?$("#reg"+a).addClass("task-done"):$("#reg"+a).removeClass("task-done")}function tools_checklist_toggle_task_completed(a,b,c,d){tools_checklist_toggle_task_status(a),$.get("/tools/ChecklistCompletada",{id_tarea:a,completada:d},function(d){d.success||tools_checklist_toggle_task_status(a),tools_checklist_load_widget_stats(b,c)})}function tools_checklist_update_task_prop(a,b,c){var d,e={idTarea:a,field:b,idItem:c};return $.get("/tools/ChecklistUpdate",e,function(a){d=a.success}),d}function tools_checklist_load_widget_stats(a,b){null!=a?(console.log($("#CategoriaFilter").val()),$.get("/tools/ChecklistSummaryJson",{idPeriod:a,idCateg:$("#CategoriaFilter").val()},function(b){done=parseInt(b.complete),total=parseInt(b.total),percent=Math.round(done/total*100),$("#tareas-complete-"+a).html(done),$("#tareas-total-"+a).html(total),$("#bud-pending-"+a).css("width",percent+"%"),$("#bud-percent-"+a).html(percent+"%"),100==percent?$("#header-"+a).find(".fa-exclamation-circle").hide():$("#header-"+a).find(".fa-exclamation-circle").show()})):null!=b&&$.get("/tools/ChecklistSummaryJson",{idPeriod:$("#EstadoFilter").val(),idCateg:b},function(a){done=parseInt(a.complete),total=parseInt(a.total),percent=Math.round(done/total*100),$("#tareas-complete-"+b).html(done),$("#tareas-total-"+b).html(total),$("#bud-pending-"+b).css("width",percent+"%"),$("#bud-percent-"+b).html(percent+"%")}),$.get("/tools/ChecklistSummaryJson",function(a){done=parseInt(a.complete),total=parseInt(a.total),$("#tareas-complete").html(done),$("#tareas-total").html(total),$("#bud-pending").css("width",Math.round(done/total*100)+"%"),$("#bud-percent").html(Math.round(done/total*100)+"%")})}function tools_checklist_task_delete(a,b){a.preventDefault(),a.stopPropagation(),confirm('Are you sure you want to remove this task?')&&$.post("/tools/ChecklistDelete",{id_tarea:b},function(a){a.success&&$("#reg"+b).fadeOut(function(){tools_checklist_load_page(currentPage),tools_checklist_load_widget_stats()})})}function tools_checklist_task_load_content(a,b){$(a.target).hasClass("app-edit-icons")||(_visibleTask!=b?$("#resume"+b).load("/tools/ChecklistRowLayer?reloadRow=1&idTask="+b,function(){tools_checklist_task_slide_toggle(a,b)}):tools_checklist_task_slide_toggle(a,b))}function tools_checklist_task_slide_toggle(a,b){$(a.target).data("force-open")===!0&&$("#resume"+b).is(":visible")?tools_checklist_task_highlight(b):$("#resume"+b).is(":visible")?$("#resume"+b).slideToggle(function(){tools_checklist_task_highlight(b),_visibleTask=""}):("undefined"!=typeof _visibleTask&&""!=_visibleTask&&_visibleTask!=b?$("#resume"+_visibleTask).html("").slideToggle(function(){tools_checklist_task_highlight(_visibleTask)}):tools_checklist_task_highlight(b),$("#resume"+b).slideToggle(function(){_visibleTask=b,tools_checklist_task_highlight(b)}))}function tools_checklist_select_vendor(a){$.post("/tools/ChecklistVendorRun",{idTask:a,categ:$("#selectVendor-"+a).val()},function(){$("#tool-modal").modal("hide"),tools_checklist_load_task(a)})}function tools_checklist_load_task(a){$("#reg"+a).load("/tools/ChecklistRow?reloadRow=1&idTask="+a,function(){$("#resume"+a).is(":visible")?(tools_checklist_task_highlight(a),$("#resume"+a).load("/tools/ChecklistRowLayer?reloadRow=1&idTask="+a)):(tools_checklist_task_highlight(a),tools_checklist_task_load_content(event,a)),"function"==typeof initWorkspace&&initWorkspace()})}function tools_checklist_select_budget(a,b){var c={idTask:b,BudgetCateg:$("#categBudget-"+b).val(),action:"link"};return-1==$("#categBudget-"+b).val()?(alert('Select a concept for this task'),!1):void $.post("/tools/ChecklistBudgetRun",c,function(){$("#tool-modal").modal("hide"),tools_checklist_load_task(b)})}function tools_checklist_create_budget(a){$("#tool-modal").modal("hide"),$("#tool-modal").modal({remote:"/tools/ChecklistAssignNewBudgetToTask?idTask="+a})}function tools_checklist_assign_budget(a){$("#tool-modal").modal("hide"),$("#tool-modal").modal({remote:"/tools/ChecklistAssignBudgetToTask?idTask="+a})}function tools_checklist_create_budget_run(a){if($("#Nombre_"+a).val().trim().length<4)return alert('Concept name should have at least four characters.'),form.find('input[name="#Nombre_'+a+'"]').focus(),!1;var b={idTask:a,Nombre:$("#Nombre_"+a).val().trim(),Categoria:$("#Categoria_"+a).val(),CosteEstimado:$("#CosteEstimado_"+a).val(),CosteActual:$("#CosteActual_"+a).val(),action:"new"};$.post("/tools/ChecklistBudgetRun",b,function(){$("#tool-modal").modal("hide"),tools_checklist_load_task(a)})}function tools_checklist_verify_task(a){return a.find('input[name="Nombre"]').val().length<3?(alert('The title of the task must contain a minimum of four characters.'),a.find('input[name="Nombre"]').focus(),!1):"0"==a.find('select[name="Period"]').val()?(alert('You must select a range of dates'),a.find('select[name="Period"]').focus(),!1):"0"==a.find('select[name="Categoria"]').val()?(alert('You must select a category for the task'),a.find('select[name="Categoria"]').focus(),!1):($.post($(a).attr("action"),$(a).serialize(),function(){$("#frmPaged").find('select[name="Estado"]').val("0"),tools_checklist_load_page(currentPage),$("#tool-modal").modal("hide"),tools_checklist_load_widget_stats()}),!1)}function tools_checklist_viewByPeriod(a){$("#selPeriod").val(a),$(".touchcarousel-item .item-block").removeClass("selected"),tools_checklist_load_page(1),$("#touch-carousel-item-"+a).find(".item-block").addClass("selected"),$(".app-date-filter-title").html($("#touch-carousel-item-"+a).find("a").html())}function tools_checklist_save_note(a){var b=$("#nota-"+a).val(),c={idTarea:a,nota:b};$.post("/tools/ChecklistSaveNote",c,function(b){if(b.success){var c=b.task.NOTAS;0===c.trim().length&&(c='Add note'),$("#nota-exit-"+a).show(),$("#app-tools-checklist-edit-note-"+a).toggle(),$("#app-tools-checklist-desc-note-"+a).toggle(),$("#app-tools-checklist-nota-"+a).html(nl2br(c)),setTimeout(function(){$("#nota-exit-"+a).hide()},3e3)}})}function saveDesc(a){var b=$("#desc-"+a).val(),c=$("#tarea-title-"+a).val(),d={idTarea:a,titulo:c,descripcion:b};$.post("/tools/ChecklistSaveDesc",d,function(b){b.success?($("#text-desc-"+a).html(b.task.DESCRIPCION).show(),$("#titulo-"+a).html(b.task.NOMBRE),$("#desc-container-"+a).hide()):($("#desc-ko-"+a).show(),setTimeout(function(){$("#desc-ko-"+a).hide()},3e3))})}function tools_checklist_load_page(a){$("#checklist-loader").show(),$("#frmPaged").find('input[name="NumPage"]').val(a),tools_checklist_load_list(),currentPage=a}function tools_checklist_load_list(a,b,c){"undefined"==typeof a&&(a=$("#frmPaged").find('input[name="NumPage"]').val()),"undefined"==typeof b&&(b=$("#frmPaged").serialize()),"undefined"==typeof c&&(c=!1),$.post("/tools/"+sectionIterator,b,function(b){$("#page-container").html(b);var d=$("#page-container").find("[data-num-items]:first").data("num-items");tools_paginator_render(a,d,"tools_checklist_load_page",'To-Do List',16),$("#checklist-loader").hide(),!c&&window.history.pushState&&window.history.pushState({page:$("#currentPage").val(),query:$("#currentHistoryState").val()},document.title,window.location.pathname+"?"+$("#frmPaged").serialize())})}function tools_checklist_task_highlight(a){var b=$("#tarea"+a).parent("div.task-row");$("#resume"+a).is(":visible")?b.addClass("task-highlight"):b.removeClass("task-highlight")}function tools_getUrlParameter(a){var b,c,d=decodeURIComponent(window.location.search.substring(1)),e=d.split("&");for(c=0;c<e.length;c++)if(b=e[c].split("="),b[0]===a)return void 0===b[1]?!0:b[1]}var _visibleTask="";window.onpopstate=function(a){var b="",c=1;a.state&&(a.state.query.length>0&&(b=a.state.query),isNaN(a.state.page)||(c=parseInt(a.state.page)),tools_checklist_load_list(c,b,!0))},$(document).ready(function(){$(document.body).on("click",".dropdown-btn",function(){$(this).next().toggle()}),$(document.body).on("change",".app-tools-checklist-dropdown-select",function(){$(this).closest(".btn-submenu").toggle(),tools_checklist_update_task_prop($(this).find("option:selected").data("taskid"),$(this).find("option:selected").data("field"),$(this).find("option:selected").data("itemid"))}),$(document.body).on("mouseup",".btn-submenu",function(){return!1}),$(document.body).on("mouseup",".dropdown-btn",function(){return!1}),$(document.body).mouseup(function(){$(".btn-submenu").hide()}),$(document.body).on("click touchstart",".app-checklist-check",function(a){a.preventDefault(),a.stopPropagation();var b=$(this).data("idperiod")?$(this).data("idperiod"):null,c=$(this).data("idcateg")?$(this).data("idcateg"):null;tools_checklist_toggle_task_completed($(this).data("idtarea"),b,c,$(this).hasClass("on")?0:1)}),$(document.body).on("click touchstart",".app-tools-checklist-hover-on-edit",function(a){$("#app-tools-checklist-edit-note-"+$(this).data("id")).toggle(),$("#app-tools-checklist-desc-note-"+$(this).data("id")).toggle();var b=$("#nota-"+$(this).data("id")),c=b.val().length;b.focus(),b[0].setSelectionRange(c,c)})});/* http://keith-wood.name/countdown.html
   Countdown for jQuery v1.6.3.
   Written by Keith Wood (kbwood{at}iinet.com.au) January 2008.
   Available under the MIT (https://github.com/jquery/jquery/blob/master/MIT-LICENSE.txt) license.
   Please attribute the author if you use it. */

/* Display a countdown timer.
   Attach it with options like:
   $('div selector').countdown(
       {until: new Date(2009, 1 - 1, 1, 0, 0, 0), onExpiry: happyNewYear}); */

(function($) { // Hide scope, no $ conflict

/* Countdown manager. */
function Countdown() {
	this.regional = []; // Available regional settings, indexed by language code
	this.regional[''] = { // Default regional settings
		// The display texts for the counters
		labels: ['Years', 'Months', 'Weeks', 'Days', 'Hours', 'Minutes', 'Seconds'],
		// The display texts for the counters if only one
		labels1: ['Year', 'Month', 'Week', 'Day', 'Hour', 'Minute', 'Second'],
		compactLabels: ['y', 'm', 'w', 'd'], // The compact texts for the counters
		whichLabels: null, // Function to determine which labels to use
		digits: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'], // The digits to display
		timeSeparator: ':', // Separator for time periods
		isRTL: false // True for right-to-left languages, false for left-to-right
	};
	this._defaults = {
		until: null, // new Date(year, mth - 1, day, hr, min, sec) - date/time to count down to
			// or numeric for seconds offset, or string for unit offset(s):
			// 'Y' years, 'O' months, 'W' weeks, 'D' days, 'H' hours, 'M' minutes, 'S' seconds
		since: null, // new Date(year, mth - 1, day, hr, min, sec) - date/time to count up from
			// or numeric for seconds offset, or string for unit offset(s):
			// 'Y' years, 'O' months, 'W' weeks, 'D' days, 'H' hours, 'M' minutes, 'S' seconds
		timezone: null, // The timezone (hours or minutes from GMT) for the target times,
			// or null for client local
		serverSync: null, // A function to retrieve the current server time for synchronisation
		format: 'dHMS', // Format for display - upper case for always, lower case only if non-zero,
			// 'Y' years, 'O' months, 'W' weeks, 'D' days, 'H' hours, 'M' minutes, 'S' seconds
		layout: '', // Build your own layout for the countdown
		compact: false, // True to display in a compact format, false for an expanded one
		significant: 0, // The number of periods with values to show, zero for all
		description: '', // The description displayed for the countdown
		expiryUrl: '', // A URL to load upon expiry, replacing the current page
		expiryText: '', // Text to display upon expiry, replacing the countdown
		alwaysExpire: false, // True to trigger onExpiry even if never counted down
		onExpiry: null, // Callback when the countdown expires -
			// receives no parameters and 'this' is the containing division
		onTick: null, // Callback when the countdown is updated -
			// receives int[7] being the breakdown by period (based on format)
			// and 'this' is the containing division
		tickInterval: 1 // Interval (seconds) between onTick callbacks
	};
	$.extend(this._defaults, this.regional['']);
	this._serverSyncs = [];
	var now = (typeof Date.now == 'function' ? Date.now :
		function() { return new Date().getTime(); });
	var perfAvail = (window.performance && typeof window.performance.now == 'function');
	// Shared timer for all countdowns
	function timerCallBack(timestamp) {
		var drawStart = (timestamp < 1e12 ? // New HTML5 high resolution timer
			(perfAvail ? (performance.now() + performance.timing.navigationStart) : now()) :
			// Integer milliseconds since unix epoch
			timestamp || now());
		if (drawStart - animationStartTime >= 1000) {
			plugin._updateTargets();
			animationStartTime = drawStart;
		}
		requestAnimationFrame(timerCallBack);
	}
	var requestAnimationFrame = window.requestAnimationFrame ||
		window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame ||
		window.oRequestAnimationFrame || window.msRequestAnimationFrame || null;
		// This is when we expect a fall-back to setInterval as it's much more fluid
	var animationStartTime = 0;
	if (!requestAnimationFrame || $.noRequestAnimationFrame) {
		$.noRequestAnimationFrame = null;
		setInterval(function() { plugin._updateTargets(); }, 980); // Fall back to good old setInterval
	}
	else {
		animationStartTime = window.animationStartTime ||
			window.webkitAnimationStartTime || window.mozAnimationStartTime ||
			window.oAnimationStartTime || window.msAnimationStartTime || now();
		requestAnimationFrame(timerCallBack);
	}
}

var Y = 0; // Years
var O = 1; // Months
var W = 2; // Weeks
var D = 3; // Days
var H = 4; // Hours
var M = 5; // Minutes
var S = 6; // Seconds

$.extend(Countdown.prototype, {
	/* Class name added to elements to indicate already configured with countdown. */
	markerClassName: 'hasCountdown',
	/* Name of the data property for instance settings. */
	propertyName: 'countdown',

	/* Class name for the right-to-left marker. */
	_rtlClass: 'countdown_rtl',
	/* Class name for the countdown section marker. */
	_sectionClass: 'countdown_section',
	/* Class name for the period amount marker. */
	_amountClass: 'countdown_amount',
	/* Class name for the countdown row marker. */
	_rowClass: 'countdown_row',
	/* Class name for the holding countdown marker. */
	_holdingClass: 'countdown_holding',
	/* Class name for the showing countdown marker. */
	_showClass: 'countdown_show',
	/* Class name for the description marker. */
	_descrClass: 'countdown_descr',

	/* List of currently active countdown targets. */
	_timerTargets: [],

	/* Override the default settings for all instances of the countdown widget.
	   @param  options  (object) the new settings to use as defaults */
	setDefaults: function(options) {
		this._resetExtraLabels(this._defaults, options);
		$.extend(this._defaults, options || {});
	},

	/* Convert a date/time to UTC.
	   @param  tz     (number) the hour or minute offset from GMT, e.g. +9, -360
	   @param  year   (Date) the date/time in that timezone or
	                  (number) the year in that timezone
	   @param  month  (number, optional) the month (0 - 11) (omit if year is a Date)
	   @param  day    (number, optional) the day (omit if year is a Date)
	   @param  hours  (number, optional) the hour (omit if year is a Date)
	   @param  mins   (number, optional) the minute (omit if year is a Date)
	   @param  secs   (number, optional) the second (omit if year is a Date)
	   @param  ms     (number, optional) the millisecond (omit if year is a Date)
	   @return  (Date) the equivalent UTC date/time */
	UTCDate: function(tz, year, month, day, hours, mins, secs, ms) {
		if (typeof year == 'object' && year.constructor == Date) {
			ms = year.getMilliseconds();
			secs = year.getSeconds();
			mins = year.getMinutes();
			hours = year.getHours();
			day = year.getDate();
			month = year.getMonth();
			year = year.getFullYear();
		}
		var d = new Date();
		d.setUTCFullYear(year);
		d.setUTCDate(1);
		d.setUTCMonth(month || 0);
		d.setUTCDate(day || 1);
		d.setUTCHours(hours || 0);
		d.setUTCMinutes((mins || 0) - (Math.abs(tz) < 30 ? tz * 60 : tz));
		d.setUTCSeconds(secs || 0);
		d.setUTCMilliseconds(ms || 0);
		return d;
	},

	/* Convert a set of periods into seconds.
	   Averaged for months and years.
	   @param  periods  (number[7]) the periods per year/month/week/day/hour/minute/second
	   @return  (number) the corresponding number of seconds */
	periodsToSeconds: function(periods) {
		return periods[0] * 31557600 + periods[1] * 2629800 + periods[2] * 604800 +
			periods[3] * 86400 + periods[4] * 3600 + periods[5] * 60 + periods[6];
	},

	/* Attach the countdown widget to a div.
	   @param  target   (element) the containing division
	   @param  options  (object) the initial settings for the countdown */
	_attachPlugin: function(target, options) {
		target = $(target);
		if (target.hasClass(this.markerClassName)) {
			return;
		}
		var inst = {options: $.extend({}, this._defaults), _periods: [0, 0, 0, 0, 0, 0, 0]};
		target.addClass(this.markerClassName).data(this.propertyName, inst);
		this._optionPlugin(target, options);
	},

	/* Add a target to the list of active ones.
	   @param  target  (element) the countdown target */
	_addTarget: function(target) {
		if (!this._hasTarget(target)) {
			this._timerTargets.push(target);
		}
	},

	/* See if a target is in the list of active ones.
	   @param  target  (element) the countdown target
	   @return  (boolean) true if present, false if not */
	_hasTarget: function(target) {
		return ($.inArray(target, this._timerTargets) > -1);
	},

	/* Remove a target from the list of active ones.
	   @param  target  (element) the countdown target */
	_removeTarget: function(target) {
		this._timerTargets = $.map(this._timerTargets,
			function(value) { return (value == target ? null : value); }); // delete entry
	},

	/* Update each active timer target. */
	_updateTargets: function() {
		for (var i = this._timerTargets.length - 1; i >= 0; i--) {
			this._updateCountdown(this._timerTargets[i]);
		}
	},

	/* Reconfigure the settings for a countdown div.
	   @param  target   (element) the control to affect
	   @param  options  (object) the new options for this instance or
	                    (string) an individual property name
	   @param  value    (any) the individual property value (omit if options
	                    is an object or to retrieve the value of a setting)
	   @return  (any) if retrieving a value */
	_optionPlugin: function(target, options, value) {
		target = $(target);
		var inst = target.data(this.propertyName);
		if (!options || (typeof options == 'string' && value == null)) { // Get option
			var name = options;
			options = (inst || {}).options;
			return (options && name ? options[name] : options);
		}

		if (!target.hasClass(this.markerClassName)) {
			return;
		}
		options = options || {};
		if (typeof options == 'string') {
			var name = options;
			options = {};
			options[name] = value;
		}
		if (options.layout) {
			options.layout = options.layout.replace(/&lt;/g, '<').replace(/&gt;/g, '>');
		}
		this._resetExtraLabels(inst.options, options);
		var timezoneChanged = (inst.options.timezone != options.timezone);
		$.extend(inst.options, options);
		this._adjustSettings(target, inst,
			options.until != null || options.since != null || timezoneChanged);
		var now = new Date();
		if ((inst._since && inst._since < now) || (inst._until && inst._until > now)) {
			this._addTarget(target[0]);
		}
		this._updateCountdown(target, inst);
	},

	/* Redisplay the countdown with an updated display.
	   @param  target  (jQuery) the containing division
	   @param  inst    (object) the current settings for this instance */
	_updateCountdown: function(target, inst) {
		var $target = $(target);
		inst = inst || $target.data(this.propertyName);
		if (!inst) {
			return;
		}
		$target.html(this._generateHTML(inst)).toggleClass(this._rtlClass, inst.options.isRTL);
		if ($.isFunction(inst.options.onTick)) {
			var periods = inst._hold != 'lap' ? inst._periods :
				this._calculatePeriods(inst, inst._show, inst.options.significant, new Date());
			if (inst.options.tickInterval == 1 ||
					this.periodsToSeconds(periods) % inst.options.tickInterval == 0) {
				inst.options.onTick.apply(target, [periods]);
			}
		}
		var expired = inst._hold != 'pause' &&
			(inst._since ? inst._now.getTime() < inst._since.getTime() :
			inst._now.getTime() >= inst._until.getTime());
		if (expired && !inst._expiring) {
			inst._expiring = true;
			if (this._hasTarget(target) || inst.options.alwaysExpire) {
				this._removeTarget(target);
				if ($.isFunction(inst.options.onExpiry)) {
					inst.options.onExpiry.apply(target, []);
				}
				if (inst.options.expiryText) {
					var layout = inst.options.layout;
					inst.options.layout = inst.options.expiryText;
					this._updateCountdown(target, inst);
					inst.options.layout = layout;
				}
				if (inst.options.expiryUrl) {
					window.location = inst.options.expiryUrl;
				}
			}
			inst._expiring = false;
		}
		else if (inst._hold == 'pause') {
			this._removeTarget(target);
		}
		$target.data(this.propertyName, inst);
	},

	/* Reset any extra labelsn and compactLabelsn entries if changing labels.
	   @param  base     (object) the options to be updated
	   @param  options  (object) the new option values */
	_resetExtraLabels: function(base, options) {
		var changingLabels = false;
		for (var n in options) {
			if (n != 'whichLabels' && n.match(/[Ll]abels/)) {
				changingLabels = true;
				break;
			}
		}
		if (changingLabels) {
			for (var n in base) { // Remove custom numbered labels
				if (n.match(/[Ll]abels[02-9]|compactLabels1/)) {
					base[n] = null;
				}
			}
		}
	},

	/* Calculate interal settings for an instance.
	   @param  target  (element) the containing division
	   @param  inst    (object) the current settings for this instance
	   @param  recalc  (boolean) true if until or since are set */
	_adjustSettings: function(target, inst, recalc) {
		var now;
		var serverOffset = 0;
		var serverEntry = null;
		for (var i = 0; i < this._serverSyncs.length; i++) {
			if (this._serverSyncs[i][0] == inst.options.serverSync) {
				serverEntry = this._serverSyncs[i][1];
				break;
			}
		}
		if (serverEntry != null) {
			serverOffset = (inst.options.serverSync ? serverEntry : 0);
			now = new Date();
		}
		else {
			var serverResult = ($.isFunction(inst.options.serverSync) ?
				inst.options.serverSync.apply(target, []) : null);
			now = new Date();
			serverOffset = (serverResult ? now.getTime() - serverResult.getTime() : 0);
			this._serverSyncs.push([inst.options.serverSync, serverOffset]);
		}
		var timezone = inst.options.timezone;
		timezone = (timezone == null ? -now.getTimezoneOffset() : timezone);
		if (recalc || (!recalc && inst._until == null && inst._since == null)) {
			inst._since = inst.options.since;
			if (inst._since != null) {
				inst._since = this.UTCDate(timezone, this._determineTime(inst._since, null));
				if (inst._since && serverOffset) {
					inst._since.setMilliseconds(inst._since.getMilliseconds() + serverOffset);
				}
			}
			inst._until = this.UTCDate(timezone, this._determineTime(inst.options.until, now));
			if (serverOffset) {
				inst._until.setMilliseconds(inst._until.getMilliseconds() + serverOffset);
			}
		}
		inst._show = this._determineShow(inst);
	},

	/* Remove the countdown widget from a div.
	   @param  target  (element) the containing division */
	_destroyPlugin: function(target) {
		target = $(target);
		if (!target.hasClass(this.markerClassName)) {
			return;
		}
		this._removeTarget(target[0]);
		target.removeClass(this.markerClassName).empty().removeData(this.propertyName);
	},

	/* Pause a countdown widget at the current time.
	   Stop it running but remember and display the current time.
	   @param  target  (element) the containing division */
	_pausePlugin: function(target) {
		this._hold(target, 'pause');
	},

	/* Pause a countdown widget at the current time.
	   Stop the display but keep the countdown running.
	   @param  target  (element) the containing division */
	_lapPlugin: function(target) {
		this._hold(target, 'lap');
	},

	/* Resume a paused countdown widget.
	   @param  target  (element) the containing division */
	_resumePlugin: function(target) {
		this._hold(target, null);
	},

	/* Pause or resume a countdown widget.
	   @param  target  (element) the containing division
	   @param  hold    (string) the new hold setting */
	_hold: function(target, hold) {
		var inst = $.data(target, this.propertyName);
		if (inst) {
			if (inst._hold == 'pause' && !hold) {
				inst._periods = inst._savePeriods;
				var sign = (inst._since ? '-' : '+');
				inst[inst._since ? '_since' : '_until'] =
					this._determineTime(sign + inst._periods[0] + 'y' +
						sign + inst._periods[1] + 'o' + sign + inst._periods[2] + 'w' +
						sign + inst._periods[3] + 'd' + sign + inst._periods[4] + 'h' +
						sign + inst._periods[5] + 'm' + sign + inst._periods[6] + 's');
				this._addTarget(target);
			}
			inst._hold = hold;
			inst._savePeriods = (hold == 'pause' ? inst._periods : null);
			$.data(target, this.propertyName, inst);
			this._updateCountdown(target, inst);
		}
	},

	/* Return the current time periods.
	   @param  target  (element) the containing division
	   @return  (number[7]) the current periods for the countdown */
	_getTimesPlugin: function(target) {
		var inst = $.data(target, this.propertyName);
		return (!inst ? null : (inst._hold == 'pause' ? inst._savePeriods : (!inst._hold ? inst._periods :
			this._calculatePeriods(inst, inst._show, inst.options.significant, new Date()))));
	},

	/* A time may be specified as an exact value or a relative one.
	   @param  setting      (string or number or Date) - the date/time value
	                        as a relative or absolute value
	   @param  defaultTime  (Date) the date/time to use if no other is supplied
	   @return  (Date) the corresponding date/time */
	_determineTime: function(setting, defaultTime) {
		var offsetNumeric = function(offset) { // e.g. +300, -2
			var time = new Date();
			time.setTime(time.getTime() + offset * 1000);
			return time;
		};
		var offsetString = function(offset) { // e.g. '+2d', '-4w', '+3h +30m'
			offset = offset.toLowerCase();
			var time = new Date();
			var year = time.getFullYear();
			var month = time.getMonth();
			var day = time.getDate();
			var hour = time.getHours();
			var minute = time.getMinutes();
			var second = time.getSeconds();
			var pattern = /([+-]?[0-9]+)\s*(s|m|h|d|w|o|y)?/g;
			var matches = pattern.exec(offset);
			while (matches) {
				switch (matches[2] || 's') {
					case 's': second += parseInt(matches[1], 10); break;
					case 'm': minute += parseInt(matches[1], 10); break;
					case 'h': hour += parseInt(matches[1], 10); break;
					case 'd': day += parseInt(matches[1], 10); break;
					case 'w': day += parseInt(matches[1], 10) * 7; break;
					case 'o':
						month += parseInt(matches[1], 10);
						day = Math.min(day, plugin._getDaysInMonth(year, month));
						break;
					case 'y':
						year += parseInt(matches[1], 10);
						day = Math.min(day, plugin._getDaysInMonth(year, month));
						break;
				}
				matches = pattern.exec(offset);
			}
			return new Date(year, month, day, hour, minute, second, 0);
		};
		var time = (setting == null ? defaultTime :
			(typeof setting == 'string' ? offsetString(setting) :
			(typeof setting == 'number' ? offsetNumeric(setting) : setting)));
		if (time) time.setMilliseconds(0);
		return time;
	},

	/* Determine the number of days in a month.
	   @param  year   (number) the year
	   @param  month  (number) the month
	   @return  (number) the days in that month */
	_getDaysInMonth: function(year, month) {
		return 32 - new Date(year, month, 32).getDate();
	},

	/* Determine which set of labels should be used for an amount.
	   @param  num  (number) the amount to be displayed
	   @return  (number) the set of labels to be used for this amount */
	_normalLabels: function(num) {
		return num;
	},

	/* Generate the HTML to display the countdown widget.
	   @param  inst  (object) the current settings for this instance
	   @return  (string) the new HTML for the countdown display */
	_generateHTML: function(inst) {
		var self = this;
		// Determine what to show
		inst._periods = (inst._hold ? inst._periods :
			this._calculatePeriods(inst, inst._show, inst.options.significant, new Date()));
		// Show all 'asNeeded' after first non-zero value
		var shownNonZero = false;
		var showCount = 0;
		var sigCount = inst.options.significant;
		var show = $.extend({}, inst._show);
		for (var period = Y; period <= S; period++) {
			shownNonZero |= (inst._show[period] == '?' && inst._periods[period] > 0);
			show[period] = (inst._show[period] == '?' && !shownNonZero ? null : inst._show[period]);
			showCount += (show[period] ? 1 : 0);
			sigCount -= (inst._periods[period] > 0 ? 1 : 0);
		}
		var showSignificant = [false, false, false, false, false, false, false];
		for (var period = S; period >= Y; period--) { // Determine significant periods
			if (inst._show[period]) {
				if (inst._periods[period]) {
					showSignificant[period] = true;
				}
				else {
					showSignificant[period] = sigCount > 0;
					sigCount--;
				}
			}
		}
		var labels = (inst.options.compact ? inst.options.compactLabels : inst.options.labels);
		var whichLabels = inst.options.whichLabels || this._normalLabels;
		var showCompact = function(period) {
			var labelsNum = inst.options['compactLabels' + whichLabels(inst._periods[period])];
			return (show[period] ? self._translateDigits(inst, inst._periods[period]) +
				(labelsNum ? labelsNum[period] : labels[period]) + ' ' : '');
		};
		var showFull = function(period) {
			var labelsNum = inst.options['labels' + whichLabels(inst._periods[period])];
			return ((!inst.options.significant && show[period]) ||
				(inst.options.significant && showSignificant[period]) ?
				'<span class="' + plugin._sectionClass + '">' +
				'<span class="' + plugin._amountClass + '">' +
				self._translateDigits(inst, inst._periods[period]) + '</span><br/>' +
				(labelsNum ? labelsNum[period] : labels[period]) + '</span>' : '');
		};
		return (inst.options.layout ? this._buildLayout(inst, show, inst.options.layout,
			inst.options.compact, inst.options.significant, showSignificant) :
			((inst.options.compact ? // Compact version
			'<span class="' + this._rowClass + ' ' + this._amountClass +
			(inst._hold ? ' ' + this._holdingClass : '') + '">' +
			showCompact(Y) + showCompact(O) + showCompact(W) + showCompact(D) +
			(show[H] ? this._minDigits(inst, inst._periods[H], 2) : '') +
			(show[M] ? (show[H] ? inst.options.timeSeparator : '') +
			this._minDigits(inst, inst._periods[M], 2) : '') +
			(show[S] ? (show[H] || show[M] ? inst.options.timeSeparator : '') +
			this._minDigits(inst, inst._periods[S], 2) : '') :
			// Full version
			'<span class="' + this._rowClass + ' ' + this._showClass + (inst.options.significant || showCount) +
			(inst._hold ? ' ' + this._holdingClass : '') + '">' +
			showFull(Y) + showFull(O) + showFull(W) + showFull(D) +
			showFull(H) + showFull(M) + showFull(S)) + '</span>' +
			(inst.options.description ? '<span class="' + this._rowClass + ' ' + this._descrClass + '">' +
			inst.options.description + '</span>' : '')));
	},

	/* Construct a custom layout.
	   @param  inst             (object) the current settings for this instance
	   @param  show             (string[7]) flags indicating which periods are requested
	   @param  layout           (string) the customised layout
	   @param  compact          (boolean) true if using compact labels
	   @param  significant      (number) the number of periods with values to show, zero for all
	   @param  showSignificant  (boolean[7]) other periods to show for significance
	   @return  (string) the custom HTML */
	_buildLayout: function(inst, show, layout, compact, significant, showSignificant) {
		var labels = inst.options[compact ? 'compactLabels' : 'labels'];
		var whichLabels = inst.options.whichLabels || this._normalLabels;
		var labelFor = function(index) {
			return (inst.options[(compact ? 'compactLabels' : 'labels') +
				whichLabels(inst._periods[index])] || labels)[index];
		};
		var digit = function(value, position) {
			return inst.options.digits[Math.floor(value / position) % 10];
		};
		var subs = {desc: inst.options.description, sep: inst.options.timeSeparator,
			yl: labelFor(Y), yn: this._minDigits(inst, inst._periods[Y], 1),
			ynn: this._minDigits(inst, inst._periods[Y], 2),
			ynnn: this._minDigits(inst, inst._periods[Y], 3), y1: digit(inst._periods[Y], 1),
			y10: digit(inst._periods[Y], 10), y100: digit(inst._periods[Y], 100),
			y1000: digit(inst._periods[Y], 1000),
			ol: labelFor(O), on: this._minDigits(inst, inst._periods[O], 1),
			onn: this._minDigits(inst, inst._periods[O], 2),
			onnn: this._minDigits(inst, inst._periods[O], 3), o1: digit(inst._periods[O], 1),
			o10: digit(inst._periods[O], 10), o100: digit(inst._periods[O], 100),
			o1000: digit(inst._periods[O], 1000),
			wl: labelFor(W), wn: this._minDigits(inst, inst._periods[W], 1),
			wnn: this._minDigits(inst, inst._periods[W], 2),
			wnnn: this._minDigits(inst, inst._periods[W], 3), w1: digit(inst._periods[W], 1),
			w10: digit(inst._periods[W], 10), w100: digit(inst._periods[W], 100),
			w1000: digit(inst._periods[W], 1000),
			dl: labelFor(D), dn: this._minDigits(inst, inst._periods[D], 1),
			dnn: this._minDigits(inst, inst._periods[D], 2),
			dnnn: this._minDigits(inst, inst._periods[D], 3), d1: digit(inst._periods[D], 1),
			d10: digit(inst._periods[D], 10), d100: digit(inst._periods[D], 100),
			d1000: digit(inst._periods[D], 1000),
			hl: labelFor(H), hn: this._minDigits(inst, inst._periods[H], 1),
			hnn: this._minDigits(inst, inst._periods[H], 2),
			hnnn: this._minDigits(inst, inst._periods[H], 3), h1: digit(inst._periods[H], 1),
			h10: digit(inst._periods[H], 10), h100: digit(inst._periods[H], 100),
			h1000: digit(inst._periods[H], 1000),
			ml: labelFor(M), mn: this._minDigits(inst, inst._periods[M], 1),
			mnn: this._minDigits(inst, inst._periods[M], 2),
			mnnn: this._minDigits(inst, inst._periods[M], 3), m1: digit(inst._periods[M], 1),
			m10: digit(inst._periods[M], 10), m100: digit(inst._periods[M], 100),
			m1000: digit(inst._periods[M], 1000),
			sl: labelFor(S), sn: this._minDigits(inst, inst._periods[S], 1),
			snn: this._minDigits(inst, inst._periods[S], 2),
			snnn: this._minDigits(inst, inst._periods[S], 3), s1: digit(inst._periods[S], 1),
			s10: digit(inst._periods[S], 10), s100: digit(inst._periods[S], 100),
			s1000: digit(inst._periods[S], 1000)};
		var html = layout;
		// Replace period containers: {p<}...{p>}
		for (var i = Y; i <= S; i++) {
			var period = 'yowdhms'.charAt(i);
			var re = new RegExp('\\{' + period + '<\\}([\\s\\S]*)\\{' + period + '>\\}', 'g');
			html = html.replace(re, ((!significant && show[i]) ||
				(significant && showSignificant[i]) ? '$1' : ''));
		}
		// Replace period values: {pn}
		$.each(subs, function(n, v) {
			var re = new RegExp('\\{' + n + '\\}', 'g');
			html = html.replace(re, v);
		});
		return html;
	},

	/* Ensure a numeric value has at least n digits for display.
	   @param  inst   (object) the current settings for this instance
	   @param  value  (number) the value to display
	   @param  len    (number) the minimum length
	   @return  (string) the display text */
	_minDigits: function(inst, value, len) {
		value = '' + value;
		if (value.length >= len) {
			return this._translateDigits(inst, value);
		}
		value = '0000000000' + value;
		return this._translateDigits(inst, value.substr(value.length - len));
	},

	/* Translate digits into other representations.
	   @param  inst   (object) the current settings for this instance
	   @param  value  (string) the text to translate
	   @return  (string) the translated text */
	_translateDigits: function(inst, value) {
		return ('' + value).replace(/[0-9]/g, function(digit) {
				return inst.options.digits[digit];
			});
	},

	/* Translate the format into flags for each period.
	   @param  inst  (object) the current settings for this instance
	   @return  (string[7]) flags indicating which periods are requested (?) or
	            required (!) by year, month, week, day, hour, minute, second */
	_determineShow: function(inst) {
		var format = inst.options.format;
		var show = [];
		show[Y] = (format.match('y') ? '?' : (format.match('Y') ? '!' : null));
		show[O] = (format.match('o') ? '?' : (format.match('O') ? '!' : null));
		show[W] = (format.match('w') ? '?' : (format.match('W') ? '!' : null));
		show[D] = (format.match('d') ? '?' : (format.match('D') ? '!' : null));
		show[H] = (format.match('h') ? '?' : (format.match('H') ? '!' : null));
		show[M] = (format.match('m') ? '?' : (format.match('M') ? '!' : null));
		show[S] = (format.match('s') ? '?' : (format.match('S') ? '!' : null));
		return show;
	},

	/* Calculate the requested periods between now and the target time.
	   @param  inst         (object) the current settings for this instance
	   @param  show         (string[7]) flags indicating which periods are requested/required
	   @param  significant  (number) the number of periods with values to show, zero for all
	   @param  now          (Date) the current date and time
	   @return  (number[7]) the current time periods (always positive)
	            by year, month, week, day, hour, minute, second */
	_calculatePeriods: function(inst, show, significant, now) {
		// Find endpoints
		inst._now = now;
		inst._now.setMilliseconds(0);
		var until = new Date(inst._now.getTime());
		if (inst._since) {
			if (now.getTime() < inst._since.getTime()) {
				inst._now = now = until;
			}
			else {
				now = inst._since;
			}
		}
		else {
			until.setTime(inst._until.getTime());
			if (now.getTime() > inst._until.getTime()) {
				inst._now = now = until;
			}
		}
		// Calculate differences by period
		var periods = [0, 0, 0, 0, 0, 0, 0];
		if (show[Y] || show[O]) {
			// Treat end of months as the same
			var lastNow = plugin._getDaysInMonth(now.getFullYear(), now.getMonth());
			var lastUntil = plugin._getDaysInMonth(until.getFullYear(), until.getMonth());
			var sameDay = (until.getDate() == now.getDate() ||
				(until.getDate() >= Math.min(lastNow, lastUntil) &&
				now.getDate() >= Math.min(lastNow, lastUntil)));
			var getSecs = function(date) {
				return (date.getHours() * 60 + date.getMinutes()) * 60 + date.getSeconds();
			};
			var months = Math.max(0,
				(until.getFullYear() - now.getFullYear()) * 12 + until.getMonth() - now.getMonth() +
				((until.getDate() < now.getDate() && !sameDay) ||
				(sameDay && getSecs(until) < getSecs(now)) ? -1 : 0));
			periods[Y] = (show[Y] ? Math.floor(months / 12) : 0);
			periods[O] = (show[O] ? months - periods[Y] * 12 : 0);
			// Adjust for months difference and end of month if necessary
			now = new Date(now.getTime());
			var wasLastDay = (now.getDate() == lastNow);
			var lastDay = plugin._getDaysInMonth(now.getFullYear() + periods[Y],
				now.getMonth() + periods[O]);
			if (now.getDate() > lastDay) {
				now.setDate(lastDay);
			}
			now.setFullYear(now.getFullYear() + periods[Y]);
			now.setMonth(now.getMonth() + periods[O]);
			if (wasLastDay) {
				now.setDate(lastDay);
			}
		}
		var diff = Math.floor((until.getTime() - now.getTime()) / 1000);
		var extractPeriod = function(period, numSecs) {
			periods[period] = (show[period] ? Math.floor(diff / numSecs) : 0);
			diff -= periods[period] * numSecs;
		};
		extractPeriod(W, 604800);
		extractPeriod(D, 86400);
		extractPeriod(H, 3600);
		extractPeriod(M, 60);
		extractPeriod(S, 1);
		if (diff > 0 && !inst._since) { // Round up if left overs
			var multiplier = [1, 12, 4.3482, 7, 24, 60, 60];
			var lastShown = S;
			var max = 1;
			for (var period = S; period >= Y; period--) {
				if (show[period]) {
					if (periods[lastShown] >= max) {
						periods[lastShown] = 0;
						diff = 1;
					}
					if (diff > 0) {
						periods[period]++;
						diff = 0;
						lastShown = period;
						max = 1;
					}
				}
				max *= multiplier[period];
			}
		}
		if (significant) { // Zero out insignificant periods
			for (var period = Y; period <= S; period++) {
				if (significant && periods[period]) {
					significant--;
				}
				else if (!significant) {
					periods[period] = 0;
				}
			}
		}
		return periods;
	}
});

// The list of commands that return values and don't permit chaining
var getters = ['getTimes'];

/* Determine whether a command is a getter and doesn't permit chaining.
   @param  command    (string, optional) the command to run
   @param  otherArgs  ([], optional) any other arguments for the command
   @return  true if the command is a getter, false if not */
function isNotChained(command, otherArgs) {
	if (command == 'option' && (otherArgs.length == 0 ||
			(otherArgs.length == 1 && typeof otherArgs[0] == 'string'))) {
		return true;
	}
	return $.inArray(command, getters) > -1;
}

/* Process the countdown functionality for a jQuery selection.
   @param  options  (object) the new settings to use for these instances (optional) or
                    (string) the command to run (optional)
   @return  (jQuery) for chaining further calls or
            (any) getter value */
$.fn.countdown = function(options) {
	var otherArgs = Array.prototype.slice.call(arguments, 1);
	if (isNotChained(options, otherArgs)) {
		return plugin['_' + options + 'Plugin'].
			apply(plugin, [this[0]].concat(otherArgs));
	}
	return this.each(function() {
		if (typeof options == 'string') {
			if (!plugin['_' + options + 'Plugin']) {
				throw 'Unknown command: ' + options;
			}
			plugin['_' + options + 'Plugin'].
				apply(plugin, [this].concat(otherArgs));
		}
		else {
			plugin._attachPlugin(this, options || {});
		}
	});
};

/* Initialise the countdown functionality. */
var plugin = $.countdown = new Countdown(); // Singleton instance

})(jQuery);// jquery.touchcarousel v1.2
(function(f){function q(b,c){var a,e;this.carouselRoot=f(b);var d=this;this._b=this._a=!1;this._e=this._d=this._c="";this._f;this._g;this._h;this._i;this._j;this._k=0;this.settings=f.extend({},f.fn.touchCarousel.defaults,c);this._l=this.carouselRoot.find(".touchcarousel-container");this._m=this._l[0].style;this._n=this._l.wrap(f('<div class="touchcarousel-wrapper" />')).parent();var g=this._l.find(".touchcarousel-item");this.items=[];this.numItems=g.length;a=navigator.userAgent.toLowerCase();e=/(chrome)[ \/]([\w.]+)/.exec(a)||
/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||0>a.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];a=e[1]||"";e=e[2]||"0";var r={};a&&(r[a]=!0,r.version=e);r.chrome&&(r.webkit=!0);d._o=r;this._p;this._q=!1;this._t=this._s=this._r=0;this._w=this._v=this._u=!1;"ontouchstart"in window?(this.hasTouch=!0,this._c="touchstart.rs",this._d="touchmove.rs",this._e="touchend.rs",this._x=this.settings.baseTouchFriction):(this.hasTouch=
!1,this._x=this.settings.baseMouseFriction,this.settings.dragUsingMouse?(this._c="mousedown.rs",this._d="mousemove.rs",this._e="mouseup.rs",this._y,this._z,a=d._o,a.msie||a.opera?this._y=this._z="move":a.mozilla&&(this._y="-moz-grab",this._z="-moz-grabbing"),this._a1()):this._n.addClass("auto-cursor"));if((this.hasTouch||this.settings.useWebkit3d)&&"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix)this._l.css({"-webkit-transform-origin":"0 0","-webkit-transform":"translateZ(0)"}),this._w=!0;
this._w?(this._b1="-webkit-transform",this._c1="translate3d(",this._d1="px, 0, 0)"):(this._b1="left",this._c1="",this._d1="px");this.hasTouch&&(this.settings.directionNavAutoHide=!1);this.settings.directionNav||(this._f1=this.settings.loopItems?this._e1=!0:this._e1=!1,this.settings.loopItems=!0);var p,h,n=0;g.eq(this.numItems-1).addClass("last");g.each(function(b){h=f(this);p={};p.item=h;p.index=b;p.posX=n;p.width=h.outerWidth(!0)||d.settings.itemFallbackWidth;n+=p.width;if(this.hasTouch){var a;h.find("a").each(function(){a=
f(this);a.data("tc-href",a.attr("href"));a.data("tc-target",a.attr("target"));a.attr("href","#");a.bind("click",function(a){a.preventDefault();if(d._q)return!1;a=f(this).data("tc-href");var b=f(this).data("tc-target");!b||"_g1"===b.toLowerCase()?window.location.href=a:window.open(a)})})}else h.find("a").bind("click.touchcarousel",function(a){if(d._q)return a.preventDefault(),!1});h.find(".non-draggable").bind(d._c,function(a){d._q=!1;a.stopImmediatePropagation()});d.items.push(p)});this._h1=this._f=
n;this._i1=0<this.settings.itemsPerMove?this.settings.itemsPerMove:1;if(this.settings.pagingNav){if(this._j1=this.settings.snapToItems=!0,this._k1=Math.ceil(this.numItems/this._i1),this._l1=0,this.settings.pagingNavControls){this._m1=f('<div class="tc-paging-container"><div class="tc-paging-centerer"><div class="tc-paging-centerer-inside"></div></div></div>');g=this._m1.find(".tc-paging-centerer-inside");for(e=1;e<=this._k1;e++)a=f('<a class="tc-paging-item" href="#">'+e+"</a>").data("tc-id",e),e===
this._l1+1&&a.addClass("current"),g.append(a);this._n1=g.find(".tc-paging-item").click(function(a){a.preventDefault();d.goTo((f(a.currentTarget).data("tc-id")-1)*d._i1)});this._n.after(this._m1)}}else this._j1=!1;this._l.css({width:n});this.settings.directionNav&&(this._n.after("<a href='#' class='arrow-holder left'><span class='arrow-icon left'></span></a> <a href='#' class='arrow-holder right'><span class='arrow-icon right'></span></a>"),this.arrowLeft=this.carouselRoot.find(".arrow-holder.left"),
this.arrowRight=this.carouselRoot.find(".arrow-holder.right"),1>this.arrowLeft.length||1>this.arrowRight.length?this.settings.directionNav=!1:this.settings.directionNavAutoHide&&(this.arrowLeft.hide(),this.arrowRight.hide(),this.carouselRoot.one("mousemove.arrowshover",function(){d.arrowLeft.fadeIn("fast");d.arrowRight.fadeIn("fast")}),this.carouselRoot.hover(function(){d.arrowLeft.fadeIn("fast");d.arrowRight.fadeIn("fast")},function(){d.arrowLeft.fadeOut("fast");d.arrowRight.fadeOut("fast")})),this._p1(0),
this.settings.directionNav&&(this.arrowRight.click(function(a){a.preventDefault();(d.settings.loopItems&&!d._u||!d._f1)&&d.next()}),this.arrowLeft.click(function(a){a.preventDefault();(d.settings.loopItems&&!d._u||!d._e1)&&d.prev()})));this.carouselWidth;this._q1="onorientationchange"in window?"orientationchange.touchcarousel":"resize.touchcarousel";var l;f(window).bind(this._q1,function(){l&&clearTimeout(l);l=setTimeout(function(){d.updateCarouselSize(!1)},100)});this.settings.scrollbar?(this._r1=
f("<div class='scrollbar-holder'><div class='scrollbar"+("light"===this.settings.scrollbarTheme.toLowerCase()?" light":" dark")+"'></div></div>"),this._r1.appendTo(this.carouselRoot),this.scrollbarJQ=this._r1.find(".scrollbar"),this._s1="",this._t1=this.scrollbarJQ[0].style,this._u1=0,this.settings.scrollbarAutoHide?(this._v1=!1,this.scrollbarJQ.css("opacity",0)):this._v1=!0):this.settings.scrollbarAutoHide=!1;this.updateCarouselSize(!0);this._n.bind(this._c,function(a){d._w1(a)});this.settings.autoplay&&
0<this.settings.autoplayDelay?(this._x1=!1,this.autoplayTimer="",this.wasAutoplayRunning=!0,this.hasTouch||this.carouselRoot.hover(function(){d._x1=!0;d._y1()},function(){d._x1=!1;d._z1()}),this.autoplay=!0,this._a2()):this.autoplay=!1;this.settings.keyboardNav&&f(document).bind("keydown.touchcarousel",function(a){d._u||(37===a.keyCode?d.prev():39===a.keyCode&&d.next())});this.carouselRoot.css("overflow","visible")}q.prototype={goTo:function(b,c){var a=this.items[b];a&&(!c&&(this.autoplay&&this.settings.autoplayStopAtAction)&&
this.stopAutoplay(),this._b2(b),this.endPos=this._c2(),a=-a.posX,0<a?a=0:a<this.carouselWidth-this._h1&&(a=this.carouselWidth-this._h1),this.animateTo(a,this.settings.transitionSpeed,"easeInOutSine"))},next:function(b){var c=this._c2(),a=this._d2(c).index;this._j1?(c=this._l1+1,a=c>this._k1-1?this.settings.loopItems?0:(this._k1-1)*this._i1:c*this._i1):(a+=this._i1,this.settings.loopItems&&c<=this.carouselWidth-this._h1&&(a=0),a>this.numItems-1&&(a=this.numItems-1));this.goTo(a,b)},prev:function(b){var c=
this._c2(),a=this._d2(c).index;this._j1?(c=this._l1-1,a=0>c?this.settings.loopItems?(this._k1-1)*this._i1:0:c*this._i1):(a-=this._i1,0>a&&(a=this.settings.loopItems?0>c?0:this.numItems-1:0));this.goTo(a,b)},getCurrentId:function(){return this._d2(this._c2()).index},setXPos:function(b,c){c?this._t1[this._b1]=this._c1+b+this._d1:this._m[this._b1]=this._c1+b+this._d1},stopAutoplay:function(){this._y1();this.wasAutoplayRunning=this.autoplay=!1},resumeAutoplay:function(){this.autoplay=!0;this.wasAutoplayRunning||
this._z1()},updateCarouselSize:function(b){this.carouselWidth=this.carouselRoot.width();if(this.settings.scrollToLast){var c=0;if(this._j1){var a=this.numItems%this._i1;if(0<a)for(a=this.numItems-a;a<this.numItems;a++)c+=this.items[a].width;else c=this.carouselWidth}else c=this.items[this.numItems-1].width;this._h1=this._f+this.carouselWidth-c}else this._h1=this._f;this.settings.scrollbar&&(c=Math.round(this._r1.width()/(this._h1/this.carouselWidth)),this.scrollbarJQ.css("width",c),this._u1=this._r1.width()-
c);if(!this.settings.scrollToLast){if(this.carouselWidth>=this._f){this._v=!0;this.settings.loopItems||(this._f1=!0,this.arrowRight.addClass("disabled"),this._e1=!0,this.arrowLeft.addClass("disabled"));this.setXPos(0);return}this._v&&(this._e1=this._f1=this._v=!1,this.arrowRight.removeClass("disabled"),this.arrowLeft.removeClass("disabled"))}b||(b=this.endPos=this._c2(),0<b?b=0:b<this.carouselWidth-this._h1&&(b=this.carouselWidth-this._h1),this.animateTo(b,300,"easeInOutSine"))},animateTo:function(b,
c,a,e,d,g,r){function p(){h._b=!1;h._a2();h.settings.scrollbarAutoHide&&h._g2();null!==h.settings.onAnimComplete&&h.settings.onAnimComplete.call(h)}null!==this.settings.onAnimStart&&this.settings.onAnimStart.call(this);this.autoplay&&this.autoplayTimer&&(this.wasAutoplayRunning=!0,this._y1());this._e2();var h=this,n=this.settings.scrollbar,l=h._b1,j=h._c1,m=h._d1,q={containerPos:this.endPos},k={containerPos:b},v={containerPos:d};d=e?d:b;var s=h._m;h._b=!0;if(n){var t=this._t1,u=h._h1-h.carouselWidth;
this.settings.scrollbarAutoHide&&(this._v1||this._f2())}this._p1(d);this._p=f(q).animate(k,{duration:c,easing:a,step:function(){n&&(t[l]=j+Math.round(h._u1*(-this.containerPos/u))+m);s[l]=j+Math.round(this.containerPos)+m},complete:function(){e?h._p=f(k).animate(v,{duration:g,easing:r,step:function(){n&&(t[l]=j+Math.round(h._u1*(-this.containerPos/u))+m);s[l]=j+Math.round(this.containerPos)+m},complete:function(){n&&(t[l]=j+Math.round(h._u1*(-v.containerPos/u))+m);s[l]=j+Math.round(v.containerPos)+
m;p()}}):(n&&(t[l]=j+Math.round(h._u1*(-k.containerPos/u))+m),s[l]=j+Math.round(k.containerPos)+m,p())}})},destroy:function(){this.stopAutoplay();this._n.unbind(this._c);f(document).unbind(this._d).unbind(this._e);f(window).unbind(this._q1);this.settings.keyboardNav&&f(document).unbind("keydown.touchcarousel");this.carouselRoot.remove()},_b2:function(b){this._j1&&(this._l1=b=this._h2(b),this.settings.pagingNavControls&&(this._n1.removeClass("current"),this._n1.eq(b).addClass("current")))},_h2:function(b){for(var c=
this._i1,a=0;a<this._k1;a++)if(b>=a*c&&b<a*c+c)return a;return 0>b?0:b>=this._k1?this._k1-1:!1},_i2:function(){this.settings.loopItems||(this._e1?(this._e1=!1,this.arrowLeft.removeClass("disabled")):this._f1&&(this._f1=!1,this.arrowRight.removeClass("disabled")))},_o1:function(){!this._e1&&!this.settings.loopItems&&(this._e1=!0,this.arrowLeft.addClass("disabled"),this._f1&&(this._f1=!1,this.arrowRight.removeClass("disabled")))},_j2:function(){!this._f1&&!this.settings.loopItems&&(this._f1=!0,this.arrowRight.addClass("disabled"),
this._e1&&(this._e1=!1,this.arrowLeft.removeClass("disabled")))},_d2:function(b){b=-b;for(var c,a=0;a<this.numItems;a++)if(c=this.items[a],b>=c.posX&&b<c.posX+c.width)return c;return-1},_a2:function(){this.autoplay&&this.wasAutoplayRunning&&(this._x1||this._z1(),this.wasAutoplayRunning=!1)},_g2:function(){var b=this;this._v1=!1;this._s1&&clearTimeout(this._s1);this._s1=setTimeout(function(){b.scrollbarJQ.animate({opacity:0},150,"linear")},450)},_f2:function(){this._v1=!0;this._s1&&clearTimeout(this._s1);
this.scrollbarJQ.stop().animate({opacity:1},150,"linear")},_e2:function(){this._p&&this._p.stop()},_z1:function(){if(this.autoplay){var b=this;this.autoplayTimer||(this.autoplayTimer=setInterval(function(){!b._k2&&!b._b&&b.next(!0)},this.settings.autoplayDelay))}},_y1:function(){this.autoplayTimer&&(clearInterval(this.autoplayTimer),this.autoplayTimer="")},_c2:function(b){b=!b?this._l:this.scrollbarJQ;return this._w?(b=b.css("-webkit-transform").replace(/^matrix\(/i,"").split(/, |\)$/g),parseInt(b[4],
10)):Math.round(b.position().left)},_w1:function(b){if(!this._k2){this.autoplay&&this.settings.autoplayStopAtAction&&this.stopAutoplay();this._e2();this.settings.scrollbarAutoHide&&this._f2();var c;if(this.hasTouch)if(this._a=!1,(c=b.originalEvent.touches)&&0<c.length)c=c[0];else return!1;else c=b,b.preventDefault();this._l2();this._k2=!0;var a=this;this._w&&a._l.css({"-webkit-transition-duration":"0","-webkit-transition-property":"none"});f(document).bind(this._d,function(b){a._m2(b)});f(document).bind(this._e,
function(b){a._n2(b)});this._o2=this._c2();this._i=c.clientX;this._q=!1;this._k=b.timeStamp||(new Date).getTime();this._t=0;this._s=this._r=c.clientX;this._p2=c.clientY}},_m2:function(b){var c=b.timeStamp||(new Date).getTime(),a;if(this.hasTouch){if(this._a)return!1;a=b.originalEvent.touches;if(1<a.length)return!1;a=a[0];if(Math.abs(a.clientY-this._p2)>Math.abs(a.clientX-this._r)+3)return this.settings.lockAxis&&(this._a=!0),!1}else a=b;b.preventDefault();this._j=a.clientX;this._q2=this._r2;b=a.clientX-
this._s;this._q2!=b&&(this._r2=b);if(0!=b){var e=this._o2+this._t;0<=e?(b/=4,this._o1()):e<=this.carouselWidth-this._h1?(this._j2(),b/=4):this._i2();this._t+=b;this.setXPos(e);this.settings.scrollbar&&this.setXPos(this._u1*(-e/(this._h1-this.carouselWidth)),!0)}this._s=a.clientX;350<c-this._k&&(this._k=c,this._i=a.clientX);null!==this.settings.onDragStart&&this.settings.onDragStart.call(this);return!1},_n2:function(b){if(this._k2){var c=this;this._k2=!1;this._a1();this.endPos=this._c2();this.isdrag=
!1;f(document).unbind(this._d).unbind(this._e);if(this.endPos==this._o2){this._q=!1;this.settings.scrollbarAutoHide&&this._g2();return}this._q=!0;var a=this._j-this._i;b=Math.max(40,(b.timeStamp||(new Date).getTime())-this._k);var e=0.5;b=Math.abs(a)/b;var d=function(a){0<a?a=0:a<c.carouselWidth-c._h1&&(a=c.carouselWidth-c._h1);return a};if(this.settings.snapToItems){this.autoplay&&this.settings.autoplayStopAtAction&&this.stopAutoplay();var a=Boolean(0<this._r-this._s),e=d(this._c2()),g=this._d2(e).index;
this._j1?(a&&(e=Math.max(e-this.carouselWidth-1,1-c._h1),g=this._d2(e).index,void 0===g&&(g=this.numItems-1)),g=this._h2(g)*this._i1):g+=a?this._i1:-this._i1+1;g=a?Math.min(g,this.numItems-1):Math.max(g,0);e=this.items[g];this._b2(g);e&&(e=d(-e.posX),d=Math.abs(this.endPos-e),b=Math.max(1.08*d/b,150),g=Boolean(180>b),d*=0.08,a&&(d*=-1),this.animateTo(g?e+d:e,Math.min(b,400),"easeOutSine",g,e,300,"easeOutCubic"))}else d=0,2>=b?(e=3.5*this._x,d=0):2<b&&3>=b?(e=4*this._x,d=200):3<b&&(d=300,4<b&&(b=4,
d=400,e=6*this._x),e=5*this._x),a=2*b*b/(2*e)*(0>a?-1:1),e=2*b/e+d,0<this.endPos+a?0<this.endPos?this.animateTo(0,800,"easeOutCubic"):this.animateTo(this.carouselWidth/10*((d+200)/1E3),1.1*Math.abs(this.endPos)/b,"easeOutSine",!0,0,400,"easeOutCubic"):this.endPos+a<this.carouselWidth-this._h1?this.endPos<this.carouselWidth-this._h1?this.animateTo(this.carouselWidth-this._h1,800,"easeOutCubic"):this.animateTo(this.carouselWidth-this._h1-this.carouselWidth/10*((d+200)/1E3),1.1*Math.abs(this.carouselWidth-
this._h1-this.endPos)/b,"easeOutSine",!0,this.carouselWidth-this._h1,400,"easeOutCubic"):this.animateTo(this.endPos+a,e,"easeOutCubic");null!==this.settings.onDragRelease&&this.settings.onDragRelease.call(this)}return!1},_p1:function(b){void 0===b&&(b=this._c2());this.settings.loopItems||(0<=b?this._o1():b<=this.carouselWidth-this._h1?this._j2():this._i2())},_a1:function(){this._y?this._n.css("cursor",this._y):(this._n.removeClass("grabbing-cursor"),this._n.addClass("grab-cursor"))},_l2:function(){this._z?
this._n.css("cursor",this._z):(this._n.removeClass("grab-cursor"),this._n.addClass("grabbing-cursor"))}};f.fn.touchCarousel=function(b){return this.each(function(){var c=new q(f(this),b);f(this).data("touchCarousel",c)})};f.fn.touchCarousel.defaults={itemsPerMove:1,snapToItems:!1,pagingNav:!1,pagingNavControls:!0,autoplay:!1,autoplayDelay:3E3,autoplayStopAtAction:!0,scrollbar:!0,scrollbarAutoHide:!1,scrollbarTheme:"dark",transitionSpeed:600,directionNav:!0,directionNavAutoHide:!1,loopItems:!1,keyboardNav:!1,
dragUsingMouse:!0,scrollToLast:!1,itemFallbackWidth:500,baseMouseFriction:0.0012,baseTouchFriction:8E-4,lockAxis:!0,useWebkit3d:!1,onAnimStart:null,onAnimComplete:null,onDragStart:null,onDragRelease:null};f.fn.touchCarousel.settings={};f.extend(jQuery.easing,{easeInOutSine:function(b,c,a,e,d){return-e/2*(Math.cos(Math.PI*c/d)-1)+a},easeOutSine:function(b,c,a,e,d){return e*Math.sin(c/d*(Math.PI/2))+a},easeOutCubic:function(b,c,a,e,d){return e*((c=c/d-1)*c*c+1)+a}})})(jQuery);
/**
 * jquery.Jcrop.min.js v0.9.12 (build:20130202)
 * jQuery Image Cropping Plugin - released under MIT License
 * Copyright (c) 2008-2013 Tapmodo Interactive LLC
 * https://github.com/tapmodo/Jcrop
 */
(function(a){a.Jcrop=function(b,c){function i(a){return Math.round(a)+"px"}function j(a){return d.baseClass+"-"+a}function k(){return a.fx.step.hasOwnProperty("backgroundColor")}function l(b){var c=a(b).offset();return[c.left,c.top]}function m(a){return[a.pageX-e[0],a.pageY-e[1]]}function n(b){typeof b!="object"&&(b={}),d=a.extend(d,b),a.each(["onChange","onSelect","onRelease","onDblClick"],function(a,b){typeof d[b]!="function"&&(d[b]=function(){})})}function o(a,b,c){e=l(D),bc.setCursor(a==="move"?a:a+"-resize");if(a==="move")return bc.activateHandlers(q(b),v,c);var d=_.getFixed(),f=r(a),g=_.getCorner(r(f));_.setPressed(_.getCorner(f)),_.setCurrent(g),bc.activateHandlers(p(a,d),v,c)}function p(a,b){return function(c){if(!d.aspectRatio)switch(a){case"e":c[1]=b.y2;break;case"w":c[1]=b.y2;break;case"n":c[0]=b.x2;break;case"s":c[0]=b.x2}else switch(a){case"e":c[1]=b.y+1;break;case"w":c[1]=b.y+1;break;case"n":c[0]=b.x+1;break;case"s":c[0]=b.x+1}_.setCurrent(c),bb.update()}}function q(a){var b=a;return bd.watchKeys
(),function(a){_.moveOffset([a[0]-b[0],a[1]-b[1]]),b=a,bb.update()}}function r(a){switch(a){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function s(a){return function(b){return d.disabled?!1:a==="move"&&!d.allowMove?!1:(e=l(D),W=!0,o(a,m(b)),b.stopPropagation(),b.preventDefault(),!1)}}function t(a,b,c){var d=a.width(),e=a.height();d>b&&b>0&&(d=b,e=b/a.width()*a.height()),e>c&&c>0&&(e=c,d=c/a.height()*a.width()),T=a.width()/d,U=a.height()/e,a.width(d).height(e)}function u(a){return{x:a.x*T,y:a.y*U,x2:a.x2*T,y2:a.y2*U,w:a.w*T,h:a.h*U}}function v(a){var b=_.getFixed();b.w>d.minSelect[0]&&b.h>d.minSelect[1]?(bb.enableHandles(),bb.done()):bb.release(),bc.setCursor(d.allowSelect?"crosshair":"default")}function w(a){if(d.disabled)return!1;if(!d.allowSelect)return!1;W=!0,e=l(D),bb.disableHandles(),bc.setCursor("crosshair");var b=m(a);return _.setPressed(b),bb.update(),bc.activateHandlers(x,v,a.type.substring
(0,5)==="touch"),bd.watchKeys(),a.stopPropagation(),a.preventDefault(),!1}function x(a){_.setCurrent(a),bb.update()}function y(){var b=a("<div></div>").addClass(j("tracker"));return g&&b.css({opacity:0,backgroundColor:"white"}),b}function be(a){G.removeClass().addClass(j("holder")).addClass(a)}function bf(a,b){function t(){window.setTimeout(u,l)}var c=a[0]/T,e=a[1]/U,f=a[2]/T,g=a[3]/U;if(X)return;var h=_.flipCoords(c,e,f,g),i=_.getFixed(),j=[i.x,i.y,i.x2,i.y2],k=j,l=d.animationDelay,m=h[0]-j[0],n=h[1]-j[1],o=h[2]-j[2],p=h[3]-j[3],q=0,r=d.swingSpeed;c=k[0],e=k[1],f=k[2],g=k[3],bb.animMode(!0);var s,u=function(){return function(){q+=(100-q)/r,k[0]=Math.round(c+q/100*m),k[1]=Math.round(e+q/100*n),k[2]=Math.round(f+q/100*o),k[3]=Math.round(g+q/100*p),q>=99.8&&(q=100),q<100?(bh(k),t()):(bb.done(),bb.animMode(!1),typeof b=="function"&&b.call(bs))}}();t()}function bg(a){bh([a[0]/T,a[1]/U,a[2]/T,a[3]/U]),d.onSelect.call(bs,u(_.getFixed())),bb.enableHandles()}function bh(a){_.setPressed([a[0],a[1]]),_.setCurrent([a[2],
a[3]]),bb.update()}function bi(){return u(_.getFixed())}function bj(){return _.getFixed()}function bk(a){n(a),br()}function bl(){d.disabled=!0,bb.disableHandles(),bb.setCursor("default"),bc.setCursor("default")}function bm(){d.disabled=!1,br()}function bn(){bb.done(),bc.activateHandlers(null,null)}function bo(){G.remove(),A.show(),A.css("visibility","visible"),a(b).removeData("Jcrop")}function bp(a,b){bb.release(),bl();var c=new Image;c.onload=function(){var e=c.width,f=c.height,g=d.boxWidth,h=d.boxHeight;D.width(e).height(f),D.attr("src",a),H.attr("src",a),t(D,g,h),E=D.width(),F=D.height(),H.width(E).height(F),M.width(E+L*2).height(F+L*2),G.width(E).height(F),ba.resize(E,F),bm(),typeof b=="function"&&b.call(bs)},c.src=a}function bq(a,b,c){var e=b||d.bgColor;d.bgFade&&k()&&d.fadeTime&&!c?a.animate({backgroundColor:e},{queue:!1,duration:d.fadeTime}):a.css("backgroundColor",e)}function br(a){d.allowResize?a?bb.enableOnly():bb.enableHandles():bb.disableHandles(),bc.setCursor(d.allowSelect?"crosshair":"default"),bb
.setCursor(d.allowMove?"move":"default"),d.hasOwnProperty("trueSize")&&(T=d.trueSize[0]/E,U=d.trueSize[1]/F),d.hasOwnProperty("setSelect")&&(bg(d.setSelect),bb.done(),delete d.setSelect),ba.refresh(),d.bgColor!=N&&(bq(d.shade?ba.getShades():G,d.shade?d.shadeColor||d.bgColor:d.bgColor),N=d.bgColor),O!=d.bgOpacity&&(O=d.bgOpacity,d.shade?ba.refresh():bb.setBgOpacity(O)),P=d.maxSize[0]||0,Q=d.maxSize[1]||0,R=d.minSize[0]||0,S=d.minSize[1]||0,d.hasOwnProperty("outerImage")&&(D.attr("src",d.outerImage),delete d.outerImage),bb.refresh()}var d=a.extend({},a.Jcrop.defaults),e,f=navigator.userAgent.toLowerCase(),g=/msie/.test(f),h=/msie [1-6]\./.test(f);typeof b!="object"&&(b=a(b)[0]),typeof c!="object"&&(c={}),n(c);var z={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},A=a(b),B=!0;if(b.tagName=="IMG"){if(A[0].width!=0&&A[0].height!=0)A.width(A[0].width),A.height(A[0].height);else{var C=new Image;C.src=A[0].src,A.width(C.width),A.height(C.height)}var D=A.clone().removeAttr("id").
css(z).show();D.width(A.width()),D.height(A.height()),A.after(D).hide()}else D=A.css(z).show(),B=!1,d.shade===null&&(d.shade=!0);t(D,d.boxWidth,d.boxHeight);var E=D.width(),F=D.height(),G=a("<div />").width(E).height(F).addClass(j("holder")).css({position:"relative",backgroundColor:d.bgColor}).insertAfter(A).append(D);d.addClass&&G.addClass(d.addClass);var H=a("<div />"),I=a("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),J=a("<div />").width("100%").height("100%").css("zIndex",320),K=a("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var a=_.getFixed();d.onDblClick.call(bs,a)}).insertBefore(D).append(I,J);B&&(H=a("<img />").attr("src",D.attr("src")).css(z).width(E).height(F),I.append(H)),h&&K.css({overflowY:"hidden"});var L=d.boundary,M=y().width(E+L*2).height(F+L*2).css({position:"absolute",top:i(-L),left:i(-L),zIndex:290}).mousedown(w),N=d.bgColor,O=d.bgOpacity,P,Q,R,S,T,U,V=!0,W,X,Y;e=l(D);var Z=function(){function a(){var a={},b=["touchstart"
,"touchmove","touchend"],c=document.createElement("div"),d;try{for(d=0;d<b.length;d++){var e=b[d];e="on"+e;var f=e in c;f||(c.setAttribute(e,"return;"),f=typeof c[e]=="function"),a[b[d]]=f}return a.touchstart&&a.touchend&&a.touchmove}catch(g){return!1}}function b(){return d.touchSupport===!0||d.touchSupport===!1?d.touchSupport:a()}return{createDragger:function(a){return function(b){return d.disabled?!1:a==="move"&&!d.allowMove?!1:(e=l(D),W=!0,o(a,m(Z.cfilter(b)),!0),b.stopPropagation(),b.preventDefault(),!1)}},newSelection:function(a){return w(Z.cfilter(a))},cfilter:function(a){return a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a},isSupported:a,support:b()}}(),_=function(){function h(d){d=n(d),c=a=d[0],e=b=d[1]}function i(a){a=n(a),f=a[0]-c,g=a[1]-e,c=a[0],e=a[1]}function j(){return[f,g]}function k(d){var f=d[0],g=d[1];0>a+f&&(f-=f+a),0>b+g&&(g-=g+b),F<e+g&&(g+=F-(e+g)),E<c+f&&(f+=E-(c+f)),a+=f,c+=f,b+=g,e+=g}function l(a){var b=m();switch(a){case"ne":return[
b.x2,b.y];case"nw":return[b.x,b.y];case"se":return[b.x2,b.y2];case"sw":return[b.x,b.y2]}}function m(){if(!d.aspectRatio)return p();var f=d.aspectRatio,g=d.minSize[0]/T,h=d.maxSize[0]/T,i=d.maxSize[1]/U,j=c-a,k=e-b,l=Math.abs(j),m=Math.abs(k),n=l/m,r,s,t,u;return h===0&&(h=E*10),i===0&&(i=F*10),n<f?(s=e,t=m*f,r=j<0?a-t:t+a,r<0?(r=0,u=Math.abs((r-a)/f),s=k<0?b-u:u+b):r>E&&(r=E,u=Math.abs((r-a)/f),s=k<0?b-u:u+b)):(r=c,u=l/f,s=k<0?b-u:b+u,s<0?(s=0,t=Math.abs((s-b)*f),r=j<0?a-t:t+a):s>F&&(s=F,t=Math.abs(s-b)*f,r=j<0?a-t:t+a)),r>a?(r-a<g?r=a+g:r-a>h&&(r=a+h),s>b?s=b+(r-a)/f:s=b-(r-a)/f):r<a&&(a-r<g?r=a-g:a-r>h&&(r=a-h),s>b?s=b+(a-r)/f:s=b-(a-r)/f),r<0?(a-=r,r=0):r>E&&(a-=r-E,r=E),s<0?(b-=s,s=0):s>F&&(b-=s-F,s=F),q(o(a,b,r,s))}function n(a){return a[0]<0&&(a[0]=0),a[1]<0&&(a[1]=0),a[0]>E&&(a[0]=E),a[1]>F&&(a[1]=F),[Math.round(a[0]),Math.round(a[1])]}function o(a,b,c,d){var e=a,f=c,g=b,h=d;return c<a&&(e=c,f=a),d<b&&(g=d,h=b),[e,g,f,h]}function p(){var d=c-a,f=e-b,g;return P&&Math.abs(d)>P&&(c=d>0?a+P:a-P),Q&&Math.abs
(f)>Q&&(e=f>0?b+Q:b-Q),S/U&&Math.abs(f)<S/U&&(e=f>0?b+S/U:b-S/U),R/T&&Math.abs(d)<R/T&&(c=d>0?a+R/T:a-R/T),a<0&&(c-=a,a-=a),b<0&&(e-=b,b-=b),c<0&&(a-=c,c-=c),e<0&&(b-=e,e-=e),c>E&&(g=c-E,a-=g,c-=g),e>F&&(g=e-F,b-=g,e-=g),a>E&&(g=a-F,e-=g,b-=g),b>F&&(g=b-F,e-=g,b-=g),q(o(a,b,c,e))}function q(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var a=0,b=0,c=0,e=0,f,g;return{flipCoords:o,setPressed:h,setCurrent:i,getOffset:j,moveOffset:k,getCorner:l,getFixed:m}}(),ba=function(){function f(a,b){e.left.css({height:i(b)}),e.right.css({height:i(b)})}function g(){return h(_.getFixed())}function h(a){e.top.css({left:i(a.x),width:i(a.w),height:i(a.y)}),e.bottom.css({top:i(a.y2),left:i(a.x),width:i(a.w),height:i(F-a.y2)}),e.right.css({left:i(a.x2),width:i(E-a.x2)}),e.left.css({width:i(a.x)})}function j(){return a("<div />").css({position:"absolute",backgroundColor:d.shadeColor||d.bgColor}).appendTo(c)}function k(){b||(b=!0,c.insertBefore(D),g(),bb.setBgOpacity(1,0,1),H.hide(),l(d.shadeColor||d.bgColor,1),bb.
isAwake()?n(d.bgOpacity,1):n(1,1))}function l(a,b){bq(p(),a,b)}function m(){b&&(c.remove(),H.show(),b=!1,bb.isAwake()?bb.setBgOpacity(d.bgOpacity,1,1):(bb.setBgOpacity(1,1,1),bb.disableHandles()),bq(G,0,1))}function n(a,e){b&&(d.bgFade&&!e?c.animate({opacity:1-a},{queue:!1,duration:d.fadeTime}):c.css({opacity:1-a}))}function o(){d.shade?k():m(),bb.isAwake()&&n(d.bgOpacity)}function p(){return c.children()}var b=!1,c=a("<div />").css({position:"absolute",zIndex:240,opacity:0}),e={top:j(),left:j().height(F),right:j().height(F),bottom:j()};return{update:g,updateRaw:h,getShades:p,setBgColor:l,enable:k,disable:m,resize:f,refresh:o,opacity:n}}(),bb=function(){function k(b){var c=a("<div />").css({position:"absolute",opacity:d.borderOpacity}).addClass(j(b));return I.append(c),c}function l(b,c){var d=a("<div />").mousedown(s(b)).css({cursor:b+"-resize",position:"absolute",zIndex:c}).addClass("ord-"+b);return Z.support&&d.bind("touchstart.jcrop",Z.createDragger(b)),J.append(d),d}function m(a){var b=d.handleSize,e=l(a,c++
).css({opacity:d.handleOpacity}).addClass(j("handle"));return b&&e.width(b).height(b),e}function n(a){return l(a,c++).addClass("jcrop-dragbar")}function o(a){var b;for(b=0;b<a.length;b++)g[a[b]]=n(a[b])}function p(a){var b,c;for(c=0;c<a.length;c++){switch(a[c]){case"n":b="hline";break;case"s":b="hline bottom";break;case"e":b="vline right";break;case"w":b="vline"}e[a[c]]=k(b)}}function q(a){var b;for(b=0;b<a.length;b++)f[a[b]]=m(a[b])}function r(a,b){d.shade||H.css({top:i(-b),left:i(-a)}),K.css({top:i(b),left:i(a)})}function t(a,b){K.width(Math.round(a)).height(Math.round(b))}function v(){var a=_.getFixed();_.setPressed([a.x,a.y]),_.setCurrent([a.x2,a.y2]),w()}function w(a){if(b)return x(a)}function x(a){var c=_.getFixed();t(c.w,c.h),r(c.x,c.y),d.shade&&ba.updateRaw(c),b||A(),a?d.onSelect.call(bs,u(c)):d.onChange.call(bs,u(c))}function z(a,c,e){if(!b&&!c)return;d.bgFade&&!e?D.animate({opacity:a},{queue:!1,duration:d.fadeTime}):D.css("opacity",a)}function A(){K.show(),d.shade?ba.opacity(O):z(O,!0),b=!0}function B
(){F(),K.hide(),d.shade?ba.opacity(1):z(1),b=!1,d.onRelease.call(bs)}function C(){h&&J.show()}function E(){h=!0;if(d.allowResize)return J.show(),!0}function F(){h=!1,J.hide()}function G(a){a?(X=!0,F()):(X=!1,E())}function L(){G(!1),v()}var b,c=370,e={},f={},g={},h=!1;d.dragEdges&&a.isArray(d.createDragbars)&&o(d.createDragbars),a.isArray(d.createHandles)&&q(d.createHandles),d.drawBorders&&a.isArray(d.createBorders)&&p(d.createBorders),a(document).bind("touchstart.jcrop-ios",function(b){a(b.currentTarget).hasClass("jcrop-tracker")&&b.stopPropagation()});var M=y().mousedown(s("move")).css({cursor:"move",position:"absolute",zIndex:360});return Z.support&&M.bind("touchstart.jcrop",Z.createDragger("move")),I.append(M),F(),{updateVisible:w,update:x,release:B,refresh:v,isAwake:function(){return b},setCursor:function(a){M.css("cursor",a)},enableHandles:E,enableOnly:function(){h=!0},showHandles:C,disableHandles:F,animMode:G,setBgOpacity:z,done:L}}(),bc=function(){function f(b){M.css({zIndex:450}),b?a(document).bind("touchmove.jcrop"
,k).bind("touchend.jcrop",l):e&&a(document).bind("mousemove.jcrop",h).bind("mouseup.jcrop",i)}function g(){M.css({zIndex:290}),a(document).unbind(".jcrop")}function h(a){return b(m(a)),!1}function i(a){return a.preventDefault(),a.stopPropagation(),W&&(W=!1,c(m(a)),bb.isAwake()&&d.onSelect.call(bs,u(_.getFixed())),g(),b=function(){},c=function(){}),!1}function j(a,d,e){return W=!0,b=a,c=d,f(e),!1}function k(a){return b(m(Z.cfilter(a))),!1}function l(a){return i(Z.cfilter(a))}function n(a){M.css("cursor",a)}var b=function(){},c=function(){},e=d.trackDocument;return e||M.mousemove(h).mouseup(i).mouseout(i),D.before(M),{activateHandlers:j,setCursor:n}}(),bd=function(){function e(){d.keySupport&&(b.show(),b.focus())}function f(a){b.hide()}function g(a,b,c){d.allowMove&&(_.moveOffset([b,c]),bb.updateVisible(!0)),a.preventDefault(),a.stopPropagation()}function i(a){if(a.ctrlKey||a.metaKey)return!0;Y=a.shiftKey?!0:!1;var b=Y?10:1;switch(a.keyCode){case 37:g(a,-b,0);break;case 39:g(a,b,0);break;case 38:g(a,0,-b);break;
case 40:g(a,0,b);break;case 27:d.allowSelect&&bb.release();break;case 9:return!0}return!1}var b=a('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),c=a("<div />").css({position:"absolute",overflow:"hidden"}).append(b);return d.keySupport&&(b.keydown(i).blur(f),h||!d.fixedSupport?(b.css({position:"absolute",left:"-20px"}),c.append(b).insertBefore(D)):b.insertBefore(D)),{watchKeys:e}}();Z.support&&M.bind("touchstart.jcrop",Z.newSelection),J.hide(),br(!0);var bs={setImage:bp,animateTo:bf,setSelect:bg,setOptions:bk,tellSelect:bi,tellScaled:bj,setClass:be,disable:bl,enable:bm,cancel:bn,release:bb.release,destroy:bo,focus:bd.watchKeys,getBounds:function(){return[E*T,F*U]},getWidgetSize:function(){return[E,F]},getScaleFactor:function(){return[T,U]},getOptions:function(){return d},ui:{holder:G,selection:K}};return g&&G.bind("selectstart",function(){return!1}),A.data("Jcrop",bs),bs},a.fn.Jcrop=function(b,c){var d;return this.each(function(){if(a(this).data("Jcrop")){if(
b==="api")return a(this).data("Jcrop");a(this).data("Jcrop").setOptions(b)}else this.tagName=="IMG"?a.Jcrop.Loader(this,function(){a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d)}):(a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d))}),this},a.Jcrop.Loader=function(b,c,d){function g(){f.complete?(e.unbind(".jcloader"),a.isFunction(c)&&c.call(f)):window.setTimeout(g,50)}var e=a(b),f=e[0];e.bind("load.jcloader",g).bind("error.jcloader",function(b){e.unbind(".jcloader"),a.isFunction(d)&&d.call(f)}),f.complete&&a.isFunction(c)&&(e.unbind(".jcloader"),c.call(f))},a.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges
:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}})(jQuery);/*!
 * jCarousel Lite - v1.8.6 - 2013-10-28
 * http://kswedberg.github.com/jquery-carousel-lite/
 * Copyright (c) 2013 Karl Swedberg
 * Licensed MIT (http://kswedberg.github.com/jquery-carousel-lite/blob/master/LICENSE-MIT)
 */

(function(e){function t(e,t){return t.autoStop&&(t.circular?t.autoStop:Math.min(e,t.autoStop))}function i(e){this.id&&(this.id+=e)}e.jCarouselLite={version:"1.8.7",curr:0},e.fn.jCarouselLite=function(a){var s=e.extend(!0,{},e.fn.jCarouselLite.defaults,a),n=Math.ceil,l=Math.abs;return this.each(function(){function a(){return Y.slice(Q).slice(0,G)}function o(t,i){if(j)return!1;i=i||{};var n=Q,l=t>Q,o=i.speed||s.speed,r=i.offset||0;return s.beforeStart&&s.beforeStart.call(T,a(),l),Y.removeClass(s.activeClass),s.circular?(t>Q&&t>H-G?(Q%=z,t=Q+(i.auto?R:s.scroll),D.css(m,-Q*C.liSize-r)):Q>t&&0>t&&(Q+=z,t+=z,D.css(m,-Q*C.liSize-r)),Q=t+t%1):(0>t?t=0:t>H-N&&(t=H-N),Q=t,0===Q&&s.first&&s.first.call(this,a(),l),Q===H-N&&s.last&&s.last.call(this,a(),l),s.btnPrev&&s.$btnPrev.toggleClass(s.btnDisabledClass,0===Q),s.btnNext&&s.$btnNext.toggleClass(s.btnDisabledClass,Q===H-N)),X(Q,M),e.jCarouselLite.curr=Q,n!==Q||i.force?(j=!0,S[m]=-(Q*C.liSize),D.animate(S,o,s.easing,function(){s.afterEnd&&s.afterEnd.call(T,a(),l),j=!1}),Y.eq(Q).addClass(s.activeClass),Q):(s.afterEnd&&s.afterEnd.call(T,a(),l),Q)}var r,c,u,d,v,f,h,b,p="ontouchend"in document,C={div:{},ul:{},li:{}},g=!0,j=!1,m=s.vertical?"top":"left",S={},x=s.vertical?"height":"width",A=s.vertical?"outerHeight":"outerWidth",w=this,T=e(this),D=T.find("ul").eq(0),y=D.children("li"),z=y.length,P=s.visible,G=n(P),N=Math.floor(P),$=Math.min(s.start,z-1),L=1,E=0,M={},W={},q={},I=s.vertical?"y":"x",k=s.vertical?"x":"y",F=s.init.call(this,s,y);if(F!==!1){T.data("dirjc",L),T.data(m+"jc",T.css(m)),s.circular&&(r=y.slice(z-G).clone(!0).each(i),c=y.slice(0,G).clone(!0).each(i),D.prepend(r).append(c),$+=G,E=G),s.btnGo&&s.btnGo.length&&(b=e.isArray(s.btnGo)&&"string"==typeof s.btnGo[0]?e(s.btnGo.join()):e(s.btnGo),b.each(function(t){e(this).bind("click.jc",function(e){return e.preventDefault(),o(s.circular?P+t:t)})}),M.go=1);var X=function(e,t){e=n(e);var i=(e-E)%z,a=i+N;return t.go&&(b.removeClass(s.activeClass).removeClass(s.visibleClass),b.eq(i).addClass(s.activeClass),b.slice(i,i+N).addClass(s.visibleClass),a>b.length&&b.slice(0,a-b.length).addClass(s.visibleClass)),t.pager&&(u.removeClass(s.activeClass),u.eq(n(i/P)).addClass(s.activeClass)),i},Y=D.children("li"),H=Y.length,Q=$;e.jCarouselLite.curr=Q;var B=function(e){var t,i,a;return e?(C.div[x]="",C.li={width:"",height:""},C):(t=Y[A](!0),i=t*H,a=t*P,C.div[x]=a+"px",C.ul[x]=i+"px",C.ul[m]=-(Q*t)+"px",C.li={width:Y.width(),height:Y.height()},C.liSize=t,C)},J=function(t){var i,a,n={div:{visibility:"visible",position:"relative",zIndex:2,left:"0"},ul:{margin:"0",padding:"0",position:"relative",listStyleType:"none",zIndex:1},li:{overflow:s.vertical?"hidden":"visible","float":s.vertical?"none":"left"}};t&&(i=B(!0),T.css(i.div),D.css(i.ul),Y.css(i.li)),i=B(),s.autoCSS&&g&&(e.extend(!0,i,n),g=!1),s.autoWidth&&(a=parseInt(T.css(x),10),C.liSize=a/s.visible,i.li[x]=C.liSize-(Y[A](!0)-parseInt(Y.css(x),10)),i.ul[x]=C.liSize*H+"px",i.ul[m]=-(Q*C.liSize)+"px",i.div[x]=a),s.autoCSS&&(Y.css(i.li),D.css(i.ul),T.css(i.div))};J();var K=0,O=t(z,s),R="number"==typeof s.auto?s.auto:s.scroll,U=function(){w.setAutoAdvance=setTimeout(function(){(!O||O>K)&&(L=T.data("dirjc"),o(Q+L*R,{auto:!0}),K++,U())},s.timeout)};if(e.each(["btnPrev","btnNext"],function(t,i){s[i]&&(s["$"+i]=e.isFunction(s[i])?s[i].call(T[0]):e(s[i]),s["$"+i].bind("click.jc",function(e){e.preventDefault();var i=0===t?Q-s.scroll:Q+s.scroll;return s.directional&&T.data("dirjc",t?1:-1),o(i)}))}),s.circular||(s.btnPrev&&0===$&&s.$btnPrev.addClass(s.btnDisabledClass),s.btnNext&&$+N>=H&&s.$btnNext.addClass(s.btnDisabledClass)),s.autoPager){d=n(z/P),u=[];for(var V=0;d>V;V++)u.push('<li><a href="#">'+(V+1)+"</a></li>");u.length>1&&(u=e("<ul>"+u.join("")+"</ul>").appendTo(s.autoPager).find("li"),u.find("a").each(function(t){e(this).bind("click.jc",function(e){e.preventDefault();var i=t*P;return s.circular&&(i+=P),o(i)})}),M.pager=1)}X($,M),s.mouseWheel&&T.mousewheel&&T.bind("mousewheel.jc",function(e,t){return t>0?o(Q-s.scroll):o(Q+s.scroll)}),s.pause&&s.auto&&!p&&T.bind("mouseenter.jc",function(){T.trigger("pauseCarousel.jc")}).bind("mouseleave.jc",function(){T.trigger("resumeCarousel.jc")}),s.auto&&U(),e.jCarouselLite.vis=a,T.bind("go.jc",function(e,t,i){t===void 0&&(t="+=1");var a="string"==typeof t&&/(\+=|-=)(\d+)/.exec(t);a?t="-="===a[1]?Q-1*a[2]:Q+1*a[2]:t+=$,o(t,i)}).bind("startCarousel.jc",function(){clearTimeout(w.setAutoAdvance),w.setAutoAdvance=void 0,T.trigger("go","+="+s.scroll),U(),T.removeData("pausedjc").removeData("stoppedjc")}).bind("resumeCarousel.jc",function(e,t){if(!w.setAutoAdvance){clearTimeout(w.setAutoAdvance),w.setAutoAdvance=void 0;var i=T.data("stoppedjc");(t||!i)&&(U(),T.removeData("pausedjc"),i&&T.removeData("stoppedjc"))}}).bind("pauseCarousel.jc",function(){clearTimeout(w.setAutoAdvance),w.setAutoAdvance=void 0,T.data("pausedjc",!0)}).bind("stopCarousel.jc",function(){clearTimeout(w.setAutoAdvance),w.setAutoAdvance=void 0,T.data("stoppedjc",!0)}).bind("refreshCarousel.jc",function(){J(s.autoCSS)}).bind("endCarousel.jc",function(){w.setAutoAdvance&&(clearTimeout(w.setAutoAdvance),w.setAutoAdvance=void 0),s.btnPrev&&s.$btnPrev.addClass(s.btnDisabledClass).unbind(".jc"),s.btnNext&&s.$btnNext.addClass(s.btnDisabledClass).unbind(".jc"),s.btnGo&&e.each(s.btnGo,function(t,i){e(i).unbind(".jc")}),s.circular&&(Y.slice(0,G).remove(),Y.slice(-G).remove()),e.each([m+"jc","pausedjc","stoppedjc","dirjc"],function(e,t){T.removeData(t)}),T.unbind(".jc")}),h={touchstart:function(e){q.x=0,q.y=0,W.x=e.targetTouches[0].pageX,W.y=e.targetTouches[0].pageY,W[m]=parseFloat(D.css(m)),W.time=+new Date},touchmove:function(e){var t=e.targetTouches.length;1===t?(e.preventDefault(),q.x=e.targetTouches[0].pageX,q.y=e.targetTouches[0].pageY,S[m]=W[m]+(q[I]-W[I]),D.css(S)):(q.x=W.x,q.y=W.y)},touchend:function(){if(q.x){var e=W[I]-q[I],t=l(e),i=t>s.swipeThresholds[I],a=l(W[k]-q[k])<s.swipeThresholds[k],n=+new Date-W.time,o=s.swipeThresholds.time>n,r=e>0?"+=":"-=",c=r+s.scroll,u={force:!0};o&&i&&a?u.speed=s.speed/2:!o&&C.liSize/2>t||!i||o&&!a?c="+=0":!o&&t>C.liSize/2&&(c=Math.round(t/C.liSize),c=r+(c>s.visible?s.visible:c),u.offset=e),T.trigger("go.jc",[c,u]),q={}}},handle:function(e){e=e.originalEvent,h[e.type](e)}},p&&s.swipe&&T.bind("touchstart.jc touchmove.jc touchend.jc",h.handle),s.responsive&&(f=s.autoCSS,e(window).bind("resize",function(){f&&(D.width(2*D.width()),f=!1),clearTimeout(v),v=setTimeout(function(){T.trigger("refreshCarousel.jc"),f=s.autoCSS},100)}))}}),this},e.fn.jCarouselLite.defaults={btnPrev:null,btnNext:null,btnGo:null,autoPager:null,btnDisabledClass:"disabled",activeClass:"active",visibleClass:"vis",mouseWheel:!1,speed:200,easing:null,timeout:4e3,auto:!1,directional:!1,autoStop:!1,pause:!0,vertical:!1,circular:!0,visible:3,start:0,scroll:1,autoCSS:!0,responsive:!1,autoWidth:!1,swipe:!0,swipeThresholds:{x:80,y:40,time:150},init:function(){},first:null,last:null,beforeStart:null,afterEnd:null}})(jQuery);(function(){!function(a){return a.easyPieChart=function(b,c){var d,e,f,g,h,i,j,k=this;return this.el=b,this.$el=a(b),this.$el.data("easyPieChart",this),this.init=function(){var b;return k.options=a.extend({},a.easyPieChart.defaultOptions,c),b=parseInt(k.$el.data("percent"),10),k.percentage=0,k.canvas=a("<canvas width='"+k.options.size+"' height='"+k.options.size+"'></canvas>").get(0),k.$el.append(k.canvas),"undefined"!=typeof G_vmlCanvasManager&&null!==G_vmlCanvasManager&&G_vmlCanvasManager.initElement(k.canvas),k.ctx=k.canvas.getContext("2d"),window.devicePixelRatio>1.5&&(a(k.canvas).css({width:k.options.size,height:k.options.size}),k.canvas.width*=2,k.canvas.height*=2,k.ctx.scale(2,2)),k.ctx.translate(k.options.size/2,k.options.size/2),k.$el.addClass("easyPieChart"),k.$el.css({width:k.options.size,height:k.options.size,lineHeight:""+k.options.size+"px"}),k.update(b),k},this.update=function(a){return k.options.animate===!1?f(a):e(k.percentage,a)},i=function(){var a,b,c;for(k.ctx.fillStyle=k.options.scaleColor,k.ctx.lineWidth=1,c=[],a=b=0;24>=b;a=++b)c.push(d(a));return c},d=function(a){var b;return b=a%6===0?0:.017*k.options.size,k.ctx.save(),k.ctx.rotate(a*Math.PI/12),k.ctx.fillRect(k.options.size/2-b,0,.05*-k.options.size+b,1),k.ctx.restore()},j=function(){var a;return a=k.options.size/2-k.options.lineWidth/2,k.options.scaleColor!==!1&&(a-=.08*k.options.size),k.ctx.beginPath(),k.ctx.arc(0,0,a,0,2*Math.PI,!0),k.ctx.closePath(),k.ctx.strokeStyle=k.options.trackColor,k.ctx.lineWidth=k.options.lineWidth,k.ctx.stroke()},h=function(){return k.options.scaleColor!==!1&&i(),k.options.trackColor!==!1?j():void 0},f=function(b){var c;return h(),k.ctx.strokeStyle=a.isFunction(k.options.barColor)?k.options.barColor(b):k.options.barColor,k.ctx.lineCap=k.options.lineCap,k.ctx.lineWidth=k.options.lineWidth,c=k.options.size/2-k.options.lineWidth/2,k.options.scaleColor!==!1&&(c-=.08*k.options.size),k.ctx.save(),k.ctx.rotate(-Math.PI/2),k.ctx.beginPath(),k.ctx.arc(0,0,c,0,2*Math.PI*b/100,!1),k.ctx.stroke(),k.ctx.restore()},e=function(a,b){var c,d,e;return d=30,e=d*k.options.animate/1e3,c=0,k.options.onStart.call(k),k.percentage=b,k.animation&&(clearInterval(k.animation),k.animation=!1),k.animation=setInterval(function(){return k.ctx.clearRect(-k.options.size/2,-k.options.size/2,k.options.size,k.options.size),h.call(k),f.call(k,[g(c,a,b-a,e)]),c++,c/e>1?(clearInterval(k.animation),k.animation=!1,k.options.onStop.call(k)):void 0},1e3/d)},g=function(a,b,c,d){var e,f;return e=function(a){return Math.pow(a,2)},f=function(a){return 1>a?e(a):2-e(a/2*-2+2)},a/=d/2,c/2*f(a)+b},this.init()},a.easyPieChart.defaultOptions={onStart:a.noop,onStop:a.noop},void(a.fn.easyPieChart=function(b){return a.each(this,function(c,d){var e;return e=a(d),e.data("easyPieChart")?void 0:e.data("easyPieChart",new a.easyPieChart(d,b))})})}(jQuery)}).call(this);/*
 * jScrollPane - v2.0.19 - 2013-11-16
 * http://jscrollpane.kelvinluck.com/
 *
 * Copyright (c) 2013 Kelvin Luck
 * Dual licensed under the MIT or GPL licenses.
 */
!function(a,b,c){a.fn.jScrollPane=function(d){function e(d,e){function f(b){var e,h,j,l,m,n,q=!1,r=!1;if(P=b,Q===c)m=d.scrollTop(),n=d.scrollLeft(),d.css({overflow:"hidden",padding:0}),R=d.innerWidth()+tb,S=d.innerHeight(),d.width(R),Q=a('<div class="jspPane" />').css("padding",sb).append(d.children()),T=a('<div class="jspContainer" />').css({width:R+"px",height:S+"px"}).append(Q).appendTo(d);else{if(d.css("width",""),q=P.stickToBottom&&C(),r=P.stickToRight&&D(),l=d.innerWidth()+tb!=R||d.outerHeight()!=S,l&&(R=d.innerWidth()+tb,S=d.innerHeight(),T.css({width:R+"px",height:S+"px"})),!l&&ub==U&&Q.outerHeight()==V)return d.width(R),void 0;ub=U,Q.css("width",""),d.width(R),T.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}Q.css("overflow","auto"),U=b.contentWidth?b.contentWidth:Q[0].scrollWidth,V=Q[0].scrollHeight,Q.css("overflow",""),W=U/R,X=V/S,Y=X>1,Z=W>1,Z||Y?(d.addClass("jspScrollable"),e=P.maintainPosition&&(ab||db),e&&(h=A(),j=B()),g(),i(),k(),e&&(y(r?U-R:h,!1),x(q?V-S:j,!1)),H(),E(),N(),P.enableKeyboardNavigation&&J(),P.clickOnTrack&&o(),L(),P.hijackInternalLinks&&M()):(d.removeClass("jspScrollable"),Q.css({top:0,left:0,width:T.width()-tb}),F(),I(),K(),p()),P.autoReinitialise&&!rb?rb=setInterval(function(){f(P)},P.autoReinitialiseDelay):!P.autoReinitialise&&rb&&clearInterval(rb),m&&d.scrollTop(0)&&x(m,!1),n&&d.scrollLeft(0)&&y(n,!1),d.trigger("jsp-initialised",[Z||Y])}function g(){Y&&(T.append(a('<div class="jspVerticalBar" />').append(a('<div class="jspCap jspCapTop" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragTop" />'),a('<div class="jspDragBottom" />'))),a('<div class="jspCap jspCapBottom" />'))),eb=T.find(">.jspVerticalBar"),fb=eb.find(">.jspTrack"),$=fb.find(">.jspDrag"),P.showArrows&&(jb=a('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",m(0,-1)).bind("click.jsp",G),kb=a('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",m(0,1)).bind("click.jsp",G),P.arrowScrollOnHover&&(jb.bind("mouseover.jsp",m(0,-1,jb)),kb.bind("mouseover.jsp",m(0,1,kb))),l(fb,P.verticalArrowPositions,jb,kb)),hb=S,T.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){hb-=a(this).outerHeight()}),$.hover(function(){$.addClass("jspHover")},function(){$.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("html").bind("dragstart.jsp selectstart.jsp",G),$.addClass("jspActive");var c=b.pageY-$.position().top;return a("html").bind("mousemove.jsp",function(a){r(a.pageY-c,!1)}).bind("mouseup.jsp mouseleave.jsp",q),!1}),h())}function h(){fb.height(hb+"px"),ab=0,gb=P.verticalGutter+fb.outerWidth(),Q.width(R-gb-tb);try{0===eb.position().left&&Q.css("margin-left",gb+"px")}catch(a){}}function i(){Z&&(T.append(a('<div class="jspHorizontalBar" />').append(a('<div class="jspCap jspCapLeft" />'),a('<div class="jspTrack" />').append(a('<div class="jspDrag" />').append(a('<div class="jspDragLeft" />'),a('<div class="jspDragRight" />'))),a('<div class="jspCap jspCapRight" />'))),lb=T.find(">.jspHorizontalBar"),mb=lb.find(">.jspTrack"),bb=mb.find(">.jspDrag"),P.showArrows&&(pb=a('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",m(-1,0)).bind("click.jsp",G),qb=a('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",m(1,0)).bind("click.jsp",G),P.arrowScrollOnHover&&(pb.bind("mouseover.jsp",m(-1,0,pb)),qb.bind("mouseover.jsp",m(1,0,qb))),l(mb,P.horizontalArrowPositions,pb,qb)),bb.hover(function(){bb.addClass("jspHover")},function(){bb.removeClass("jspHover")}).bind("mousedown.jsp",function(b){a("html").bind("dragstart.jsp selectstart.jsp",G),bb.addClass("jspActive");var c=b.pageX-bb.position().left;return a("html").bind("mousemove.jsp",function(a){t(a.pageX-c,!1)}).bind("mouseup.jsp mouseleave.jsp",q),!1}),nb=T.innerWidth(),j())}function j(){T.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){nb-=a(this).outerWidth()}),mb.width(nb+"px"),db=0}function k(){if(Z&&Y){var b=mb.outerHeight(),c=fb.outerWidth();hb-=b,a(lb).find(">.jspCap:visible,>.jspArrow").each(function(){nb+=a(this).outerWidth()}),nb-=c,S-=c,R-=b,mb.parent().append(a('<div class="jspCorner" />').css("width",b+"px")),h(),j()}Z&&Q.width(T.outerWidth()-tb+"px"),V=Q.outerHeight(),X=V/S,Z&&(ob=Math.ceil(1/W*nb),ob>P.horizontalDragMaxWidth?ob=P.horizontalDragMaxWidth:ob<P.horizontalDragMinWidth&&(ob=P.horizontalDragMinWidth),bb.width(ob+"px"),cb=nb-ob,u(db)),Y&&(ib=Math.ceil(1/X*hb),ib>P.verticalDragMaxHeight?ib=P.verticalDragMaxHeight:ib<P.verticalDragMinHeight&&(ib=P.verticalDragMinHeight),$.height(ib-5+"px"),_=hb-ib,s(ab))}function l(a,b,c,d){var e,f="before",g="after";"os"==b&&(b=/Mac/.test(navigator.platform)?"after":"split"),b==f?g=b:b==g&&(f=b,e=c,c=d,d=e),a[f](c)[g](d)}function m(a,b,c){return function(){return n(a,b,this,c),this.blur(),!1}}function n(b,c,d,e){d=a(d).addClass("jspActive");var f,g,h=!0,i=function(){0!==b&&vb.scrollByX(b*P.arrowButtonSpeed),0!==c&&vb.scrollByY(c*P.arrowButtonSpeed),g=setTimeout(i,h?P.initialDelay:P.arrowRepeatFreq),h=!1};i(),f=e?"mouseout.jsp":"mouseup.jsp",e=e||a("html"),e.bind(f,function(){d.removeClass("jspActive"),g&&clearTimeout(g),g=null,e.unbind(f)})}function o(){p(),Y&&fb.bind("mousedown.jsp",function(b){if(b.originalTarget===c||b.originalTarget==b.currentTarget){var d,e=a(this),f=e.offset(),g=b.pageY-f.top-ab,h=!0,i=function(){var a=e.offset(),c=b.pageY-a.top-ib/2,f=S*P.scrollPagePercent,k=_*f/(V-S);if(0>g)ab-k>c?vb.scrollByY(-f):r(c);else{if(!(g>0))return j(),void 0;c>ab+k?vb.scrollByY(f):r(c)}d=setTimeout(i,h?P.initialDelay:P.trackClickRepeatFreq),h=!1},j=function(){d&&clearTimeout(d),d=null,a(document).unbind("mouseup.jsp",j)};return i(),a(document).bind("mouseup.jsp",j),!1}}),Z&&mb.bind("mousedown.jsp",function(b){if(b.originalTarget===c||b.originalTarget==b.currentTarget){var d,e=a(this),f=e.offset(),g=b.pageX-f.left-db,h=!0,i=function(){var a=e.offset(),c=b.pageX-a.left-ob/2,f=R*P.scrollPagePercent,k=cb*f/(U-R);if(0>g)db-k>c?vb.scrollByX(-f):t(c);else{if(!(g>0))return j(),void 0;c>db+k?vb.scrollByX(f):t(c)}d=setTimeout(i,h?P.initialDelay:P.trackClickRepeatFreq),h=!1},j=function(){d&&clearTimeout(d),d=null,a(document).unbind("mouseup.jsp",j)};return i(),a(document).bind("mouseup.jsp",j),!1}})}function p(){mb&&mb.unbind("mousedown.jsp"),fb&&fb.unbind("mousedown.jsp")}function q(){a("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),$&&$.removeClass("jspActive"),bb&&bb.removeClass("jspActive")}function r(a,b){Y&&(0>a?a=0:a>_&&(a=_),b===c&&(b=P.animateScroll),b?vb.animate($,"top",a,s):($.css("top",a),s(a)))}function s(a){a===c&&(a=$.position().top),T.scrollTop(0),ab=a;var b=0===ab,e=ab==_,f=a/_,g=-f*(V-S);(wb!=b||yb!=e)&&(wb=b,yb=e,d.trigger("jsp-arrow-change",[wb,yb,xb,zb])),v(b,e),Q.css("top",g),d.trigger("jsp-scroll-y",[-g,b,e]).trigger("scroll")}function t(a,b){Z&&(0>a?a=0:a>cb&&(a=cb),b===c&&(b=P.animateScroll),b?vb.animate(bb,"left",a,u):(bb.css("left",a),u(a)))}function u(a){a===c&&(a=bb.position().left),T.scrollTop(0),db=a;var b=0===db,e=db==cb,f=a/cb,g=-f*(U-R);(xb!=b||zb!=e)&&(xb=b,zb=e,d.trigger("jsp-arrow-change",[wb,yb,xb,zb])),w(b,e),Q.css("left",g),d.trigger("jsp-scroll-x",[-g,b,e]).trigger("scroll")}function v(a,b){P.showArrows&&(jb[a?"addClass":"removeClass"]("jspDisabled"),kb[b?"addClass":"removeClass"]("jspDisabled"))}function w(a,b){P.showArrows&&(pb[a?"addClass":"removeClass"]("jspDisabled"),qb[b?"addClass":"removeClass"]("jspDisabled"))}function x(a,b){var c=a/(V-S);r(c*_,b)}function y(a,b){var c=a/(U-R);t(c*cb,b)}function z(b,c,d){var e,f,g,h,i,j,k,l,m,n=0,o=0;try{e=a(b)}catch(p){return}for(f=e.outerHeight(),g=e.outerWidth(),T.scrollTop(0),T.scrollLeft(0);!e.is(".jspPane");)if(n+=e.position().top,o+=e.position().left,e=e.offsetParent(),/^body|html$/i.test(e[0].nodeName))return;h=B(),j=h+S,h>n||c?l=n-P.horizontalGutter:n+f>j&&(l=n-S+f+P.horizontalGutter),isNaN(l)||x(l,d),i=A(),k=i+R,i>o||c?m=o-P.horizontalGutter:o+g>k&&(m=o-R+g+P.horizontalGutter),isNaN(m)||y(m,d)}function A(){return-Q.position().left}function B(){return-Q.position().top}function C(){var a=V-S;return a>20&&a-B()<10}function D(){var a=U-R;return a>20&&a-A()<10}function E(){T.unbind(Bb).bind(Bb,function(a,b,c,d){var e=db,f=ab,g=a.deltaFactor||P.mouseWheelSpeed;return vb.scrollBy(c*g,-d*g,!1),e==db&&f==ab})}function F(){T.unbind(Bb)}function G(){return!1}function H(){Q.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){z(a.target,!1)})}function I(){Q.find(":input,a").unbind("focus.jsp")}function J(){function b(){var a=db,b=ab;switch(c){case 40:vb.scrollByY(P.keyboardSpeed,!1);break;case 38:vb.scrollByY(-P.keyboardSpeed,!1);break;case 34:case 32:vb.scrollByY(S*P.scrollPagePercent,!1);break;case 33:vb.scrollByY(-S*P.scrollPagePercent,!1);break;case 39:vb.scrollByX(P.keyboardSpeed,!1);break;case 37:vb.scrollByX(-P.keyboardSpeed,!1)}return e=a!=db||b!=ab}var c,e,f=[];Z&&f.push(lb[0]),Y&&f.push(eb[0]),Q.focus(function(){d.focus()}),d.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(d){if(d.target===this||f.length&&a(d.target).closest(f).length){var g=db,h=ab;switch(d.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:c=d.keyCode,b();break;case 35:x(V-S),c=null;break;case 36:x(0),c=null}return e=d.keyCode==c&&g!=db||h!=ab,!e}}).bind("keypress.jsp",function(a){return a.keyCode==c&&b(),!e}),P.hideFocus?(d.css("outline","none"),"hideFocus"in T[0]&&d.attr("hideFocus",!0)):(d.css("outline",""),"hideFocus"in T[0]&&d.attr("hideFocus",!1))}function K(){d.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function L(){if(location.hash&&location.hash.length>1){var b,c,d=escape(location.hash.substr(1));try{b=a("#"+d+', a[name="'+d+'"]')}catch(e){return}b.length&&Q.find(d)&&(0===T.scrollTop()?c=setInterval(function(){T.scrollTop()>0&&(z(b,!0),a(document).scrollTop(T.position().top),clearInterval(c))},50):(z(b,!0),a(document).scrollTop(T.position().top)))}}function M(){a(document.body).data("jspHijack")||(a(document.body).data("jspHijack",!0),a(document.body).delegate("a[href*=#]","click",function(c){var d,e,f,g,h,i,j=this.href.substr(0,this.href.indexOf("#")),k=location.href;if(-1!==location.href.indexOf("#")&&(k=location.href.substr(0,location.href.indexOf("#"))),j===k){d=escape(this.href.substr(this.href.indexOf("#")+1));try{e=a("#"+d+', a[name="'+d+'"]')}catch(l){return}e.length&&(f=e.closest(".jspScrollable"),g=f.data("jsp"),g.scrollToElement(e,!0),f[0].scrollIntoView&&(h=a(b).scrollTop(),i=e.offset().top,(h>i||i>h+a(b).height())&&f[0].scrollIntoView()),c.preventDefault())}}))}function N(){var a,b,c,d,e,f=!1;T.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(g){var h=g.originalEvent.touches[0];a=A(),b=B(),c=h.pageX,d=h.pageY,e=!1,f=!0}).bind("touchmove.jsp",function(g){if(f){var h=g.originalEvent.touches[0],i=db,j=ab;return vb.scrollTo(a+c-h.pageX,b+d-h.pageY),e=e||Math.abs(c-h.pageX)>5||Math.abs(d-h.pageY)>5,i==db&&j==ab}}).bind("touchend.jsp",function(){f=!1}).bind("click.jsp-touchclick",function(){return e?(e=!1,!1):void 0})}function O(){var a=B(),b=A();d.removeClass("jspScrollable").unbind(".jsp"),d.replaceWith(Ab.append(Q.children())),Ab.scrollTop(a),Ab.scrollLeft(b),rb&&clearInterval(rb)}var P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb=this,wb=!0,xb=!0,yb=!1,zb=!1,Ab=d.clone(!1,!1).empty(),Bb=a.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";"border-box"===d.css("box-sizing")?(sb=0,tb=0):(sb=d.css("paddingTop")+" "+d.css("paddingRight")+" "+d.css("paddingBottom")+" "+d.css("paddingLeft"),tb=(parseInt(d.css("paddingLeft"),10)||0)+(parseInt(d.css("paddingRight"),10)||0)),a.extend(vb,{reinitialise:function(b){b=a.extend({},P,b),f(b)},scrollToElement:function(a,b,c){z(a,b,c)},scrollTo:function(a,b,c){y(a,c),x(b,c)},scrollToX:function(a,b){y(a,b)},scrollToY:function(a,b){x(a,b)},scrollToPercentX:function(a,b){y(a*(U-R),b)},scrollToPercentY:function(a,b){x(a*(V-S),b)},scrollBy:function(a,b,c){vb.scrollByX(a,c),vb.scrollByY(b,c)},scrollByX:function(a,b){var c=A()+Math[0>a?"floor":"ceil"](a),d=c/(U-R);t(d*cb,b)},scrollByY:function(a,b){var c=B()+Math[0>a?"floor":"ceil"](a),d=c/(V-S);r(d*_,b)},positionDragX:function(a,b){t(a,b)},positionDragY:function(a,b){r(a,b)},animate:function(a,b,c,d){var e={};e[b]=c,a.animate(e,{duration:P.animateDuration,easing:P.animateEase,queue:!1,step:d})},getContentPositionX:function(){return A()},getContentPositionY:function(){return B()},getContentWidth:function(){return U},getContentHeight:function(){return V},getPercentScrolledX:function(){return A()/(U-R)},getPercentScrolledY:function(){return B()/(V-S)},getIsScrollableH:function(){return Z},getIsScrollableV:function(){return Y},getContentPane:function(){return Q},scrollToBottom:function(a){r(_,a)},hijackInternalLinks:a.noop,destroy:function(){O()}}),f(e)}return d=a.extend({},a.fn.jScrollPane.defaults,d),a.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){d[this]=d[this]||d.speed}),this.each(function(){var b=a(this),c=b.data("jsp");c?c.reinitialise(d):(a("script",b).filter('[type="text/javascript"],:not([type])').remove(),c=new e(b,d),b.data("jsp",c))})},a.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:c,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery,this);
